window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.timesuggestions.js'] = (new Date()).getTime();
function CalendarTimeSuggestionsComponent(){}CalendarTimeSuggestionsComponent.$$cctor=function(){_a.t.a().a(CalendarTimeSuggestionsComponent)};CalendarTimeSuggestionsComponent.prototype={b:function(n,t,i){var r=this;n.b(_cc.cI,function(){var t=n.a(_a.cY);return new _cts.j(n.a(_a.cg),n.a(ICalendarScenarioContextManager),n.a(_g.h),n.a(_a.x),t.a())}).a()},a:function(){return[]}};Type.registerNamespace("_cts");_cts.i=function(n,t){_cts.i.initializeBase(this,[t]);this.l=n;this.k=t};_cts.i.prototype={l:null,k:null,h:null,K:function(n){var t=new _cz.et(this.L);t.timeZone=this.Y();this.l.b(this.k,t,this,this.J,this.H)}};_cts.c=function(n){this.a=n+_cts.c.a};_cts.c.prototype={a:null,b:function(n,t,i,r,u){var f=new XMLHttpRequest;var e=this;f.onreadystatechange=function(){if(f.readyState===4)if(f.status===200){var n=null;try{n=JsonParser.deserialize(f.responseText);r(new _g.H(null),n)}catch(e){i.h=String.format("ErrorType: {0}; ErrorMessage: {1}; CorrelationId: {2}",f.status,e.message,t.correlationId);u(Error.create(i.h))}}else{i.h=String.format("ErrorType: {0}; ErrorMessage: {1}; CorrelationId: {2}",f.status,f.responseText,t.correlationId);u(Error.create(i.h))}};f.open("POST",this.a,!0);f.setRequestHeader("Content-Type","application/json");f.setRequestHeader(_a.w.c(),_a.w.d());f.setRequestHeader("x-findmeetingtimes-appname","OWA");f.setRequestHeader("x-findmeetingtimes-appscenario","Scheduling");t.timeZone&&f.setRequestHeader("Prefer",'outlook.timezone="'+t.timeZone+'"');f.send(JsonParser.serialize(n))}};_cts.h=function(n){this.a=n};_cts.h.prototype={a:null,b:function(n){if(_cc.a.bc()){var t=new _cts.c(this.a);return new _cts.i(t,n)}else return new _cts.g(n)}};_cts.g=function(n){_cts.g.initializeBase(this);this.f=n};_cts.g.prototype={f:null,e:null,o:function(){return!!this.f.LocationConstraints&&this.f.LocationConstraints.IsRequired},j:"Unknown",Y:function(){return _g.a.a().C||_h.ci.prototype.Y.call(this)},K:function(n){var t;var r=(t=new _cz.cJ,t.Header=this.M(),t.Body=this.f,t);var i=new _cz.et(this.L);n.bw(r,i,this.J,this.H)},cI:function(n){this.j=n.EmptySuggestionsHint;if(n.MeetingTimeCandidates){this.e=new Array(n.MeetingTimeCandidates.length);for(var t=0;t<n.MeetingTimeCandidates.length;t++)this.e[t]=n.MeetingTimeCandidates[t]}}};_cts.e=function(){};_cts.e.b=function(n,t){if(!n&&!t)return!1;if(!n||!t||n.length!==t.length)return!0;n.sort(_cts.e.a);t.sort(_cts.e.a);for(var i=0;i<n.length;i++)if(!_ff.e.b(n[i],t[i]))return!0;return!1};_cts.e.a=function(n,t){var r=n.Name||"";var i=t.Name||"";return r.localeCompare(i)};_cts.f=function(n){this.c=this.a;this.f=this.b;_cts.f.initializeBase(this);this.p=n;for(var r=this.p.AttendeeAvailabilities,u=r.length,t=0;t<u;++t){var i=r[t];i.Availability==="Busy"?this.t++:i.Availability==="Unknown"&&this.u++}};_cts.f.prototype={p:null,a:function(){return _a.d.b(this.p.MeetingTimeslot.StartTime)},b:function(){return this.a().p(this.p.MeetingTimeslot.DurationInMinutes)},i:function(){return this.p.MeetingTimeslot.DurationInMinutes},d:function(){if(this.p.Locations&&this.p.Locations.length>0){var n;return n=new _g.f,n.EmailAddress=this.p.Locations[0].EmailAddress,n.Name=this.p.Locations[0].DisplayName,n}return new _g.f},o:function(){return _j.h.c(_tss.CalTSStrings.M,this.a().a(7),this.a().a(18),this.b().a(18),this.w())},x:function(){return this.u>0||this.t>0},w:function(){return this.x()?this.t>0&&this.u>0?String.format(_tss.CalTSStrings.L,this.t,this.u):this.t>0?String.format(_tss.CalTSStrings.A,this.t):String.format(_tss.CalTSStrings.B,this.u):_tss.CalTSStrings.Q},t:0,u:0,v:null,E:function(){return!0},l:function(){return null},H:function(){return!0},G:function(){return!0},s:function(){return null},B:function(){return!1},r:function(){return"None"},e:function(){return null},m:function(){return"NoData"},z:function(){return null},n:function(){return null},j:function(){return new _g.e},q:function(){return!0},h:function(){return!!this.a().k(this.b().d())},D:function(){return!1},bs:function(){return this.h()&&this.b().e(this.a())<864e5},g:function(){return null},C:function(){return"Unspecified"},bt:function(){return null}};_cts.d=function(){this.s=Function.createDelegate(this,this.x);_cts.d.initializeBase(this);this.w(new _j.l);this.z(new _j.l)};_cts.d.prototype={r:!1,v:!1,m:null,p:null,o:null,q:null,u:null,j:function(n){this.u=n;return n},d:function(){return"SelectedCandidate"},e:function(){return this.r},g:function(n){this.r=n;this.eE("IsLoading");this.B(!n&&!this.m.x.length);return n},B:function(n){this.v=n;this.eE("ShowNoResultsMessage");return n},i:function(){return this.q},A:function(n){if(this.q!==n){this.q=n;this.eE("NoResultsMessage")}return n},a:function(){return this.m},w:function(n){this.m&&this.m.f(this.s);this.m=n;n&&this.m.e(this.s);return n},h:function(){return this.p},z:function(n){this.p=n;this.eE("FilteredMeetingTimeCandidates");return n},b:function(){return this.o},c:function(n){if(this.o!==n){this.o=n;this.eE("SelectedCandidate")}return n},f:function(){var n=-1;this.o&&this.m&&this.m.x.length>0&&(n=this.m.m(this.o)+1);return n},y:function(n,t){this.m.g();if(n){for(var r=new Array(0),i=0;i<n.length;i++)r.push(new _cts.f(n[i]));this.m.j(r)}this.C(t);this.g(!1)},C:function(n){this.A(_tss.CalTSStrings.O)},x:function(n,t){if(_cc.a.o())if(t.c===2){this.p.g();for(var u=t.b,e=u.length,r=0;r<e;++r){var o=u[r];o.dispose()}}else if(!t.c)for(var i=0;i<3&&i<t.a.length;i++){var f=t.a[i];f.v=this.u;this.p.a(f)}},eG:function(){this.w(null);_y.lB.prototype.eG.call(this)}};_cts.j=function(n,t,i,r,u){this.d=n;this.e=t;this.h=i;this.f=r;this.g=u;if(_cc.a.o()){this.c=20;this.b=8}else{this.c=6;this.b=_cc.a.P()?1:3}};_cts.j.prototype={d:null,e:null,h:null,f:null,c:0,b:0,g:null,a:function(n,t,i,r,u,f,e){return new _cts.b(this.d,this.e,this.h,this.f,new _cts.h(this.g),n,t,i,r,f||this.c,e||this.b,u)}};_cts.b=function(n,t,i,r,u,f,e,o,s,h,c,l){this.E=Function.createDelegate(this,this.W);this.C=Function.createDelegate(this,this.U);this.D=Function.createDelegate(this,this.V);this.M=Function.createDelegate(this,this.Z);this.w=new Array(0);this.u=new Array(0);_cts.b.initializeBase(this);this.H=n;this.X(new _cts.d);this.r.j(new _j.g(this.M,_cts.b.a));this.f(s);this.u=o;if(f){var v=this;f.o(function(n){v.N(n,!0)})}if(e){var a=this;e.o(function(n){a.N(n,!1)})}this.J=u;this.s=t;this.apcl(_cts.b.b,this.D);this.apcl(_cts.b.c,this.C);this.r.apcl("SelectedCandidate",this.E);this.Q=i;this.O=r;this.G=l;this.B=c;this.K=h};_cts.b.d=function(n){if(_g.n.e(n))return n.ItemId.Id;var t=n.EmailAddress;t||(t=_g.n.c(n));return t.toLowerCase()};_cts.b.prototype={K:0,B:0,z:0,r:null,t:null,J:null,H:null,s:null,A:!1,Q:null,O:null,v:null,L:null,l:function(){return this.z},f:function(n){if(this.z!==n&&n>0){this.z=n;this.eE(_cts.b.b)}return n},q:function(n){if(this.L!==n){this.L=n;this.x(!0)}return n},G:!1,d:function(){return this.v},Y:function(n){if(!n||!this.v||this.v.StartTime!==n.StartTime||this.v.DurationInMinutes!==n.DurationInMinutes){this.v=n;this.x(!0)}return n},e:function(){return this.r.f()},b:function(){return this.t&&this.r.a()&&this.t.Q?this.t.Q.activityId:null},a:function(){return this.r},X:function(n){this.r=n;return n},c:function(){return this.w},n:function(n){if(this.w!==n){this.w=n;this.x(!0)}return n},p:function(){return this.u},g:function(n){if(_cts.e.b(this.u,n)){var t=this.u;this.u=n;(this.P()||this.t&&!this.t.o())&&this.r.b()&&(!this.P()||this.T(t))||this.x(!0)}return n},x:function(n){if(this.A!==n){this.A=n;this.eE(_cts.b.c)}return n},i:function(){return"FindMeetingTimeCandidatesActionSucceeded"},h:function(){return"FindMeetingTimeCandidatesActionFailed"},y:null,o:function(n){this.y=n;return n},j:function(n,t){var i=null;this.v&&(i=_a.d.b(this.v.StartTime));if(!i||n.b(i)<0||t.c(-this.B).b(i)>0){var r=new _dg.cl;r.StartTime=n.i();r.DurationInMinutes=this.B*1440;this.Y(r)}},U:function(n,t){this.S()},P:function(){return!!this.u&&this.u.length>=0},V:function(n,t){this.x(!0)},W:function(n,t){if(this.r.b()){this.s.a(_cts.b.a,"TimeSuggestions_SuggestionSelected",!0,null);this.s.f("suggestionSelected",this.e());this.s.f("start",this.r.b().c().w());this.s.f("end",this.r.b().f().w());this.s.f("tts",this.r.b().c().w()-_a.d.get_utcNow().w());this.s.e("source",this.y);this.s.b(null);this.y=null}},N:function(n,t){var r=n.a();if(r.b()!==3){var i;this.w.push((i=new _dg.bz,i.Email=_cts.b.d(r.a()),i.IsRequired=t,i))}},S:function(){if(this.A){this.x(!1);if(this.w.length&&this.v){this.r.c(null);this.r.a().g();var r,e,u,t,n;var s=(n=new _cz.bm,n.SearchConstraints=(r=new _cz.cN,r.MeetingDurationInMinutes=this.z,r.SearchWindows=[this.v],r),n.AttendeeConstraints=(e=new _cz.cK,e.AttendeeEntries=this.w,e),n.Constraints=(u=new _cz.cL,u.MaxCandidates=this.K,u.ReturnSuggestionHints=!1,u),n.LocationConstraints=(t=new _cz.cM,t.LocationEntries=this.u?this.u:null,t.IsRequired=!!this.u&&this.u.length>0,t.SuggestLocation=!1,t),n);this.t=this.J.b(s);var i=this;this.t.b(function(n){i.s.f("numRetrieved",n.e.length);i.s.b(null);var t=n;t===i.t&&i.r.y(t.e,t.j);i.eE("FindMeetingTimeCandidatesActionSucceeded")});var f=this;this.t.a(function(n){var t=n;var i="";t!==f.t?i="User activity caused the request to time out":t.G?i=t.G.message:t.e&&t.e.length||(i="Empty Response");f.s.b(i);f.eE("FindMeetingTimeCandidatesActionCompleted")});var o=this;this.t.c(function(){o.r.g(!1);o.eE("FindMeetingTimeCandidatesActionFailed")});this.s.a(_cts.b.a,"TimeSuggestions_FindSuggestions",!0,null);this.H.a(this.t);this.r.a().g();this.r.g(!0)}}},m:function(n,t,i){var r=this.R(t,i);this.s.a(_cts.b.a,n,!0,null);this.s.f("selectedSuggestionIndex",r);this.s.d("isNewEvent",this.G);this.s.f("start",t.w());this.s.f("end",i.w());this.s.b(null)},T:function(n){if(!this.r.b()||!this.r.b().d())return!1;var i=_cc.a.I(this.u,this.r.b());var t=_cc.a.I(n,this.r.b());return i&&!t},eG:function(){this.rpcl(_cts.b.b,this.D);this.rpcl(_cts.b.c,this.C);this.r.rpcl("SelectedCandidate",this.E);_a.gb.prototype.eG.call(this)},R:function(n,t){var r=-1;if(this.r.a()&&this.r.a().x.length>0){var i=null;var u=this;this.r.a().o(function(r){var u=r;_a.d.c(u.a(),n)&&_a.d.c(u.b(),t)&&(i=u)});i&&(r=this.r.a().m(i)+1)}return r},Z:function(){this.y="List"}};_cts.k=function(){};_cts.k.a=function(){return _fm.b.a(_fm.a.dI)};_cts.a=function(){};_cts.a.$$cctor=function(){_cts.a._I()};_cts.a.q=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div></div> </div><div> <span class='_cts_3 _cts_4 ms-fcl-tp'></span> <span class='ms-font-s ms-font-weight-semibold _cts_4'></span> <div> <span class='_cts_5 ms-font-xs ms-fcl-ns'></span> <div class='_cts_2'></div> </div> <div class='_cts_6 ms-border-color-neutralLight'></div> </div><div>  <span class='ms-font-s'></span> <br/> <span class='ms-font-xs ms-fontWeight-semibold ms-fcl-tp'></span> <span class='ms-font-xs ms-fontWeight-semibold ms-fcl-tp'></span> </div><div> <button type='button' class='_cts_8'></button> </div>";_j.i.a().appendChild(n);return n};_cts.a.B=function(n){return n.v};_cts.a.z=function(n){return n.q};_cts.a.p=function(n){return n.r};_cts.a.y=function(n){return n.p};_cts.a.A=function(n){return n.o};_cts.a.u=function(n){return n.x()};_cts.a.i=function(n){return n.a()};_cts.a.n=function(n){return n.bE()};_cts.a.o=function(n){return n.X};_cts.a.k=function(n){return n.e()};_cts.a.D=function(n){return n.o()};_cts.a.E=function(n){return n.v};_cts.a.m=function(n){return n.X};_cts.a.j=function(n){return _fce.a.isInstanceOfType(n)?n.gV():null};_cts.a.x=function(n,t){n.a(t)};_cts.a.c=function(n,t){n.a(t)};_cts.a.d=function(n,t){n.K(t)};_cts.a.t=function(n,t){n.b(t)};_cts.a.v=function(n,t){n.bk(t)};_cts.a.C=function(n,t){n.c(t)};_cts.a.w=function(n,t){n.be(t)};_cts.a.r=function(n,t){n.Q(t)};_cts.a.s=function(n,t){n.T(t)};_cts.a.l=function(n,t){n.l=t};_cts.a.g=function(){_cts.a.e||(_cts.a.e=new _fc.k);return _cts.a.e};_cts.a.h=function(){_cts.a.f||(_cts.a.f=new _b.T);return _cts.a.f};_cts.a._I=function(){var i="TimeSuggestionsListView._tid1";new _j.d(i,function(){_cts.a.a[i]===undefined&&(_cts.a.a[i]=[null]);var t=_cts.a.b.childNodes[0].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",_cts.d,_fce.a,function(n){return new _fce.a(n,_j.b.Instance.a(_ff.a))},!1,!0,!1,0,_cts.a.a);var r="TimeSuggestionsListView";new _j.d(r,function(){_cts.a.a[r]===undefined&&(_cts.a.a[r]=[[[-1,4,null,null,null,"Id",null,_cts.a.x,0,null,null,null,_cts.k.a()]],[[-1,4,null,null,null,"Text",null,_cts.a.c,0,null,null,null,_tss.CalTSStrings.P]],[[-1,0,["ShowNoResultsMessage"],[_cts.a.B],null,"IsHidden",null,_cts.a.d,1,_cts.a.g(),null,!0],[-1,0,["NoResultsMessage"],[_cts.a.z],null,"Text",null,_cts.a.c,1,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_cts.a.t,0,null,null,0,0],[-1,0,["IsLoading"],[_cts.a.p],null,"IsHidden",null,_cts.a.d,1,_cts.a.g(),null,!0]],[[-1,0,["FilteredMeetingTimeCandidates"],[_cts.a.y],null,"DataSource",null,_cts.a.v,1,null,null,null],[-1,0,["SelectedCandidate"],[_cts.a.A],_cts.a.C,"SelectedItem",_cts.a.u,_cts.a.w,2,null,null,null],[-1,0,["IsLoading"],[_cts.a.p],null,"IsHidden",null,_cts.a.d,1,null,null,!0]]]);var n=_cts.a.b.childNodes[1].cloneNode(!0);var t=new _fce.a(n.children[3],_j.b.Instance.a(_ff.a));t.u("MeetingTimeCandidateView");t.bh("_cts_7 ms-border-color-neutralLight");t.y("TimeSuggestionsListView._tid1");var i=new _fce.h(_j.a.a(n,[2,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));i.A(0);i.a=6;var u=new _fc.a(_j.a.a(n,[2,0]));u.A(0);var e=new _fc.a(n.children[1]);var f=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[f,e,u,i,t])},"",_cts.d,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_cts.a.a);var n="MeetingTimeCandidateView._tid2";new _j.d(n,function(){_cts.a.a[n]===undefined&&(_cts.a.a[n]=[[[-1,0,["Start"],[_cts.a.i],null,"Text",null,_cts.a.c,1,_cts.a.h(),7,null],[-1,5,["IsHovered"],[_cts.a.n],null,"ms-fcl-b:ms-fcl-np",null,null,1,null,null,null]],[[-1,1,["TemplatedParent","IsSelected"],[_cts.a.o,_cts.a.k],null,"IsHidden",null,_cts.a.d,1,_cts.a.g(),null,!0],[-1,0,["Start"],[_cts.a.i],null,"Text",null,_cts.a.c,1,_cts.a.h(),0,null]],[[-1,1,["TemplatedParent","IsSelected"],[_cts.a.o,_cts.a.k],null,"IsHidden",null,_cts.a.d,1,null,null,!0],[-1,0,["Start"],[_cts.a.i],null,"Text",null,_cts.a.c,1,_cts.a.h(),0,null],[-1,5,["IsHovered"],[_cts.a.n],null,"ms-fcl-np:ms-fcl-ns",null,null,1,null,null,null]]]);var t=_cts.a.b.childNodes[2].cloneNode(!0);var u=new _fc.a(t.children[3]);var r=new _fc.a(t.children[2]);var i=new _fc.a(t.children[0]);return new _j.a(t,[i,r,u])},"",_cts.f,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_cts.a.a);var t="MeetingTimeCandidateView";new _j.d(t,function(){_cts.a.a[t]===undefined&&(_cts.a.a[t]=[[[-1,0,["AriaLabel"],[_cts.a.D],null,"AriaLabel",null,_cts.a.r,1,null,null,null],[-1,0,["ClickCommand"],[_cts.a.E],null,"ClickCommand",null,_cts.a.s,1,null,null,null]]]);var u=_cts.a.b.childNodes[3].cloneNode(!0);var i=new _fc.b(u.children[0]);var f=new _fc.g;var n=new _fc.c;n.W(_j.f.a(["ContextParent","SelectActiveItemCommand"],[_cts.a.m,_cts.a.j],null,"Command",null,_cts.a.l,1));n.j("SPACE");var r=new _fc.c;r.W(_j.f.a(["ContextParent","SelectActiveItemCommand"],[_cts.a.m,_cts.a.j],null,"Command",null,_cts.a.l,1));r.j("ENTER");f.a([n,r]);i.C([f]);i.y("MeetingTimeCandidateView._tid2");return new _j.a(u,[i])},"",_cts.f,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_cts.a.a)};CalendarTimeSuggestionsComponent.registerClass("CalendarTimeSuggestionsComponent",null,_a.jv,_j.ce);_cts.g.registerClass("_cts.g",_h.dr.$$(_cz.gk,_cz.gl));_cts.i.registerClass("_cts.i",_cts.g);_cts.f.registerClass("_cts.f",_a.bu,_mco.j,_j.bs,Sys.IDisposable,_dg.s,_dg.ef,_g.hz,_dg.dZ);_cts.d.registerClass("_cts.d",_y.lB,_mco.bc,_j.bs,Sys.IDisposable);_cts.b.registerClass("_cts.b",_a.bu,_mco.bf,_j.bs,Sys.IDisposable);CalendarTimeSuggestionsComponent.$$cctor();_cts.c.a="/Scheduling/api/v1.0/me/findmeetingtimescandidates";_cts.b.c="HasContextChanged";_cts.b.b="Duration";_cts.b.a=_a.a.dj;_cts.a.b=_cts.a.q();_cts.a.e=null;_cts.a.f=null;_cts.a.a={};_cts.a.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.timesuggestions.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.timesuggestions.js'] = (new Date()).getTime();
