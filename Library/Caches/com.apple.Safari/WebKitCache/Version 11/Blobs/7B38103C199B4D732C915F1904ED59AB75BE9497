window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.moderngroupscore.js'] = (new Date()).getTime();
Type.registerNamespace("_xc");_xc.l=function(){};_xc.l.registerInterface("_xc.l");_xc.i=function(n,t,i,r,u,f,e,o,s,h){_xc.i.initializeBase(this,[n,t,i,r,u,f,o,null,e,h,-1,!1]);this.r.explicitLogonUser=n.a.Mailbox.EmailAddress;this.bt=s;this.bs=!!h};_xc.i.prototype={bt:null,by:function(){return this.bt},bn:function(n){return n?_xc.i.b:_xc.i.a},bs:!1};function ModernGroupsCoreComponent(){}ModernGroupsCoreComponent.$$cctor=function(){_a.t.a().a(ModernGroupsCoreComponent)};ModernGroupsCoreComponent.prototype={b:function(n,t,i){n.e(_xc.r).b(_h.cY).a();var f=this;n.b(_xs.l,function(){return new _xc.v(n.a(_a.f))}).a();var u=this;n.b(_mgn.R,function(){return new _xc.g(n.a(_h.bE),n.a(_h.cY),n.a(_xs.l))}).a();var r=this;n.b(_y.eM,function(){return new _xc.j(n.a(_y.a),n.a(_j.j),n.a(_a.bo),n.a(_bc.a),n.a(_y.s),n.c(_xc.l),n.c(_xs.j),n.a(_a.f))}).a();_a.c.m("NavigateFromMeToWeSpace")},a:function(){return null}};_xc.n=function(){};_xc.n.registerInterface("_xc.n");_xc.x=function(){};_xc.x.registerInterface("_xc.x");_xc.t=function(n){this.c=n};_xc.t.prototype={c:null,b:function(n){var i=n;var t="";i==="previously-loaded"&&(this.c&&this.c.a().bD().Enabled?t=_nbs.a.Lq:this.c&&this.c.a().bE().Enabled&&(t=_nbs.a.BQ));return new _xz.a(t,i,!!this.c&&this.c.a().bE().Enabled)},a:function(){return!1}};_xc.u=function(n,t){var i=this;_xc.u.initializeBase(this,[new _xc.t(t),function(n){return n}]);this.d=n};_xc.u.prototype={d:null,i:function(n){var r=n;var i=this.d.eD(r);var u=i?"previously-loaded":"newly-loaded";var t=this.c.c(u);i||t.b(!0);return t}};_xc.v=function(n){this.d=Function.createDelegate(this,this.b);this.c=n};_xc.v.prototype={c:null,b:function(n,t,i){return this.c&&this.c.a().L().Enabled?new _xc.o(n,t,i,this.c):new _xc.h(n,t,i,this.c)}};_xc.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.pA=Function.createDelegate(this,this.sU);this.ku=Function.createDelegate(this,this.pF);this.pz=Function.createDelegate(this,this.sJ);this.mX=Function.createDelegate(this,this.sE);this.mY=Function.createDelegate(this,this.sI);_xc.d.resolveInheritance();this.dC=this.sV;_xc.d.initializeBase(this,[n,t,i,r,u,null,f,o,p,e,null,h,null,null,null,c,null,null,null,null,null,null,a,null,v,null,null,!1]);this.gI=!0;this.bl(this.gm());this.dG(!0);this.eu(_xc.d.b);this.nj=s;this.nb=new _y.eD(n.a());this.eZ.b(_mgn.E,this.mY);this.ne=l;this.ng=a;this.nh=y;this.hR=!1;this.hj=new _xc.k(this.eZ,r,_mgs.X.d,_mgs.X.Bl);this.hj.apcl("IsClosed",this.mX)};_xc.d.e=function(n,t){var i=!0;return _xc.d.c(i)};_xc.d.c=function(n){return n?"GroupConversationFeedView":"GroupConversationListView"};_xc.d.prototype={nb:null,nj:null,ng:null,nh:null,gI:!1,hO:null,kw:null,iY:null,ne:null,hR:!1,kx:null,nc:!1,gH:null,hP:0,hQ:null,nf:!1,ni:null,iX:null,dE:function(){this.iX={};var n=[];this.hL(_u.R.N,this.iK,3,null,n);this.hL(_u.R.Up,this.iq,4,null,n);this.hL("",null,5,new _fm.i,n);this.hL(_u.R.FC,this.mZ,0,null,n);this.hL(_u.R.Oc,this.K(),1,null,n);this.hL(_u.R.TD,this.L(),2,null,n);if(this.gH){this.gH.p.g();this.gH.p.j(n)}else this.gH=new _fm.e(n);this.gH.t=this.pz},mZ:null,dF:function(n){this.mZ=n;return n},sQ:function(n){if(this.gI!==n){this.gI=n;this.eE("IsFeedView")}return n},dG:function(n){this.nc=n;this.eE("FocusItemOnSelect");return n},fx:function(){return this.hO},bt:function(n){if(this.hO!==n){this.hO=n;this.pG(n);if(n){this.E(null);this.ex(_g.y.f(this.hO),null);this.hQ=null}else this.ex(null,null);this.gm()&&this.eE("ShowNewConversationLabel");this.eE("RefreshButtonAriaLabel");this.eE("ModernGroup")}return n},sU:function(n){var i=this.eU;var t=new _h.cD;t.l(i.bD.FolderId);t.f([i]);t.o=0;t.r=n;_a.g.a.a(t)},hk:function(){return this.eK.a().x.length},sH:function(n){this.iW=!1;if(!this.fB)return _nbs.a.jZ;if(this.fB===1)return _nbs.a.jl;var t;if(this.fB>99){t="99+";this.iW=!0}else if(n||this.hk()>0&&!(this.hk()%this.gr())&&this.hk()===this.fB){t=this.fB+"+";this.iW=!0}else t=this.fB.toString();return String.format(_nbs.a.qG,t)},iW:!1,fB:0,sR:function(n){if(this.kx!==n){this.kx=n;this.eE("NewConversationLabelText")}return n},kD:function(n,t){var i=_lv.h.prototype.kD.call(this,n,t);if(i){var r=this.fx();i.R=r.bD.SmtpAddress}return i},gf:function(n){return this.gu&&this.gm()?new _xc.u(this,this.fe):null},hv:function(){var i=null;if(this.eU){var n=this.eU;var t=new _g.i;t.cX(n.bD.ConversationTopic);if(n.a()&&n.a().b()>0){t.ca(n.a().a(0));i=t}}return i},oY:function(n){var i;var u=_a.c.b(_a.a.cL,"ReadingPanePopOut",!0,(i=new _a.L,i.a=!0,i));u.p(_xc.d.d);var f={};f.ItemID=n.bD.ItemId.Id;var t=new _y.n(!0);t.c(this.eO.b);t.g(this.gh());t.d(this.gk);t.e(!1);t.a(n);t.f(_h.n.a(this.j()));t.j(this.ip);t.bG(u);this.kv()&&t.l(this.kv().bD.SmtpAddress);var r=_h.a.a(n.bD.ParentFolderId);r&&t.h(r.bD.DisplayName);t.i(this.fJ);this.ff.g(_y.eg,null,f,_bc.d.a(),t,!1)},kv:function(){return this.kw},pG:function(n){if(this.kw!==n){this.kw=n;this.eE("ModernGroupFromSelectedConversation")}return n},iV:!1,sF:function(){return this.nb.j(this.hO)},dD:function(){return this.hM()?!this.pC():!this.C()||this.C()===1},hN:function(){return this.fe.a().bD().Enabled&&!this.hM()},iZ:function(){return this.fe.a().bE().Enabled&&!this.hM()},gm:function(){return this.hN()||this.iZ()},pD:function(){return!this.fx().isMember&&(this.fx().b===1||this.fx().b===2)},sG:function(){return this.hN()&&!this.pD()||this.iZ()&&this.fB>0&&!this.pD()},pC:function(){if(this.hP===2||this.hP===3)return!0;if(this.eM&&_xs.c.isInstanceOfType(this.eM)){var n=this.eM;return n.d()}return!1},hM:function(){return!!this.eM&&this.eM.e()||!!this.hP},dH:function(n){if(this.hP!==n){this.hP=n;this.eI("IsCrossGroupSearch","IsInSearchMode")}return n},na:!1,bu:function(n){this.na=n;return n},dI:function(n){if(this.hR!==n){this.hR=n;this.eE("ShowSuggestPublicGroupsSearchBar")}return n},hj:null,gr:function(){return this.gI?15:_lv.b.prototype.gr.call(this)},lF:function(){return"ModernGroupConversationSearch"},pE:function(){if(!this.fx())return!1;if(this.fx().bD.SmtpAddress!==this.ni){this.nf=_mr.W.a(this.fe,this.fx().bD.SmtpAddress,this.nh);this.ni=this.fx().bD.SmtpAddress}return this.nf},eD:function(n){n.G=n.h().o().b(this.fx().o().o())<=0;return n.G},ct:function(n,t){n===3&&this.hR&&this.dB();this.fw=!1;this.iN(t);this.gl(!1);this.mA()},dA:function(){this.dH(0)},dB:function(){this.dI(!1)},np:function(n){return new _xc.c(n,this.fx(),this,this.ff,this.fe,this.pE(),this.ng)},oq:function(){return this.he},nq:function(n,t){var r=!!t&&!_j.h.a(t.i);this.sQ(!r);var i=_xc.d.c(this.gI);return new _xc.m(n,t,this.fl,this.gI,i,this.fx())},kE:function(n){var t;var r,i;var u=(i=_h.c.v(n,this.jc,this.nj,this.ne.d,r={val:t}),t=r.val,i);this.fw=t;return u},oX:function(n,t){this.eE("GroupTable");this.ky(!1)},eG:function(){this.eZ.c(_mgn.E,this.mY);this.hj&&this.hj.rpcl("IsClosed",this.mX);this.eM&&this.eM.v("InSearchMode",this.ku);_lv.b.prototype.eG.call(this)},kG:function(n,t,i,r){this.fS?n.M(this.iY,t,i,r):_lv.h.prototype.kG.call(this,n,t,i,r)},ow:function(n,t,i,r,u){var f=this.eM.b();return this.eM.f().g(n,t,i,r,!0,u,[f.c()],f.d()?10:0,f.a())},pr:function(){return this.eK.i()||this.iV},oW:function(){this.eE("ShouldShowCompose");if(_xs.c.isInstanceOfType(this.eM)){var n=this.eM;n.A()}},mv:function(n){this.na||_lv.b.prototype.mv.call(this,n)},oR:function(n){n&&_xt.h.isInstanceOfType(n)&&this.eM&&this.sM(n)},sM:function(n){this.fe.a().fq().Enabled&&!n.f()&&this.sL(n)},sL:function(n){var r=this.eM.b();var t=this.eM.f().b(n.c(),n.a(),n.b(),null,null,!0,n.e(),[3],1,r.a());if(t){var i=this;t.e(function(t,r){i.sK(r.a(),n.d(),r.b(),3,1)});t.a()}},sI:function(n){if(this.eK){var t=this.eK.l(n.a);if(t){this.E(t);_mgn.h.a()}else{this.cu(n.a,n.b);this.eK.M(n.a,new _h.m(0,this.gr()),200,null)}}},sK:function(n,t,i,r,u){if(this.hM()&&u===1&&this.fe.a().fq().Enabled&&r===3&&n&&n.b()>=1){this.hj.v(n,t,i,i,r);this.dI(!0)}},sE:function(n,t){this.dB()},mq:function(){this.eM&&this.eM.v("InSearchMode",this.ku)},ms:function(){this.eM&&this.eM.q("InSearchMode",this.ku);this.eE("ShowNewConversationLabel");this.bl(this.gm());this.eE(_lv.b.e);this.pF(null,"IsInSearchMode")},ez:function(){return this.gm()},mr:function(n,t){_lv.b.prototype.mr.call(this,n,t);t.c===2&&this.sO(t.b);this.sP();this.gm()&&(this.hN()&&this.iW&&(!t.c||t.c===2||t.c===1)&&t.f===4?this.ky(!0):this.ky(!1))},ky:function(n){if(this.gm()&&this.eK&&this.eK.a()){var i;if(this.fB>0&&this.fB<=this.hk()&&!this.eD(this.eK.a().x[this.fB-1]))i=this.fB;else{i=0;this.fB=0}for(var t=i;t<this.hk();t++)if(this.eD(this.eK.a().x[t]))break;else this.fB++;if(this.hN()){this.sR(this.sH(n));this.eE("UnseenConversationCount")}this.iZ()&&this.eE("ShowNewConversationLabel")}},sS:function(){var n=this;_j.m.a().a(_a.a.h,"ShowStartNewConvGroupOobe",function(){var t;n.eZ.a(IGroupsOobeEvent,(t=new _mgn.p,t.b=1,t))},1e3)},sT:function(){if(this.fS){var n=null;if(this.eK&&this.hk()>0){n=this.eK.l(this.iY);if(n){this.bo(1);this.bb(0);this.kl(n);this.bb(1);this.bo(0)}}if(n||this.eK&&!this.eK.d()){this.sD();_mgn.h.a()}}},oD:function(n,t){return this.fx().bD.DisplayName},md:function(n,t){_lv.b.prototype.md.call(this,n,t);this.sT()},fO:function(){_lv.h.prototype.fO.call(this);if(this.fe.a().l().Enabled&&this.eU){var i=this.eU;var n=i.bD.FolderId;if(i){var r=this;this.hw.a(function(t){t.r(i,n,r.fC())})}if(n&&n.a.Mailbox.EmailAddress){var t=_g.y.c(n.a.Mailbox.EmailAddress);if(this.kv()&&t.bD.SmtpAddress!==this.kv().bD.SmtpAddress){this.pG(t);this.eZ.a(_y.dW,new _y.dW(t))}}}this.sS()},sD:function(){this.fS=!1;this.iY=null;this.gR=null},cu:function(n,t){this.fS=!!n;this.iY=n;this.gR=t},oV:function(n){this.C()===1&&this.eK&&this.hk()>0&&this.dq(0)},sO:function(n){if(this.eU&&!this.eU.bD.IsDeepLinkedConversation)for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];if(this.eU===r){this.E(null);break}}},sP:function(){var t=this.eU;if(this.eU&&this.iV&&t.bD.IsDeepLinkedConversation){var n=this.eK.l(t.bD.ConversationId.Id);if(n){this.bo(1);this.bb(0);this.E(n);this.bb(1);this.bo(0)}}!this.eU&&this.eK.i()&&this.mA()},pF:function(n,t){this.eI("IsInSearchMode","IsCrossGroupSearch")},nd:function(n){return this.iX[_xc.d.a.toString(n)]},hL:function(n,t,i,r,u){r?Array.add(u,r):Array.add(u,new _fm.c(n,null,t));this.pB(i,u.length-1)},pB:function(n,t){this.iX[_xc.d.a.toString(n)]=t},sN:function(n){delete this.iX[_xc.d.a.toString(n)]},sJ:function(){var t=this.gH.p;var u=t.x[this.nd(1)];var f=t.x[this.nd(2)];if(this.pE()){if(this.eU){var r=this.eU.k();u.a(!r);f.a(r)}}else{u.a(!0);f.a(!0)}var n=t.x[this.nd(6)];if(this.hQ&&this.hQ.b()){if(!n){n=new _y.bx(_u.R.Nl,null,this.pA,null,this.hQ,_g.ba.a,!1,null,null,!1);t.a(n);n.a(!1);this.pB(6,t.x.length-1)}}else if(n){n.a(!0);var i=t.m(n);i>0&&t.n(i);this.sN(6);n=null}n&&n.bi()}};_xc.d.a=function(){};_xc.d.a.prototype={deleteContextMenuItemId:0,markReadContextMenuItemId:1,markUnreadContextMenuItemId:2,replyAllContextMenuItemId:3,forwardContextMenuItemId:4,firstSeperator:5,retentionPolicyContextMenuItemId:6};_xc.d.a.registerEnum("_xc.d.a",!1);_xc.c=function(n,t,i,r,u,f,e){this.bU=Function.createDelegate(this,this.dM);this.bT=Function.createDelegate(this,this.dL);this.bS=Function.createDelegate(this,this.dK);this.bR=Function.createDelegate(this,this.dJ);_xc.c.initializeBase(this,[n,i,r,u,e]);this.m.apcl("LastDeliveryTime",this.bR);this.m.apcl("RecentReplys",this.bS);this.m.b()&&this.m.b().apcl("LikeCount",this.bT);this.l&&this.l.fx()&&this.l.fx().unseenData&&this.l.fx().unseenData.apcl("LastVisitedTime",this.bU);this.t=new _y.eD(r.a());t&&(n.R=t.bD.SmtpAddress);this.bZ=f};_xc.c.b=function(n,t){return!n||!n.Mailbox||!n.Mailbox.EmailAddress||!t||!t.Mailbox||!t.Mailbox.EmailAddress?!1:n.Mailbox.EmailAddress.toLowerCase()===t.Mailbox.EmailAddress.toLowerCase()};_xc.c.prototype={t:null,bi:null,bx:null,bZ:!1,bw:function(){this.bi||this.cA(_xc.c.a.b(this.m,this.cy()).d());return this.bi},cA:function(n){if(this.bi!==n){this.bi=n;this.eE("UniqueSenders")}return n},L:function(){return this.m.y()&&this.m.y().b()>0?this.m.y().a(this.m.y().b()-1):this.m.b()},bY:function(){return this.L()?this.L().bD.Preview:this.m.bD.Preview},dw:function(){return this.L()===this.m.b()?!0:this.L()&&this.m.b()?_xc.c.b(this.L().bD.From,this.m.b().bD.From):!1},bV:function(){if(_g.U.isInstanceOfType(this.m.bD.FolderId)){var n=this.m.bD.FolderId;return n.a.Mailbox.Name}return null},cy:function(){this.bx||(this.bx=this.l.pC());return this.bx},cD:function(){return this.l.eM?this.cx():this.t.c(this.m)},cx:function(){return this.t.d(this.m)},cE:function(){return this.t.e(this.bV())},cF:function(){return _j.h.c(_mgs.X.CZ,this.bV())},du:function(){return this.t.f(this.m)},dG:function(){return this.t.l(this.m)},dA:function(){return this.t.k(this.L(),this.m)},dx:function(){return this.t.g(this.m)},dy:function(){return this.t.h(this.m)},dz:function(){return this.t.i(this.m)},dE:function(){return!!this.p&&!this.p.a().X().Enabled&&this.m.bD.MessageCount>1},dC:function(){return!!this.p&&this.p.a().eb().Enabled&&!!this.m&&!!this.m.b()&&this.m.b().co()>0},dD:function(){return!!this.p&&!this.p.a().X().Enabled},cC:function(){if(this.m.b()&&this.m.b().bD.From)return this.m.b().bD.From;else if(this.bw()&&this.bw().length>0)return this.bw()[0].a;return null},bX:function(){if(this.m.b())return this.m.b();else if(this.m.f()&&this.m.f().b()>0&&this.m.f().a(0).toLocaleLowerCase().startsWith("ipm.schedule.meeting"))return new _dg.m;return null},bW:function(){return!this.l.eD(this.m)},dB:function(){return this.bZ?this.m.bD.UnreadCount>0:this.bW()},dF:function(){return this.l.gm()||this.l.hM()?!1:this.bW()},dv:function(){return!!this.p&&this.p.a().y().Enabled},cz:function(){return!!this.p&&this.p.a().cj().Enabled&&!this.p.a().X().Enabled},eG:function(){this.m.rpcl("RecentReplys",this.bS);this.m.rpcl("LastDeliveryTime",this.bR);this.m.b()&&this.m.b().rpcl("LikeCount",this.bT);this.l&&this.l.fx()&&this.l.fx().unseenData&&this.l.fx().unseenData.rpcl("LastVisitedTime",this.bU);_lv.g.prototype.eG.call(this)},r:function(){if(this.cz()){this.bs(this.dI().i());this.bq(this.dH())}else _lv.d.prototype.r.call(this)},bO:function(n,t){this.eE("ShouldHighlightItem");_lv.g.prototype.bO.call(this,n,t)},dI:function(){var n=new _j.q;var t=3;n.d.length<t&&this.m.X()&&n.c(34);n.d.length<t&&this.m.b()&&this.m.b().co()>0&&n.c(33);n.d.length<t&&this.m.bD.HasAttachments&&n.c(2);n.d.length<t&&(this.m.be()==="Low"||this.m.be()==="High")&&n.c(1);return n},dH:function(){if(this.m.bD.MessageCount>1)return this.m.bD.HasIrm||this.m.bD.IsLocked?6:3;else if(this.m.bD.HasIrm||this.m.bD.IsLocked)return 5;else if(_dg.m.isInstanceOfType(this.bX()))return 13;else if(_dg.q.isInstanceOfType(this.bX()))return 17;return-1},dL:function(n,t){this.cz()?this.r():this.eE("ShowLikeCount")},dM:function(n,t){this.eI("HasUnseenMessages","ShowUnseenMarker")},dJ:function(n,t){this.eS("ReceivedTimeAriaLabel","HasUnseenMessages","ShowUnseenMarker")},dK:function(n,t){this.cA(null);this.eN(["MostRecentMessage","Preview","RepliesAriaLabel","IsRecentSenderSameAsInitialSender"])}};_xc.c.a=function(){this.c=new _j.q;this.b=new _j.q};_xc.c.a.c=function(){_xc.c.a.a||(_xc.c.a.a=new _rps.c);return _xc.c.a.a};_xc.c.a.b=function(n,t){var r=new _xc.c.a;if(n.b()){var f=_xc.c.a.c().c(n.b());r.a(n.b().bD.From,f)}n.y()&&n.y().n(function(n){var t=n;r.a(t.bD.From,null)});if(!r.b.d.length){var i;if(n.bD.SenderSMTPAddress){i=new _g.O;i.Mailbox=new _g.f;i.Mailbox.EmailAddress=n.bD.SenderSMTPAddress;n.g()&&n.g().b()>0&&(i.Mailbox.Name=n.g().a(0));r.a(i,null)}if(t){var u=n.bD.FolderId;i=new _g.O;i.Mailbox=u.a.Mailbox;r.a(i,null)}}return r};_xc.c.a.prototype={d:function(){return this.b.i()},a:function(n,t){if(n&&n.Mailbox&&(n.Mailbox.Name||n.Mailbox.EmailAddress)){var i=n.Mailbox.EmailAddress||n.Mailbox.Name;i=i.toLowerCase();if(!this.c.g(i)){this.b.c(new _xc.s(n,t));this.c.c(i)}}}};_xc.k=function(n,t,i,r){this.o=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.p);this.n=Function.createDelegate(this,this.u);_xc.k.initializeBase(this);this.a=null;this.h=n;this.c=t;this.i=new _j.g(this.n,_a.a.cj);this.g=new _j.g(this.m,_a.a.cj);this.j=i;this.l=r};_xc.k.prototype={a:null,i:null,g:null,h:null,j:null,l:null,c:null,f:null,e:null,b:0,d:null,v:function(n,t,i,r,u){this.a=n;if(this.a.b()>75){this.a.k(new _h.m(0,75),null,null);this.a.y(75)}this.f=t;this.e=i;this.d=r;this.b=u},s:function(){var t=0;this.b===3&&(t=1);if(this.a&&this.a.b()>=t){var n=this.a.b();return n<=20?n.toString():String.format(_mgs.X.EN,20)}else return""},t:function(){return String.format(this.j,this.s())},r:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.q,"ms-fcl-ns-b")},q:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.q,"ms-fcl-nt-b")},u:function(){if(this.a){this.c&&this.c.a(this.o);this.h.a(_xs.h,new _xs.h(this.a))}},w:function(n){this.f&&this.d&&this.e&&this.a&&this.b&&n.bG(this.f,this.d,this.e,this.a.b(),_xt.b.toString(this.b))},p:function(){this.eE("IsClosed")}};_xc.j=function(n,t,i,r,u,f,e,o){this.s=Function.createDelegate(this,this.x);this.r=Function.createDelegate(this,this.v);this.u=Function.createDelegate(this,this.i);_xc.j.initializeBase(this,[11,"GroupFiles",n,r,t,i,new _y.be(n.a(),null,new _xc.w,o,null,t),e]);this.a=u;this.m=o;this.o=f;if(this.a){this.a.w=new _j.g(this.u,_a.a.h);o.a().fO().Enabled&&this.a.bB(this.H);this.G.b(_y.bi,this.r)}this.i();this.g=new _y.y};_xc.j.prototype={o:null,a:null,m:null,b:null,g:null,y:function(n){this.b=n;this.eE("GroupFilesModuleContentViewModel");return n},M:function(){if(this.O){this.h&&this.a&&this.a.g.b(this.h);var n=this;this.q(function(t){t.b(n.h)});this.j().c(this.h)}},V:function(){_y.ft.prototype.V.call(this);if(this.O){if(this.a&&this.a.g&&this.a.g.a()!==this.h)this.i();else if(this.h){var n=this;this.q(function(t){t.b(n.h)})}this.j().c(this.h)}else{this.j().d();this.b&&this.b.d()}this.O&&this.a&&this.a.v()},i:function(){this.a&&this.a.g&&this.a.g.a()&&this.f(this.a.g.a())},q:function(n){if(this.b)n&&n(this.b);else{var t=this;this.o.b(function(i){if(!t.b){t.y(i);t.g.c(t.b);t.j().a()&&t.j().a().b()&&t.b.a(t.j().a().a());t.m.a().fO().Enabled&&t.b.e(t.H);t.j().a().apcl("IsModelLoaded",t.s)}n&&n(t.b)})}},x:function(n,t){this.b.a(this.j().a().a())},v:function(n){if(n.b===11){this.a.g.d(n.a);if(this.h)if(this.h.a()!==n.a)this.i();else{var t=this;this.q(function(n){n.c()})}n.g(this)}}};_xc.w=function(){_xc.w.initializeBase(this,[null,null,null])};_xc.w.prototype={iX:function(){return!0}};_xc.g=function(n,t,i){this.b=n;this.d=t;this.c=i};_xc.g.prototype={d:null,b:null,c:null,a:function(n){var f=n.c;var h=new _xc.m(_g.y.f(f).bD.FolderId,null,_xc.g.a,!0,"GroupConversationFeedView",f);var u;var r=this.c;var o,s;var t=(s=_h.c.v(h,this.b,this.d,r.a||(r.a=Function.createDelegate(r,r.b)),o={val:u}),u=o.val,s);if(u){n.f=4;return}var i=_a.c.b(_a.a.bW,"GroupConversationPrefetch",!1,null);i.l=f.bD.SmtpAddress;n.f=1;var e=null;var c=this;e=function(){if(!t.d()||t.v()){t.bn(e);if(t.x())i.m="LoadingFailed";else{n.l&&i.p(_xc.g.b);n.f=2}_a.c.a(i)}};t.bc(e);t.k(new _h.m(0,15),702,null)}};_xc.o=function(n,t,i,r){this.fK=Function.createDelegate(this,this.hd);this.df=_a.I.a();_xc.o.initializeBase(this,[n,t,i,r]);this.eb=i.a("GroupConversationItemQueryTable.ResetOutstandingPostsCountTimerCallback",this.fK,3e4);this.ea=t};_xc.o.prototype={eb:null,cF:0,ea:null,bl:function(){_xc.b.l();_xc.h.prototype.bl.call(this)},fL:function(n,t,i){var r="Group_Conversation_QuickComposeReply_Delivery";this.eb.a();if(!n.t){n.t=!0;this.cF++;n.v=_a.c.b(_a.a.x,r,!1,null);n.v.p(t?_xc.b.k:_xc.b.h);n.v.p(i?_xc.b.j:_xc.b.i)}},fO:function(n){if(n.t){n.t=!1;this.hc();if(n.v){_xc.b.D(n.v,_xc.b.a(n.b(),!1,!1),n.R);n.v=null}}},hd:function(){var n=this;this.df.d(function(n,t){_xc.b.c(2,n,!1,null)});this.fM()},fM:function(){this.cF>0&&this.eh(!0);this.fN(!this.dg())},hc:function(){this.cF--;this.cF<=0&&this.fN(!0)},fN:function(n){this.eb.b();n&&(this.df=_a.I.a());this.cF=0},ed:function(n){if(!this.he(n)){_xc.h.prototype.ed.call(this,n);this.dg()&&this.cF>0&&this.fM()}},ei:function(n,t,i,r){if(n){if(!n.Conversation){t||_j.e.c(this.bC(),"Conversation can't be null for new posts");var f=this.l(n.ConversationId.Id);f&&(n.Conversation=f.bD)}n.Conversation&&t&&r&&(n.Conversation.LastDeliveryTime=n.DateTimeReceived)}if(r)return _xc.h.prototype.ei.call(this,n,t,i,r);var u=_xc.h.prototype.ei.call(this,n,t,i,r);if(u){this.df.a(n.InternetMessageId,new _xc.o.a(n.Conversation.ConversationId.Id));t||this.hb(n)}return u},hb:function(n){var t=_ff.e.a(n,!0);var u=new _bc.h;t.ItemId=u.b;t.InstanceKey="INSK:"+u.a;var r=this.ea.a(200,n.Conversation.ConversationId);var i=r.m(t,null);i.p(!0);i.h(new _a.k(n.ToRecipients));_h.c.u(n.Conversation.ConversationId,this.e(),r)},he:function(n){if(this.dg())return!1;if(this.cF>0)if(n.EventType==="RowAdded"){var i=this.da(n.Conversation.ConversationId.Id);if(i>=0&&i<this.by.x.length){var r=this.by.x[i];if(r.t){var u=this.cU;this.bR(!0);try{this.fO(r);this.by.y(i,4);this.bs(n,!0)}finally{this.bR(u)}this.fP(r);return!0}}}else if(n.EventType==="RowModified"){var t=this.l(n.Conversation.ConversationId.Id);if(t.t&&t.bD.MessageCount<=n.Conversation.MessageCount){this.bu(n);this.fP(t);this.fO(t);return!0}}return!1},eP:function(n,t,i){var r=_xc.h.prototype.eP.call(this,n,t,i);if(i)return r;r&&this.fL(r,!1,t);return r},eQ:function(n,t,i){var r=_xc.h.prototype.eQ.call(this,n,t,i);if(i)return r;r&&this.fL(r,!0,t);return r},bN:function(n,t){var i=this;this.df.d(function(n,t){var r=i.l(t.a);if(r){var u=_h.d.a().a(r.bD.ConversationId.Id);u&&u.s()!==""||_h.c.n(r.bD.ConversationId,n);r.t=!1}_xc.b.c(3,n,!1,null)});this.df=_a.I.a();_h.s.prototype.bN.call(this,n,t)},bx:function(){_xc.b.l();_xc.h.prototype.bx.call(this)},cz:function(n){_lm.f.prototype.cz.call(this,n);var t=n.G.ErrorCode;var i=n.G.ExceptionName;_j.C.a(t)||t!==500||i!=="AccessDeniedException"||(this.co="ErrorAccessDenied")},fP:function(n){var t=this;_h.c.p(203,n,n.bD.FolderId,function(n){var r=n.r();if(r)for(var i=r,f=i.length,t=0;t<f;++t){var u=i[t];_xc.b.c(0,u,!1,null)}},this.ea)}};_xc.o.a=function(n){this.a=n};_xc.o.a.prototype={a:null};_xc.h=function(n,t,i,r){this.fQ=Function.createDelegate(this,this.hv);this.cQ={};this.di=new _j.q;_xc.h.initializeBase(this,[n,t,r]);this.eg=i.a("GroupConversationItemQueryTable.ResetOutstandingPostsCountTimerCallback",this.fQ,1e4)};_xc.h.prototype={ef:!1,dh:!1,ee:!1,cG:0,eg:null,ec:null,H:function(){return this.bY.a().bt().Enabled},dg:function(){return this.ef},eh:function(n){if(this.ef!==n){this.ef=n;this.bw("NeedsRefresh")}return n},bC:function(){return _a.a.bW},v:function(){return _h.s.prototype.v.call(this)&&this.by.x.length>0},cL:function(){return this.bB.f?15:_lm.f.prototype.cL.call(this)},db:function(){return this.bB.f?2e3:_lm.f.prototype.db.call(this)},fR:function(){return!!this.bB.k},ed:function(n){this.dh?this.hm(n):this.bY.a().bt().Enabled&&this.hl(n)},hl:function(n){if(n.EventType==="RowAdded"||n.EventType==="RowModified"||n.EventType==="RowDeleted"){var i=this.cD(n);this.cQ[i]=!0;if(this.cG>0){this.fS(n);return}var r=_ff.o.a(0,6e4);var t=this;_j.m.a().a(this.bC(),"GroupConversationItemQueryTable::HandleRowNotificationWhenOnBackground",function(){t.bK||t.dh||t.bm(703)},r)}},hm:function(n){if(this.hi()&&n.EventType==="Reload"){_j.e.a(this.bC(),"HandleRowNotification: If we reach this point, it means that a thread was deleted and we need to refresh the entire table.");this.eh(!0);return}if(n.EventType==="RowAdded"||n.EventType==="RowModified"||n.EventType==="RowDeleted"){var t=this.cD(n);this.cQ[t]=!0;if(!this.dg()){if(this.cG>0){this.fS(n);return}if(n.EventType==="RowAdded"){if(t in this.ca)return;if(this.hw(n))return}if(n.EventType!=="RowDeleted"||t in this.ca){if(n.EventType==="RowModified")if(t in this.ca){var i=this.cC(t);if(i>=0&&i<this.by.x.length){var f=this.by.x[i];if(f.bD.MessageCount>=n.Conversation.MessageCount)return}}else if(this.by.x.length>0){var u=this.by.x[this.by.x.length-1];var r=_a.d.b(n.Conversation.LastDeliveryTime);if(r.b(u.h())<0)return}_j.e.a(this.bC(),"HandleRowNotification: Table needs refresh.");this.eh(!0)}}}},hs:function(){if(!this.eN()){_j.e.a(this.bC(),"OnPostStarted:: Table is not updatable, ignore call. Key:{0}.",this.bB.a());return}this.bB.f&&this.ho()},eN:function(){return!this.bK&&!this.fR()&&this.dh},bv:function(n,t){if(!this.eN()){_j.e.a(this.bC(),"OnMessageLike:: Table is not updatable. Key:{0}.",this.bB.a());return}if(n&&n.Conversation){var i=n.Conversation.InstanceKey;if(!(i in this.ca)){_j.e.a(this.bC(),"OnMessageLike: Conversation not found in instanceKeyCache, ignore it. InstanceKey {0}.",i);return}var u=this.cC(i);if(u<0||u>=this.by.x.length){_j.e.a(this.bC(),"OnMessageLike: Conversation not found in table, ignore it. InstanceKey: {0}.",i);return}var r=this.by.x[u];if(t){var e;(e=r.b()).cF(e.co()-1)}else{var f;(f=r.b()).cF(f.co()+1)}this.bQ(r,n.Conversation);this.cQ[i]=!0}},hr:function(n,t,i,r){if(!this.eN()){_j.e.a(this.bC(),"OnPostCompleted:: Table is not updatable, ignore call. Key:{0}.",this.bB.a());return}this.ei(n,t,i,r);this.bB.f&&this.hg()},bl:function(){this.dh=!1;if(this.bB.f){this.d()&&!this.v()||this.bT||this.dg()||this.hx();_h.s.prototype.bl.call(this)}},bk:function(){this.dh=!0;_h.s.prototype.bk.call(this)},M:function(n,t,i,r){this.ec=n;this.k(t,i,r);this.ec=null},cI:function(n){if(_g.U.isInstanceOfType(this.e())&&this.hh()){n.a().MailboxId=this.e().Id;return new _h.I(n.a())}else return _lm.b.prototype.cI.call(this,n)},bx:function(){this.fT();_lm.b.prototype.bx.call(this)},dD:function(n,t,i){n.a||this.fT();_lm.f.prototype.dD.call(this,n,t,i)},dL:function(n,t,i,r){var u=new _xc.i(this.e(),this.r(),n,t,this.bS(),this.bG(),r,i,this.bB.h,this.ec);u.s=this.cu;return u},bX:function(n,t,i,r,u,f){r&&_lm.b.prototype.bX.call(this,n,t,i,r,u,f)},cH:function(n){},cK:function(n,t,i,r){this.ee=this.bB.f&&this.hp(n);return this.ee?this.hf(t,i,r):_lm.b.prototype.cK.call(this,n,t,i,r)},eG:function(n,t){this.ee?this.hu(n,t):_lm.f.prototype.eG.call(this,n,t)},hp:function(n){return n in this.cQ},hw:function(n){var t=this.da(n.Conversation.ConversationId.Id);if(t>=0&&t<this.by.x.length){var u=this.by.x[t];var f=u.bD.InstanceKey;var i=this.ca[f];if(i){this.ca[f]=null;var r=n.Conversation.InstanceKey;u.bo(r);this.ca[r]=i;return!0}}return!1},hf:function(n,t,i){var r=new _gg.er;r.Item=new _g.d("ConversationLastDeliveryTime");r.FieldURIOrConstant=new _g.S;var f=new _g.R;f.Value=_a.d.b(t).l(1).i();r.FieldURIOrConstant.Item=f;var e=new _g.bd(r);var u=new _g.be("Beginning",e);u.MaxEntriesReturned=n-1;this.r()&&(this.r().f=this.bV);return this.dL(u,!1,t,i)},hu:function(n,t){for(var i=0;i<n.length;i++){var r=t.d(n[i]);if(!(r in this.ca))break;Array.removeAt(n,i);i--}},fT:function(){this.cQ={};this.eh(!1);this.di.f();this.eO()},ei:function(n,t,i,r){if(this.bK){_j.e.a(this.bC(),"OnPostCompleted:: Table already disposed, ignore call. Key:{0}.",this.bB.a());return!1}if(this.fR()){_j.e.a(this.bC(),"OnPostCompleted:: Table in Search View, ignore call. Key:{0}.",this.bB.a());return!1}if(n&&n.Conversation){var u=null;u=t?this.eQ(n.Conversation,i,r):this.eP(n.Conversation,i,r);return!!u}return!1},ht:function(){for(var n=0;n<this.di.d.length;n++){var t=this.di.d[n];this.ed(t)}this.di.f()},fS:function(n){this.di.c(n)},eP:function(n,t,i){var u=n.InstanceKey;if(u in this.ca){_j.e.a(this.bC(),"UpdateTableWithQuickComposeReponse: Conversation already in table, ignore it. InstanceKey {0}.",u);return null}var r=this.bL(n);this.by.B(0,r,4);this.y(this.bF+1);return r},eQ:function(n,t,i){var u=n.InstanceKey;if(!(u in this.ca)){_j.e.a(this.bC(),"UpdateTableWithQuickReplyResponse: Conversation not found in instanceKeyCache, ignore it. InstanceKey {0}.",u);return null}var f=this.cC(u);if(f<0||f>=this.by.x.length){_j.e.a(this.bC(),"UpdateTableWithQuickReplyResponse: Conversation not found in table, ignore it. InstanceKey: {0}.",u);return null}var r=this.by.x[f];var e=r.h();this.bQ(r,n);if(i){r.bp(_a.d.b(n.LastDeliveryTime));this.by.C(f,0,r,4)}else r.bp(e);r.bg(r.bD.MessageCount+1);r.n(r.bD.UnreadCount+1);r.x(r.bD.GlobalMessageCount+1);r.N(r.bD.GlobalUnreadCount+1);this.cQ[u]=!0;return r},hv:function(){if(this.bK){_j.e.a(this.bC(),"ResetOutstandingPostsCount:: Table already disposed, ignore call. Table Key:{0}.",this.bB.a());return}_j.e.a(this.bC(),"ResetOutstandingPostsCount:: Reset count and process pending notifications for table Key:{0}.",this.bB.a());this.eO()},ho:function(){this.cG++;this.eg.a()},hg:function(){if(!(this.cG<=0)){if(this.cG===1){this.eO();return}this.cG--}},eO:function(){this.cG=0;this.eg.b();this.ht()},hx:function(){var n=this.bB.g;if(n&&n.isMember&&!_mgn.e.a().a(n.a())){this.ew.a(_mgn.d,new _mgn.d(n.bD.SmtpAddress,n.bD.DisplayName,4));n.j=n.unseenData.a();var t;t=new _xh.M(n.bD.SmtpAddress,_a.d.get_utcNow(),this.bY);_a.g.a.a(t)}},hi:function(){return!!this.bY&&this.bY.a().jN().Enabled},hh:function(){return!!this.bY&&this.bY.a().ib().Enabled},hk:function(){return!!this.bY&&this.bY.a().bD().Enabled},cf:function(n,t,i,r,u,f){var s=t.L===700;var h=t.bs;if(this.hk()&&!s&&!h){for(var e=0;e<n.length;e++){var o=this.bL(n[e]);if(this.hn(o))break}if(e&&e!==n.length)while(n.length>e)Array.removeAt(n,e)}_h.s.prototype.cf.call(this,n,t,i,r,u,f)},hn:function(n){var t=this.bB.g;return n.h().o().b(t.o().o())<=0},k:function(n,t,i){if(t===700||t===200){this.hq(n,t,i);return}_lm.f.prototype.k.call(this,n,t,i)},hq:function(n,t,i){var r=n;r.b>this.db()&&(r.b=this.db());this.dD(r,t,i)}};_xc.m=function(n,t,i,r,u,f){_xc.m.initializeBase(this,[n,t,"All",i,null,null,-1]);this.f=r;this.h=u;this.g=f};_xc.m.prototype={f:!1,h:null,g:null,e:function(){var n=null;if(this.k)n=[new _h.dQ(this)];else{var t=new _xc.p(this,!0,this.x(),this.m,this.h);n=[t]}return n}};_xc.b=function(){};_xc.b.B=function(n,t,i,r,u,f){if(_j.h.a(n)){_j.e.c(_a.a.x,"Internet message id can't be null");return null}var o=_xc.b.d+"_"+n;var e=_a.m.b(_a.a.x,_xc.b.d,!0,null,o);if(e){_xc.b.g.c(n);e.p(t?_xc.b.k:_xc.b.h);e.p(i?_xc.b.j:_xc.b.i);r&&e.p(_xc.b.x);u&&e.p(_xc.b.A);f&&e.p(_xc.b.m)}return e};_xc.b.f=function(n,t,i){if(_j.h.a(n)){_j.e.c(_a.a.x,"Internet message id can't be null");return}var f=_xc.b.d+"_"+n;var r=_a.m.c(f);if(r){r.n=t;if(!_j.h.a(i)){var u=new _a.l;u.b(_xc.b.w,i);r.l=u.toString()}}};_xc.b.c=function(n,t,i,r){var f=_xc.b.d+"_"+t;var u=_a.m.c(f);if(u){i&&u.p(_xc.b.C);switch(n){case 0:u.m=null;break;case 1:u.m=r;break;case 2:u.m=_xc.b.y;break;case 3:u.m=_xc.b.z;break;case 4:u.m=_a.c.e;break;default:throw Error.argument("endScenario","Unsupported PostCtqEndScenario type.");}_xc.b.g.n(t);_a.m.a(f)}};_xc.b.l=function(){for(var t=_xc.b.g.i(),n=0;n<t.length;n++)_xc.b.c(4,t[n],!1,null)};_xc.b.e=function(n,t){return _a.m.b(n,t,!0)};_xc.b.D=function(n,t,i){n.l=t;n.s=i;_a.c.a(n)};_xc.b.b=function(n,t,i,r,u){var f=_a.m.c(n);if(f){f.m=t;f.n=i;f.l=r;f.s=u;_a.m.a(n)}};_xc.b.a=function(n,t,i){var c=_xc.b.n;if(n){var h=-1;var o=-1;n.O()&&n.O().bD.Value&&(h=n.O().bD.Value.length);n.bD.Subject&&(o=n.bD.Subject.length);var f=-1;var l=-1;if(n.bf()&&n.bf().b()>=0){var s=0;f=n.bf().b();for(var e=0;e<f;e++)s+=n.bf().a(e).b();l=s/1024>>0}var u=-1;if(n.n()||n.q()||n.z()){u=0;n.n()&&(u+=n.n().b());n.q()&&(u+=n.q().b());n.z()&&(u+=n.z().b())}var r=new _a.l;r.a(_xc.b.r,h);r.a(_xc.b.v,o);r.a(_xc.b.o,100);r.a(_xc.b.p,f);r.a(_xc.b.q,l);r.a(_xc.b.s,u);r.c(_xc.b.t,t);r.c(_xc.b.u,i);c=r.toString()}return c};_xc.p=function(n,t,i,r,u){_xc.p.initializeBase(this,[n,t,i,r,null,-1,u,null,null])};_xc.p.prototype={e:function(){return"GroupRowNotificationStrategy"},f:function(n,t){if(t.bK){_j.e.a(t.bC(),"Abandoning row notification due to associated table [{0}] being disposed.",t.bB.a());return}var i=t;i.bB.f?i.ed(n):_h.x.prototype.f.call(this,n,t)}};_xc.e=function(n,t,i){this.f=n;this.b=t;this.a=i};_xc.e.b=function(n){var o=null;if(!_j.h.a(n)){var t;n=n.replace(_xc.e.d,"");var f,e;if((e=_a.A.a(n,f={val:t}),t=f.val,e)&&!_j.h.a(t)){var i=t.split("\n");var u=_xc.e.f(i);if(u<i.length){var r=i[u].trim();o=r.length<=100?r:r.substring(0,100)}}}return o};_xc.e.a=function(n,t,i,r,u){_xc.e.e(function(i){i.hr(n,t,r,u)},i)};_xc.e.c=function(n){_xc.e.e(function(n){n.hs()},n)};_xc.e.e=function(n,t){var u=_h.g.a().a(t);if(u)for(var f=u,e=f.length,i=0;i<e;++i){var r=f[i];_xc.h.isInstanceOfType(r)&&n(r)}};_xc.e.f=function(n){for(var t=0;t<n.length;){if(n[t].trim().length)break;t++}return t};_xc.e.prototype={f:null,a:null,b:!1,c:function(n){var t=new _g.K;t.Subject=this.b&&!_j.h.b(n.bD.Subject)?n.bD.Subject:_xc.e.b(n.O().bD.Value);t.Body=new _g.s("HTML",n.O().bD.Value);t.ToRecipients=_db.e.a(n.n());t.From=n.bD.From;if(this.a){this.a.d()&&(t.AtAllMention=n.bD.AtAllMention);this.a.c()&&n.cv()&&(t.MentionsEx=_mco.g.a(n.cv(),n.bD.From));this.a.e()&&n.cr()&&(t.Hashtags=n.cr().e())}!n.bD.ItemId&&n.bD.InternetMessageId&&(t.InternetMessageId=n.bD.InternetMessageId);t.ItemId=n.bD.ItemId;_db.e.b(n,t);return t},d:function(n,t,i,r){var u=new _g.bs;u.Subject=t.bD.Subject;u.NewBodyContent=new _g.s("HTML",n.O().a()==="HTML"?n.O().bD.Value:_a.A.b(n.O().bD.Value,!0,!0));var e=0;var f=0;if(n.n()){u.ToRecipients=n.n().e();e=n.n().b()}if(n.q()){u.CcRecipients=n.q().e();f=n.q().b()}u.From=n.bD.From;if(this.a){this.a.d()&&(u.AtAllMention=n.bD.AtAllMention);this.a.c()&&n.cv()&&(u.MentionsEx=_mco.g.a(n.cv(),n.bD.From));this.a.e()&&n.cr()&&(u.Hashtags=n.cr().e())}n.bD.InternetMessageId&&(u.InternetMessageId=n.bD.InternetMessageId);i&&(u.UpdateResponseItemId=i);u.ReferenceItemId=_g.e.a(t.bD.ItemId);u.IsSpecificMessageReply=r;_db.e.b(n,u);return u},e:function(n){if(!n||!n.f())return null;for(var t=0;t<n.f().b();t++){var i=n.f().a(t);if(i.toLocaleLowerCase().startsWith("ipm.note.connectormessage"))return i}return null}};_xc.f=function(n,t,i,r,u,f,e,o,s){_xc.f.initializeBase(this);this.f=n;this.e=r;this.s=_xc.f.b(r,u);this.p=_xc.f.a;this.j=e;this.k=new _xc.e(f,s,o);this.E=t;this.u=i};_xc.f.b=function(n,t){var i=_ff.e.a(_h.b.g());i.ConversationShapeName=t;i.ConversationFolderId=_g.m.c(n);return i};_xc.f.c=function(n,t,i){var r=null;if(n.Items&&n.Items.length>0){r=n.Items[0];if(t.a()==="HTML")r.UniqueBody=new _g.s("HTML",t.bD.Value);else throw Error.notImplemented("Plaintext body is not currently supported in quick compose.");}return r};_xc.f.prototype={e:null,s:null,p:"Folder",f:null,E:0,u:0,k:null,bk:null,j:!1,r:function(){return"QuickCompose"},o:function(n){n.h(this.e.a.Mailbox.EmailAddress,this.e.b)},K:function(n){this.bu();if(this.j){var r=this.bs();var i=this.br();n.cI(r,i,this.J,this.H)}else{var u=this.bt();var t=this.bq();t.explicitLogonUser=this.e.a.Mailbox.EmailAddress;n.cJ(u,t,this.J,this.H)}},cI:function(n){_j.e.a(_a.a.D,"PostModernGroupItemAction.ProcessResponseMessage called");var t=_xc.f.c(n,this.f.O(),this.e);t&&(this.bk=t.ItemId);this.t(t);this.bm()},bb:function(n){_h.fG.prototype.bb.call(this,n);this.t(null);this.bl()},bm:function(){var n=this.O();this.bo(n);_xc.b.b("Group_Conversation_QuickCompose",null,n,_xc.b.a(this.f,!1,!1),this.e.a.Mailbox.EmailAddress)},bl:function(){var t=this.O();var n=this.P();this.bn(t,n);_xc.b.b("Group_Conversation_QuickCompose",n,t,_xc.b.a(this.f,!1,!1),this.e.a.Mailbox.EmailAddress)},t:function(n){_xc.e.a(n,!1,this.e,!1,!1)},bo:function(n){this.j&&_xc.b.f(this.f.bD.InternetMessageId,n,null)},bn:function(n,t){if(this.j){_xc.b.f(this.f.bD.InternetMessageId,n,null);_xc.b.c(1,this.f.bD.InternetMessageId,!1,t)}},bt:function(){var t=new _gg.eG;this.bh(t);var n=new _gg.iY(this.M());n.Body=t;return n},bs:function(){var t=new _gg.eF;this.bh(t);var n=new _gg.iX(this.M());n.Body=t;return n},bi:function(){return[this.k.c(this.f)]},bh:function(n){n.ModernGroupEmailAddress=this.e.a.Mailbox;n.Items=this.bi();n.ShapeName=this.p;n.ItemShape=this.s;n.ClientSupportsIrm=!0;n.UnpromotedInlineImageCount=this.E;n.PromoteEmojiContentToInlineAttachmentsCount=this.u},bq:function(){var n=new _gg.xM(this.L);n.actionName=this.r();return n},br:function(){var n=new _gg.xL(this.L);n.actionName=this.r();return n},bu:function(){_xc.e.c(this.e)}};_xc.q=function(n,t,i){this.e=n;this.d=t;this.f=i};_xc.q.prototype={e:null,d:null,f:0,c:null,b:function(){if(this.c){_j.m.a().b(this.c);this.c=null}},a:function(){this.b();this.c=_j.m.a().a(_a.a.dy,this.e,this.d,this.f)}};_xc.r=function(){};_xc.r.prototype={a:function(n,t,i){return new _xc.q(n,t,i)}};_xc.s=function(n,t){this.a=n;this.b=t};_xc.s.prototype={a:null,b:null,c:function(){return!!this.b}};_xc.a=function(){};_xc.a.$$cctor=function(){_xc.a._I()};_xc.a.w=function(){var n=window.document.createElement("DIV");n.innerHTML="<div>  <span class='_xc_3 _xc_4 ms-font-l ms-font-color-themePrimary'></span> <span class='_xc_6'></span> </div><div> <span class='_xc_2 ms-font-color-neutralSecondary ms-font-color-neutralPrimary ms-font-weight-semilight'></span> <button type='button' class='_xc_5 ms-font-weight-regular'></button> </div><div> <span class='_xc_7 ms-font-weight-semilight ms-font-color-neutralPrimary ms-font-m'></span> <span class='_xc_7 ms-font-weight-semilight ms-font-color-themePrimary ms-font-m'></span> </div><div> <div CssClass=\"suggestionDiv\"> <button type='button'></button> </div> <button type='button' class='_xc_9'></button> </div><div> <div> </div> </div><div> <div></div> </div><div>  <div class='_xc_b'> <div></div> </div>  <div class='_xc_d'></div> </div><div> <div class='_xc_a'> <div class='_xc_c'> <div></div> </div> </div> </div><div> <div class='_xc_e _xc_f'>  <div> <div></div> </div> <div></div> <div> </div> </div> </div>";_j.i.a().appendChild(n);return n};_xc.a.d=function(n){return n.m()};_xc.a.i=function(n){return n.c()};_xc.a.M=function(n){return n.x()};_xc.a.q=function(n){return n.b()};_xc.a.F=function(n){return n.q()};_xc.a.B=function(n){return n.k()};_xc.a.bk=function(n){return n.t()};_xc.a.bl=function(n){return n.l};_xc.a.bj=function(n){return n.i};_xc.a.bh=function(n){return n.g};_xc.a.bi=function(n){return n.r()};_xc.a.u=function(n){return n.q()};_xc.a.c=function(n){return n.a};_xc.a.r=function(n){return n.a};_xc.a.K=function(n){return n.H};_xc.a.N=function(n){return n.b};_xc.a.V=function(n){return n.c};_xc.a.J=function(n){return n.f};_xc.a.U=function(n){return n.e};_xc.a.t=function(n){return n.g};_xc.a.P=function(n){return n.c};_xc.a.s=function(n){return n.d};_xc.a.S=function(n){return n.d};_xc.a.j=function(n){return n.a};_xc.a.R=function(n){return n.h()};_xc.a.Q=function(n){return n.g};_xc.a.bg=function(n){return n.j()};_xc.a.bf=function(n){return _xh.c.isInstanceOfType(n)?n.bm():null};_xc.a.be=function(n){return n.g};_xc.a.p=function(n){return n.b()};_xc.a.g=function(n,t){n.a(t)};_xc.a.E=function(n,t){n.a(t)};_xc.a.n=function(n,t){n.K(t)};_xc.a.o=function(n,t){n.bj(t)};_xc.a.A=function(n,t){n.j(t)};_xc.a.m=function(n,t){n.l(t)};_xc.a.x=function(n,t){n.Q(t)};_xc.a.D=function(n,t){n.c(t)};_xc.a.G=function(n,t){n.m(t)};_xc.a.C=function(n,t){n.j(t)};_xc.a.l=function(n,t){n.T(t)};_xc.a.y=function(n,t){n.m(t)};_xc.a.z=function(n,t){n.s(t)};_xc.a.W=function(n,t){n.f(t)};_xc.a.O=function(n,t){n.b=t};_xc.a.Y=function(n,t){n.g(t)};_xc.a.L=function(n,t){n.bj(t)};_xc.a.X=function(n,t){n.o(t)};_xc.a.h=function(n,t){n.ba(t)};_xc.a.bb=function(n,t){n.e(t)};_xc.a.T=function(n,t){n.E(t)};_xc.a.bd=function(n,t){n.l(t)};_xc.a.bc=function(n,t){n.b(t)};_xc.a.I=function(n,t){n.j(t)};_xc.a.H=function(n,t){n.bT(t)};_xc.a.ba=function(n,t){n.b(t)};_xc.a.Z=function(n,t){n.c(t)};_xc.a.k=function(){_xc.a.e||(_xc.a.e=new _fc.k);return _xc.a.e};_xc.a.v=function(){_xc.a.f||(_xc.a.f=new _fc.l);return _xc.a.f};_xc.a._I=function(){var e="GroupSearchResultsHeader._tid1";new _j.d(e,function(){_xc.a.a[e]===undefined&&(_xc.a.a[e]=[[[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Text",null,_xc.a.g,1,null,null,null]],[[-1,4,null,null,null,"Id",null,_xc.a.E,0,null,null,null,_n.b.cn()]]]);var n=_xc.a.b.childNodes[0].cloneNode(!0);var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_xs.c,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_xc.a.a);var f="GroupSearchResultsHeader";new _j.d(f,function(){_xc.a.a[f]===undefined&&(_xc.a.a[f]=[[[-1,4,null,null,null,"Text",null,_xc.a.g,0,null,null,null,_mgs.X.DH]],[[-1,4,null,null,null,"ImageId",null,_xc.a.m,0,null,null,null,_n.b.cn()],[-1,0,["ShouldShowSortByMenuOnHeader"],[_xc.a.M],null,"IsHidden",null,_xc.a.n,1,_xc.a.k(),null,!0],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Title",null,_xc.a.o,1,null,null,null],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Text",null,_xc.a.A,1,null,null,null],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"AriaLabel",null,_xc.a.x,1,null,null,null]]]);var i=_xc.a.b.childNodes[1].cloneNode(!0);var t=new _fc.b(i.children[1]);var n=new _fce.g(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["SearchResultsSortByManager","SearchResultsSortByContextMenu"],[_xc.a.d,_xc.a.q],null,"MenuDataContext",null,_xc.a.D,1)).U(_j.f.a(["SearchResultsSortByManager","SearchResultsSortByContextMenu","IsShown"],[_xc.a.d,_xc.a.q,_xc.a.F],_xc.a.G,"IsShown",_xc.a.B,_xc.a.C,2,null,null,!1));n.b=1;n.a=3;n.g="headerMenuDropShadow ms-border-color-themeLight";t.C([n]);t.y("GroupSearchResultsHeader._tid1");var r=new _fc.a(i.children[0]);return new _j.a(i,[r,t])},"",_xs.c,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_xc.a.a);var s="SuggestGroupsSearchView._tid2";new _j.d(s,function(){_xc.a.a[s]===undefined&&(_xc.a.a[s]=[[[-1,0,["SuggestGroupSearchPrefechedResultsText"],[_xc.a.bk],null,"Text",null,_xc.a.g,1,null,null,null]],[[-1,0,["SuggestGroupSearchSeeResultsText"],[_xc.a.bl],null,"Text",null,_xc.a.g,1,null,null,null]]]);var n=_xc.a.b.childNodes[2].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_xc.k,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_xc.a.a);var o="SuggestGroupsSearchView";new _j.d(o,function(){_xc.a.a[o]===undefined&&(_xc.a.a[o]=[[[-1,0,["GoToSuggestedGroupSearchCommand"],[_xc.a.bj],null,"ClickCommand",null,_xc.a.l,0,null,null,null]],[[-1,4,null,null,null,"Title",null,_xc.a.o,0,null,null,null,_u.R.QM],[-1,0,["CloseCommand"],[_xc.a.bh],null,"ClickCommand",null,_xc.a.l,1,null,null,null],[-1,0,["CloseImage"],[_xc.a.bi],null,"ImageId",null,_xc.a.m,0,null,null,null],[-1,0,["CloseHoverImage"],[_xc.a.u],null,"HoveredImageId",null,_xc.a.y,0,null,null,null],[-1,0,["CloseHoverImage"],[_xc.a.u],null,"PressedImageId",null,_xc.a.z,0,null,null,null]]]);var n=_xc.a.b.childNodes[3].cloneNode(!0);var i=new _fc.b(n.children[1]);var t=new _fc.b(_j.a.a(n,[0,0]));t.y("SuggestGroupsSearchView._tid2");return new _j.a(n,[t,i])},"",_xc.k,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_xc.a.a);var u="FilesModernNavigationPaneView._tid3._tid4";new _j.d(u,function(){_xc.a.a[u]===undefined&&(_xc.a.a[u]=[[[-1,0,["MailNavigationViewModel","FolderForest","FirstLevelNavigationFolderTrees"],[_xc.a.c,_xc.a.r,_xc.a.K],null,"DataSource",null,_xc.a.W,1,null,null,null],[-1,0,["FirstLevelNavigationSelectedTree"],[_xc.a.N],_xc.a.O,"SelectedTreeData",_xc.a.V,_xc.a.Y,2,null,null,null],[-1,0,["MailNavigationViewModel","FolderForest","ActionTargetFolder"],[_xc.a.c,_xc.a.r,_xc.a.J],_xc.a.L,"DropTargetTreeNodeData",_xc.a.U,_xc.a.X,2,null,null,null]]]);var t=_xc.a.b.childNodes[4].cloneNode(!0);var n=new _n.C(t.children[0],_j.b.Instance.a(_n.d));return new _j.a(t,[n]).c(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_xc.a.a);var t="FilesModernNavigationPaneView._tid3._tid5";new _j.d(t,function(){_xc.a.a[t]===undefined&&(_xc.a.a[t]=[[[-1,0,["GroupsNavigationViewModel"],[_xc.a.t],null,"DataContext",null,_xc.a.h,1,null,null,null]]]);var i=_xc.a.b.childNodes[5].cloneNode(!0);var n=new _j.c(i.children[0]);n.y("CondensedGroupsNavigationView");return new _j.a(i,[n]).c(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_xc.a.a);var n="FilesModernNavigationPaneView._tid3";new _j.d(n,function(){_xc.a.a[n]===undefined&&(_xc.a.a[n]=[[[-1,5,["MailNavigationViewModel","IsExpanded"],[_xc.a.c,_xc.a.P],null,"hidden",null,null,0,_xc.a.k(),null,null]],[[-1,0,["GroupsNavigationViewModel"],[_xc.a.t],null,"IsHidden",null,_xc.a.n,1,_xc.a.v(),null,!0]]]);var r=_xc.a.b.childNodes[6].cloneNode(!0);var i=new _j.c(r.children[1]);i.y("FilesModernNavigationPaneView._tid3._tid5");var t=new _j.c(_j.a.a(r,[0,0]));t.y("FilesModernNavigationPaneView._tid3._tid4");return new _j.a(r,[t,i]).l({FoldersControl:t,GroupsControl:i})},"",_y.s,_n.H,function(n){return new _n.H(n)},!1,!0,!1,0,_xc.a.a);var r="FilesModernNavigationPaneView";new _j.d(r,function(){_xc.a.a[r]===undefined&&(_xc.a.a[r]=[null,null,[[-1,0,["MailNavigationViewModel","Width"],[_xc.a.c,_xc.a.s],null,"LeftNavWidth",null,_xc.a.bb,1,null,null,0],[-1,2,["MailNavigationViewModel","WidthOfScrollRegion"],[_xc.a.c,_xc.a.S],null,_fce.c.b,null,null,1,null,null,null]]]);var t=_xc.a.b.childNodes[7].cloneNode(!0);var n=new _n.H(_j.a.a(t,[0,0,0]));n.eF(_fce.c.a,3);n.L(!0);n.y("FilesModernNavigationPaneView._tid3");n.z.parentNode.removeChild(n.z);var i=new _fce.c(_j.a.a(t,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.b(1);var u=new _fce.f(t.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));u.L(!0);i.a.a(n);return new _j.a(t,[u,i,n]).c(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_xc.a.a);var i="GroupFilesModuleView";new _j.d(i,function(){_xc.a.a[i]===undefined&&(_xc.a.a[i]=[null,[[-1,2,["MailModernNavigationPane","MailNavigationViewModel","Width"],[_xc.a.j,_xc.a.c,_xc.a.s],_xc.a.T,_fce.c.b,null,null,2,null,null,null],[-1,2,["MailModernNavigationPane","MailNavigationViewModel","MinWidth"],[_xc.a.j,_xc.a.c,_xc.a.R],null,_fce.c.d,null,null,1,null,null,null],[-1,2,["MailModernNavigationPane","MailNavigationViewModel","MaxWidth"],[_xc.a.j,_xc.a.c,_xc.a.Q],null,_fce.c.e,null,null,1,null,null,null]],[[-1,4,null,null,null,"HeaderRegionPriority",null,_xc.a.bd,0,null,null,0,351],[-1,4,null,null,null,"ContentRegionPriority",null,_xc.a.bc,0,null,null,0,352],[-1,0,["MailModernNavigationPane"],[_xc.a.j],null,"DataContext",null,_xc.a.h,1,null,null,null]],[[-1,0,["GroupManagementHeaderViewModel"],[_xc.a.bg],null,"DataContext",null,_xc.a.h,1,null,null,null],[0,2,["Height"],[_xc.a.bf],null,_fce.c.b,null,null,1,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_xc.a.H,0,null,null,0,2],[-1,0,["FilesContentConductor"],[_xc.a.be],null,"DataContext",null,_xc.a.h,1,null,null,null],[0,0,["ActiveNavigationStack"],[_xc.a.p],null,"ActiveNavigationStack",null,_xc.a.ba,1,null,null,null],[0,0,["ActiveNavigationStack"],[_xc.a.p],null,"ActiveItems",null,_xc.a.Z,1,null,null,null]]]);var r=_xc.a.b.childNodes[8].cloneNode(!0);var u=new _n.g(_j.a.a(r,[0,2]),_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));u.eF(_fce.c.a,4);u.E(39);u.z.parentNode.removeChild(u.z);var n=new _j.c(_j.a.a(r,[0,1]));n.eF(_fce.c.a,0);n.y("UnifiedGroupHeaderView");var e=new _b.m(_j.b.Instance.a(_b.j),_j.b.Instance.a(_j.o));e.U(_j.f.b(353,null,null,null,"Priority",null,_xc.a.I,0,null,null,0));e.i(!0);n.C([e]);n.z.parentNode.removeChild(n.z);var o=new _n.q(_j.a.a(r,[0,0,0]),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.f),_j.b.Instance.a(_a.x),_j.b.Instance.a(_g.h));o.a(!1);o.c(!0);var t=new _j.i(_j.a.a(r,[0,0]));t.eF(_fce.c.a,3);t.eF(_fce.c.c,!0);t.z.parentNode.removeChild(t.z);var f=new _fce.c(r.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));f.b(2);f.a.a(t);f.a.a(n);f.a.a(u);return new _j.a(r,[f,t,o,n,u])},"",_xc.j,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_xc.a.a)};_xc.i.registerClass("_xc.i",_h.bY);ModernGroupsCoreComponent.registerClass("ModernGroupsCoreComponent",null,_a.jv,_j.ce);_xc.u.registerClass("_xc.u",_y.jW);_xc.d.registerClass("_xc.d",_lv.h,_xs.z,_y.ki,_y.bR,_j.bs,Sys.IDisposable,_y.kX,_y.B,_bc.w,_a.kh,_y.eZ,_xc.x);_xc.c.registerClass("_xc.c",_lv.d);_xc.k.registerClass("_xc.k",_a.bu);_xc.j.registerClass("_xc.j",_mgn.bA,_y.eM);_xc.w.registerClass("_xc.w",_db.b);_xc.h.registerClass("_xc.h",_lm.b,_rps.j,_h.D,_h.G,_h.fz,_j.bs,Sys.IDisposable);_xc.o.registerClass("_xc.o",_xc.h);_xc.m.registerClass("_xc.m",_lm.d,IGroupConversationTableQuery);_xc.p.registerClass("_xc.p",_h.x);_xc.f.registerClass("_xc.f",_h.dr.$$(_gg.xN,_g.dA),_h.dy);_xc.r.registerClass("_xc.r",null,_h.cY);_xc.i.a="ModernGroup";_xc.i.b="SearchModernGroup";ModernGroupsCoreComponent.$$cctor();_xc.d.b=new _h.p("ConversationLastDeliveryTime","Descending");_xc.d.d=new _a.D("GroupListView");_xc.c.a.a=null;_xc.j.a=_a.a.K;_xc.g.b=new _a.D("Missed");_xc.g.c=new _a.D("UnseenTimeout");_xc.g.a=new _h.p("ConversationLastDeliveryTime","Descending");_xc.b.h=new _a.D("Comp");_xc.b.k=new _a.D("Reply");_xc.b.i=new _a.D("PGI");_xc.b.j=new _a.D("PUGI");_xc.b.C=new _a.D("SyncD");_xc.b.A=new _a.D("USave");_xc.b.m=new _a.D("ASave");_xc.b.x=new _a.D("Att");_xc.b.g=new _j.q;_xc.b.y="NotificationTimeout";_xc.b.z="Refresh";_xc.b.d="Group_Conversation_E2E_Post";_xc.b.n="inv";_xc.b.r="bl";_xc.b.v="sl";_xc.b.o="ms";_xc.b.p="ac";_xc.b.q="as";_xc.b.s="ec";_xc.b.t="ir";_xc.b.u="sdp";_xc.b.w="sdcorrid";_xc.e.d=new RegExp("<span(?:.*?)imagepromote=(?:.*?)<\\/span>","gi");_xc.f.a="QuickComposeItemPart";_xc.a.b=_xc.a.w();_xc.a.e=null;_xc.a.f=null;_xc.a.a={};_xc.a.$$cctor();
window.scriptsLoaded['microsoft.owa.moderngroupscore.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.moderngroupscore.js'] = (new Date()).getTime();
