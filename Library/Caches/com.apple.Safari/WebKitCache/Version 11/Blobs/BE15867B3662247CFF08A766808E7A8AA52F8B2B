window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.attachments.filepicker.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_am");_am.P=function(){};_am.P.prototype={b:function(n){return new _am.C(n,"groupId_"+n)},a:function(){return!1}};_am.z=function(){};_am.z.registerInterface("_am.z");_am.I=function(){};_am.I.registerInterface("_am.I");_am.C=function(n,t){_am.C.initializeBase(this);this.e=n;this.d=t};_am.C.prototype={e:null,d:null,a:function(){return this.d},c:function(){return!1},b:function(n){return n}};_am.K=function(n,t,i,r,u){_am.K.initializeBase(this,[n,null,null,r]);var f=this;this.y(new _j.g(function(){u(t,i)},_a.a.c))};_am.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.cy=Function.createDelegate(this,this.iZ);this.fg=Function.createDelegate(this,this.jc);this.ff=Function.createDelegate(this,this.iY);this.gO=Function.createDelegate(this,this.iV);this.gP=Function.createDelegate(this,this.iW);this.gQ=Function.createDelegate(this,this.jf);_am.d.initializeBase(this,[n,t,i,r,u,f,e,o,s,l,a]);this.fh=h;this.cK();c&&this.gN(c.Response)};_am.d.c=function(){return"AttachmentNotification"+(_a.d.a().h()+_ff.o.a(0,1e3)).toString()};_am.d.prototype={fh:null,dK:null,E:null,G:null,u:!1,fl:!1,dL:null,bM:null,dJ:!1,fX:function(){return this.cs()?!0:_at.a.prototype.fX.call(this)},cd:function(){return!this.bO.a().F()||!_j.h.a(this.bm.c())||_y.F.isInstanceOfType(this.bl.c)||!this.iX()?!1:_at.a.prototype.cd.call(this)},iX:function(){return!!this.d()&&!!this.d().a&&_at.k.c(this.d().b)},d:function(){if(!this.dL){var u=_am.c.a;if(u)for(var f=u,e=f.length,r=0;r<e;++r){var t=f[r];if(_g.q.toString(t.bD.Type)===_g.q.toString(0)){var i=new _a.P(t.bD.EndPointUrl);var n;this.dL=(n=new _am.d.b,n.e=t.bD.Id,n.c=i,n.a=String.format("{0}://{1}",i.b,i.a),n.d=t.bD.DocumentLibrary,n.b=_g.q.toString(0),n);break}}}return this.dL},cs:function(){return _dg.b.isInstanceOfType(this.bl)||_dg.d.isInstanceOfType(this.bl)&&_y.F.isInstanceOfType(this.bl.c)&&!this.bl.c.f()},fO:function(){if(this.cs()){var n;return _dg.b.isInstanceOfType(this.bl)&&!_j.h.a(n=this.bl.bD.AttachmentPreviewUrl)?n:this.bn()?this.by+"&isImagePreview=True":null}else return _at.a.prototype.fO.call(this)},hV:function(){var n;return _dg.b.isInstanceOfType(this.bl)&&!_j.h.a(n=this.bF)?n:null},fQ:function(){return this.cs()?null:_at.a.prototype.fQ.call(this)},cE:function(){return this.cs()?null:_at.a.prototype.cE.call(this)},V:function(){return this.cs()?null:_at.a.prototype.V.call(this)},o:function(){this.dK||(this.dK=_am.d.c());return this.dK},gM:function(){return"AttachmentProviderItemViewModel"},cM:function(){return _dg.b.isInstanceOfType(this.bl)&&_j.h.a(_a.bd.a(this.bl.bD.Name))&&this.bl.bD.ContentType==="application/onenote"?!1:_dg.b.isInstanceOfType(this.bl)||_at.a.prototype.cM.call(this)},ei:function(n){if(_dg.b.isInstanceOfType(this.bl)||_dg.d.isInstanceOfType(this.bl)&&_y.F.isInstanceOfType(this.bl.c))if(_dg.d.isInstanceOfType(this.bl)){_j.e.a(_am.d.a,"Uploading attachment from attachment data provider.");this.iS(this.bl.c)}else if(_y.F.isInstanceOfType(this.bl.c)){_j.e.a(_am.d.a,"Sharing attachment from attachment data provider.");this.gR(this.bl.c)}else{_j.e.a(_am.d.a,"Uploading local file to attachment data provider so it can be shared.");_at.a.prototype.ei.call(this,n)}else{_j.e.c(_am.d.a,"Unsupported upload type.");n(null)}},eg:function(){var n=0;if(_dg.b.isInstanceOfType(this.bl)){var i,t;(t=_db.m.e(this.bl,i={val:n}),n=i.val,t)||(n=this.gb()?10:this.bp.b?3:6)}else n=_at.a.prototype.eg.call(this);return n},cK:function(){if(!this.dJ){var t=!!this.bn()&&!!this.bn().bD.AttachLongPathName;var n=null;if(t){this.kT(_db.m.l(this.bn(),this.fh));n=this.bO.g(this.bn().bD.ProviderType)}if(!this.jg(n)){if(this.bW&&this.cM()&&this.bl.bD.AttachmentId&&t&&!this.bn().k()){this.cH(this.bW.b(this.bn().bD.ProviderType,this.bl.bD.AttachmentId.Id,this.bn().bD.AttachLongPathName,this.bI,this.cF()));this.fy()&&this.cH(this.by+"&isDocumentPreview=True");return}_at.a.prototype.cK.call(this)}}},fC:function(n,t){_at.a.prototype.fC.call(this,n,t);if(t==="AttachLongPathName"){this.cK();this.eE("HoverText")}else t==="Name"&&this.eE("HoverText")},fD:function(){if(!this.G||this.fl||this.cR)_at.a.prototype.fD.call(this);else{this.gu(!0);this.bM&&_at.e.m(this.bM,!1);this.hJ(null)}},ex:function(n){this.E=n;this.je()},gr:function(n){_j.s.c(!!this.bo&&!this.bo.a().b().Enabled,"upsell with blob is only enabled for Office365 users as of now.");this.G=n;this.bG||this.ch(10);this.cc===1||this.bG>0?this.gS():this.iU()},je:function(){this.fe();var n=null;if(this.bm.c()){if(this.cV&&this.cV.a(this.bm.c(),"AttachmentGetOneDriveUploadFolderProps")){n=_at.m.d(this.bm.c());if(!n){var r=this;var u=function(n){var t=n.h;_j.e.a(_am.d.a,String.format("Getting upload folder id succeeded. Id: {0}",t));r.fj(t)};var t=this;var i=function(n){_j.e.a(_am.d.a,"Getting upload folder id failed");t.fj(null)};this.jd(this.bm.c(),u,i);return}}}else n=_at.m.d("PersonalOneDriveKey");this.fj(n)},fj:function(n){if(_j.h.a(this.E))_j.e.c(_am.d.a,"Either blob or base64 content needs to be provided for upload.");else{_j.e.a(_am.d.a,"Submitting action CreateReferenceAttachmentFromLocalFileAction with folderID: "+n);this.u=!1;var t=new _ao.l(this.bm.b(),this.bl.bD.Name,this.E,n,this.o(),this.bm.c(),this.bH(),this.bQ?this.bQ.b():this.E.length,this.cc,this.bG,this.cP());t.b(this.fo);t.c(this.fd);this.bJ.a(t)}},gI:function(){this.fe();this.u=!1;this.eK.a()},hL:function(){if(!_j.h.a(this.cp)){this.iR();this.cj(this.cL,this.cp,!1)}},iQ:function(n){if(n.Item){var u=!1;var r=this.bl.c;r&&_y.F.isInstanceOfType(r)&&(u=r.m());var i=n.Item;var t;var f=(t=new _db.d,t.s(i.Name),t.t(i.Size),t.D(""),t.p(i.AttachmentProviderId),t.q(_g.q.toString(i.ProviderType)),t.u(i.Location),t.r(i.Id),t.w(i.ParentId),t.x(i.ProviderEndpointUrl),t.C(i.Thumbnail?i.Thumbnail.Url:null),t.B(i.Preview?i.Preview.Url:null),t.v(this.u),t.A(u),t.z(!1),t);this.bl.c=f}},eZ:function(){this.gv(!this.bw&&this.bq.t()&&_dg.b.isInstanceOfType(this.bl)&&!this.bl.bD.AttachmentId&&!this.bl.c)},jg:function(n){if(this.bo&&this.bo.a().fd().Enabled&&this.bn()&&!this.fy()){if(this.cM()&&!this.by&&this.bn().bD.AttachmentId&&!this.bn().k()&&n){this.dJ=!0;n.L(this.bn(),this.bI,this.gz,this.gQ)}return!0}return!1},jf:function(n,t,i){this.dJ=!1;this.cH(n);if(this.cr()&&this.bn()){this.bn().B(i);this.bn().C(t);this.dE()}},iS:function(n){this.fe();this.u=!0;_j.e.a(_am.d.a,"Submitting action CreateAttachmentFromAttachmentDataProviderAction.");this.bl.a()&&(this.bZ=this.bm.A(this.bl.bD.Name,0,0));var t=new _ao.k(this.bm.b(),n.c(),n.g(),n.e(),this.o(),this.bm.c(),n.i(),n.h(),this.bH(),this.cP(),this.bl.a());t.c(this.fd);this.bJ.a(t)},gR:function(n){this.u=!1;var t=new _at.T(this.bm.b(),n.c(),n.g(),n.e(),this.bm.c(),n.i(),n.h(),this.bH(),n.j(),n.o(),n.l(),this.cP(),this.bl.bD.ContentType);t.b(this.gP);t.c(this.gO);this.bJ.a(t)},iW:function(n){var i=n.l;var t=this.gN(i);t&&this.cj(1,t,!0);this.co(n)},iV:function(n){this.dX(n);this.co(null)},jd:function(n,t,i){var r=new _at.m(n);r.b(t);r.c(i);this.bJ.a(r)},iY:function(n){var t=Math.round(n.loaded*100/n.total);this.ij(t)},jc:function(n,t){this.hK(null);if(t&&!this.bT){this.fl=!0;this.iT(n)}},iZ:function(n){this.cj(1,n.message,!0);this.co(null)},gS:function(){_j.e.a(_am.d.a,"Submitting XHR file upload request");this.u=!1;this.cc===1?_at.e.k(this.d().a,this.bm.g(),this.bl.bD.Name,this.G,this.ff,this.fg,this.cy,!1):_at.e.l(this.bM,this.G,this.bG,10485760,this.bQ.b(),this.ff,this.fg,this.cy,!1)},iU:function(){var n=this;var t=function(t){n.bM=t;n.gS()};_at.e.d(this.d().a,this.bm.g(),this.bl.bD.Name,t,this.cy,!1)},iT:function(n){var r=_j.h.a(this.bm.g())?"":"/"+this.bm.g();var t;var i=(t=new _db.d,t.s(n.name),t.t(n.size),t.D(""),t.p(this.d().e),t.q(this.d().b),t.u(_j.h.c("{0}{1}{2}/{3}",this.d().c.toString(),this.d().d,r,n.name)),t.r(n.id),t.w(n.parentReference.id),t.x(this.d().c.toString()),t.C(null),t.B(null),t.v(!1),t.A(!0),t.z(!1),t);this.gR(i)}};_am.d.b=function(){};_am.d.b.prototype={c:null,d:null,a:null,e:null,b:null};_am.D=function(n,t,i,r,u){this.e=n;this.d=t;this.g=i;this.f=r;this.c=u};_am.D.prototype={e:null,d:null,g:null,f:null,c:null,h:0,a:function(n,t,i,r,u,f,e,o){!this.c.e.h()&&++this.h<=3&&this.g.c();var s=_at.v.a(this.f,this.c,u);return new _am.d(n,t,i,r,u,f,e,o,this.e,this.d,null,s,this.c)},b:function(n,t,i,r,u,f,e,o,s){var h=_at.v.a(this.f,this.c,u);return new _am.d(n,t,i,r,u,e,o,s,this.e,this.d,f,h,this.c)}};_am.i=function(n,t,i,r,u){this.d=Function.createDelegate(this,this.i);this.e=Function.createDelegate(this,this.f);_am.i.initializeBase(this);this.a=n;this.c=i;this.b=u;if(r.a()==="TouchNarrow")this.fh(this.g());else{var f=_y.g.a(_ufp.A.b,this.fg);this.fb(_y.k.a(this,[f],null))}this.a.e.j.e(this.e);this.a.e.apcl("BreadCrumbs",this.d)};_am.i.prototype={a:null,c:null,b:null,n:function(){return 1},h:function(){if(!this.a.e.j)return null;for(var t=this.a.e.j,r=t.x.length,i=new _j.l,n=1;n<=2&&r-n>=0;n++)i.t(0,t.x[t.x.length-n]);return i},fA:function(){this.a.C(null);_y.lB.prototype.fA.call(this)},f:function(n,t){this.eE("BreadCrumbs")},i:function(n,t){this.f(null,null)},g:function(){var n=this.b.b();n.d(_ufp.A.BY);if(this.c.a()){n.a(this.b.a(_y.b.b(),_y.b.b(),this.fg,""));n.e(3)}else n.a(this.b.a(_y.b.a(),_y.b.a(),this.fg,""));return n}};_am.g=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){this.cz=Function.createDelegate(this,this.dr);this.bP=Function.createDelegate(this,this.ds);_am.g.initializeBase(this,[n,t,i,r,null,null,f,e,o,s,h,c,l,a,v,y,p,b,w]);this.bR=u;this.e.G(this.bP);this.bU=c;this.W=k};_am.g.prototype={bR:null,bo:null,bn:null,bp:null,cA:!1,bU:null,W:null,eC:function(){return this.cA},bS:function(){this.bo||(this.bo=new _j.g(this.cz,_a.a.c));return this.bo},bq:function(){return null},cr:function(){return null},l:function(){if(!this.bn){var n=_y.g.a(_ufp.A.b,this.bS());this.bn=_y.k.a(this,[n],null)}return this.bn},bQ:function(){return null},t:function(){this.bp||(this.bp=this.dq());return this.bp},n:function(){return 1},dw:function(){this.cB()},z:function(){_am.b.prototype.z.call(this);this.cB();this.e.bq(null);this.e.bt(null)},bz:function(){return!1},K:function(){_am.b.prototype.K.call(this);var n=!!this.e.d||this.q||this.N||this.s;this.Y&&n&&this.Y.e(this.bR.e())},dr:function(){this.E.a()},cB:function(){this.di(!1);this.dk(!1);this.dj(!1);this.C(null)},ds:function(){this.dp();this.e.bO(this.bP)},dq:function(){var n=this.W.b();n.d(_ufp.A.g);if(this.bU.a()){n.a(this.W.a(_y.b.b(),_y.b.b(),this.bS(),""));n.e(3)}else n.a(this.W.a(_y.b.a(),_y.b.a(),this.bS(),""));return n}};_am.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){this.cE=Function.createDelegate(this,this.dC);this.cF=Function.createDelegate(this,this.dW);this.cC=Function.createDelegate(this,this.dt);this.cP=Function.createDelegate(this,this.fg);this.cO=Function.createDelegate(this,this.dm);this.cM=Function.createDelegate(this,this.fe);this.cQ=Function.createDelegate(this,this.dn);this.cN=Function.createDelegate(this,this.dl);this.cL=Function.createDelegate(this,this.fa);this.cH=Function.createDelegate(this,this.ea);this.cI=Function.createDelegate(this,this.ee);this.cD=Function.createDelegate(this,this.z);this.bZ=Function.createDelegate(this,this.el);this.ca=Function.createDelegate(this,this.em);this.bY=Function.createDelegate(this,this.ej);this.bX=Function.createDelegate(this,this.eh);this.cJ=Function.createDelegate(this,this.ei);this.cG=Function.createDelegate(this,this.dX);this.br=Function.createDelegate(this,this.ek);this.bW=Function.createDelegate(this,this.eg);this.cc=Function.createDelegate(this,this.fl);this.cb=Function.createDelegate(this,this.fj);this.bV=Function.createDelegate(this,this.dz);this.cd=Function.createDelegate(this,this.fm);this.cK=Function.createDelegate(this,this.eo);_am.b.initializeBase(this);this.e=n;this.u=t;this.u.g=this.cK;this.e.apcl("SelectedDataProvider",this.cd);this.e.apcl("AttachmentDataProviders",this.bV);this.e.apcl("IsOneDriveProGroupsView",this.cb);this.e.apcl("ItemsTable",this.cc);this.e.apcl("BreadCrumbsSelectedItem",this.bW);this.e.Z||this.e.G(this.br);if(i){var d=this;i.a(function(n){d.eA(n)})}this.cg=r;this.bD=u;this.bw=f;this.df=e;this.bN=o;this.bA=!!s&&s.a().C().Enabled;this.cl=!!s&&s.a().bm().Enabled;this.cp=!!s&&s.a().c().Enabled;this.bb=!!s&&s.a().b().Enabled;this.cn=!!s&&s.a().ht().Enabled;this.bB=!!this.bD&&!!s&&s.a().gk().Enabled&&!!v&&!!v.g()&&!!v.g().WacEditableFileTypes&&v.g().WacEditableFileTypes.length>0&&!this.e.P&&!this.e.t;this.bC=!!this.bw&&!!s&&s.a().cP().Enabled&&!!v&&!!v.g()&&v.g().ThirdPartyAttachmentsEnabled;this.be=h;this.A=s;this.ci=c;this.v=l;this.O=a;this.j=v;this.cf=y;this.cv=k;this.Q=p.a();this.P=w;this.cX=b;this.en(e)};_am.b.a=function(n){return Math.floor(n/1024).toString()};_am.b.b=function(n){return String.format('<img src="{0}" alt="{1}" style="max-width:99.9%" data-fromBingImageSearch="true"/>',n.sourceUrl,n.caption)};_am.b.prototype={cg:null,bD:null,bw:null,be:null,cp:!1,cn:!1,bB:!1,bC:!1,v:null,O:null,A:null,cv:null,e:null,u:null,bb:!1,cl:!1,i:null,Y:null,X:null,D:null,ck:null,M:null,bk:null,bj:null,E:null,U:null,f:null,bd:!1,bg:null,bh:null,bJ:null,bF:null,bA:!1,S:null,cw:null,bL:null,bt:null,g:null,J:null,G:null,bu:null,bG:null,bv:null,T:null,df:null,bN:null,s:!1,B:!1,bO:!1,bE:0,bK:null,bH:null,N:!1,cq:!1,ba:!1,co:!1,cu:null,bi:null,bM:null,bI:null,q:!1,bf:null,ci:null,L:null,ct:!1,r:null,p:null,o:null,j:null,cf:null,Q:null,ch:!1,P:null,bl:!1,h:0,cX:null,bc:!1,w:null,er:function(n){if(this.h!==n){this.h=n;this.cy();this.eN(["ShouldHideSecondaryDataProviders","ShouldShowBingImageSearchButton","LeftButtonText","HideNewOfficeDocumentButton","ShouldHideWopiProviders"])}return n},et:function(n){if(this.p!==n){this.p=n;this.f.cr(this.p);this.eY();this.bF.a()}return n},dL:function(){return this.h?_ufp.A.g:_ufp.A.x},C:function(n){if(this.e.d===n)return n;this.ef();this.e.S(n);this.K();this.eE("SelectedDataProvider");return n},cZ:function(){return!!this.e.d&&!!this.e.d.a&&this.e.d.a.bD.IsThirdPartyProvider},dM:function(){return this.h===1||!this.e.Z},dP:function(){return this.v.c()?this.v.a():this.O.a()==="TouchNarrow"?!0:this.v.e()||this.v.a()},dO:function(){return this.O.a()==="TouchNarrow"?!1:!this.v.e()&&!this.v.a()},ez:function(n){if(this.U!==n){this.U=n;this.eE("SelectAttachmentDataProviderItemCommand")}return n},ce:null,eD:function(n){if(this.bI!==n){this.bI=n;this.eE("ShowCurrentGroupDocumentsCommand")}return n},ex:function(n){if(this.bg!==n){this.bg=n;this.eE("OpenLocalComputerFilePickerCommand")}return n},ey:function(n){if(this.bh!==n){this.bh=n;this.eE("OpenLocalComputerImageFilePickerCommand")}return n},eK:function(n){if(this.bJ!==n){this.bJ=n;this.eE("ShowFilePickerCommand")}return n},ew:function(n){if(this.bF!==n){this.bF=n;this.eE("OnLocalFilesSelectedCommand")}return n},db:function(){return this.bA&&this.h===1},eB:function(n){if(this.bH!==n){this.bH=n;this.eE("ShowBingImageSearchCommand")}return n},eM:function(n){if(this.bK!==n){this.bK=n;this.eE("ShowGroupsCommand")}return n},eR:function(n){if(this.bM!==n){this.bM=n;this.eE("ShowRecentDocumentsCommand")}return n},eO:function(n){if(this.bL!==n){this.bL=n;this.eE("ShowNewOfficeDocumentPanelCommand")}return n},eq:function(n){if(this.bt!==n){this.bt=n;this.eE("AddAnAccountCommand")}return n},es:function(n){if(this.f!==n){this.f=n;this.eS("AttachmentWellViewModel","ShowGroupsAsDataProviderEnabled","HideGroupsButton")}return n},dJ:function(){return!this.bB||this.h===1||!this.f||!this.f.d()||this.f.d().i()!==1},dN:function(){return!this.bC||this.h===1},dK:function(){return this.O.b()},eu:function(n){(n||this.B)&&(this.bO=!0);if(this.B!==n){this.B=n;n?this.e.cN():this.e.dc();this.eE("IsBingImageSearchSelected")}return n},dj:function(n){if(this.s!==n){this.s=n;this.eE("IsGroupsSelected")}return n},da:function(){return this.s&&!this.r},dI:function(){return!this.cp||!this.R()||!this.H()},d:function(n){this.bc=n;return n},dk:function(n){if(this.N!==n){this.N=n;this.eE("IsRecentDocumentsSelected")}return n},di:function(n){if(this.q!==n){this.q=n;this.eE("IsCurrentGroupSelected")}return n},eA:function(n){if(this.i===n)return n;this.i=n;this.eE("SelectedModernGroupProvider");return n},R:function(){return this.f?!this.f.c()||!!this.be&&this.be.a(this.f.c(),"AttachmentShowGroups"):!0},bx:function(){return 1},x:function(){return this.cG},bT:function(){return this.Y},bs:function(n){this.Y=n;return n},y:function(){return this.X},m:function(n){this.X=n;return n},by:function(){return!0},bz:function(){return!0},H:function(){if(this.bf)return this.bf;var t=this.e.e;if(!t)return null;for(var i=this.dU(),n=0;n<t.x.length;n++)if(t.x[n].a.a()===i){this.bf=t.x[n];return this.bf}return null},cj:function(){return!!this.e.d&&Object.getType(this.e.d)===_am.q},ev:function(n){if(this.S!==n){this.S=n;this.eE("OnInsertButtonClickCommand")}return n},a:function(n,t,i,r,u,f,e,o){_a.b.a(n,"attachmentWellViewModel");_a.b.a(r,"onPopupViewModelRequested");this.w=null;_am.a.a=o===1;this.e.bP(o);if(this.e.ba&&n&&this.cl){n.h(!1,null,null);_j.e.a(_a.a.c,"Suppressing file picker as there are no providers to display.");return}this.es(n);this.ba=e;this.co=f;if(this.ct!==this.R()||this.h!==o){this.bd=!1;this.V(!1,!1,!1,!1);_at.z.b()}var h=o!==this.h;this.er(o);this.o=r;if(this.v.b()&&!this.v.m()&&!this.O.b()){var s=this.O;this.o=s.G||(s.G=Function.createDelegate(s,s.C));_a.b.a(this.o,"onPopupViewModelRequested_owaShellPopUpAsPanel")}this.ct=this.R();this.T=t;this.dY(i||e||f);this.g.J=this.e.P=!!n.c();this.o&&this.o(this);this.L=u;this.e.A(u);this.e.e&&this.e.e.x.length?h&&this.e.cL():this.e.c();this.f.bd()||this.g.bo(this.f.c(),this.e,this.be);this.P.J(u);this.i&&this.i.a()&&this.f.ci(this.i.a().bD.DisplayName);this.A&&this.A.a().du().Enabled&&_at.k.b(0,null,null,!1,null);this.bO=!1;this.bE=0},c:function(){if(!this.cq){this.cq=!0;this.e.cI()}},b:function(n,t){var i;i=this.P.T(n);i&&i.d(t[i.O()],t,this.cJ,this.e.bz)},eG:function(){this.e.rpcl("SelectedDataProvider",this.cd);this.e.rpcl("AttachmentDataProviders",this.bV);this.e.rpcl("IsOneDriveProGroupsView",this.cb);this.e.rpcl("ItemsTable",this.cc);this.e.rpcl("BreadCrumbsSelectedItem",this.bW);this.e.bO(this.br);var i;_a.h.a(i={val:this.S}),this.S=i.val;var t;_a.h.a(t={val:this.J}),this.J=t.val;var n;_a.h.a(n={val:this.G}),this.G=n.val;this.e.bE();if(this.g){this.g.bf(this.bX);this.g.dispose();this.g=null}this.e&&this.e.cg(this.bY);_a.gb.prototype.eG.call(this)},ef:function(){if(this.e.d){this.e.d.bp(this.ca);this.e.d.Z(this.bZ)}},K:function(){if(this.e.d){this.V(!1,!1,!1,!1);this.r=null;this.eE("IsMailboxDataProvider");this.u.d();this.e.d.R(this.ca);this.e.d.G(this.bZ)}this.cy()},dw:function(){},du:function(){},dx:function(){if(this.T){this.T.l=this.dD();_a.c.a(this.T);this.T=null}},dv:function(){},z:function(){if(this.X){this.cW();this.e.bE();this.L=null;this.cs()&&this.u.d();this.ed();this.X()}},dp:function(){if(!this.dd()){this.ci.a(_a.u,new _a.u([this.e.bI()],0,null,0,!1,null,null,this.Q.Q(),this.L,null));return!1}return!0},ed:function(){if(this.bA&&(this.bO||this.B)){var n=new _a.l;n.a("N",this.bE);_a.c.c(_a.a.c,"AttachmentsFilePickerBingImageSearch",n.toString(),0)}},dd:function(){var n=this.e.e;return!!n&&n.x.length>0},dU:function(){return this.bb?this.e.t?5:1:0},dY:function(n){if(this.bd)this.e.g&&this.e.g.bm();else{this.E=new _j.g(this.cD,_a.a.c);this.cw=new _j.g(this.cI,_a.a.c);var s=this;this.D=new _j.g(function(){s.cT(!0)},_a.a.c);this.ck=new _j.g(this.cH,_a.a.c);var h=this;this.M=new _j.g(function(){h.cS(!0)},_a.a.c);this.bk=new _j.g(this.cL,_a.a.c);var o=this;this.bj=new _j.g(function(){o.cS(!1)},_a.a.c);var u=this;this.ce=new _j.g(function(){u.ep(u.o)},_a.a.c);var f=this;this.ez(new _j.g(function(){f.dg(f.o)},_a.a.c));var e=this;this.eK(new _j.g(function(){e.ff(e.o)},_a.a.c));var r=this;this.ew(new _j.g(function(){r.g.c=_a.c.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles",!1,null);r.bm(!0,r.o)},_a.a.c));var t=this,i=this;this.ev(new _j.w(function(){if(t.B)t.dZ();else{t.g.c=_a.c.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile",!1,null);t.bm(!1,t.o)}},_a.a.c,this.e,"SelectedAttachmentsChanged",function(){return i.B?i.eb():i.cU()}));this.eD(new _j.g(this.cN,_a.a.c));this.eR(new _j.g(this.cQ,_a.a.c));this.eB(new _j.g(this.cM,_a.a.c));this.eM(new _j.g(this.cO,_a.a.c));this.eO(new _j.g(this.cP,_a.a.c));this.eq(new _j.g(this.cC,_a.a.c));this.R()||this.bb?this.dh():this.eZ();this.g=this.cg.e();this.g.Q(this.bX);this.e.Y=this.P;this.e.n(this.bY);this.bd=!0}this.ch=n;this.bj.c(!n);this.bk.c(!n);if(this.q&&this.bz()){this.q=!1;this.dl()}},cW:function(){this.e&&this.e.f&&this.e.f.g()},en:function(n){n&&!_g.k.b&&n.a("AttachmentOperationCorrelationIdNotification",_a.a.c,"AttachmentsFilePickerPanelViewModel",this.cF,0)},dW:function(n){var t=n;t?this.bN&&this.bN.d(t.CorrelationId,t.SharePointCallName,t.Exception):_j.e.c(_a.a.c,"HandleCorrelationIdNotification: The notification payload is null.")},eh:function(){this.bv&&this.bv()},dB:function(n,t,i){var r;return r=new _db.d,r.s(n.bD.Name),r.t(n.bD.Size),r.D(n.bD.MimeType),r.p(t),r.q(_g.q.toString(n.e())),r.u(n.bD.Location),r.r(n.bD.Id),r.w(n.bD.ParentId),r.x(n.bD.ProviderEndpointUrl),r.C(n.bD.Thumbnail?n.bD.Thumbnail.Url:null),r.B(n.bD.Preview?n.bD.Preview.Url:null),r.v(i),r.A(!n.bD.Size),r.z(n.a()===1),r},cS:function(n){var t=null;if(this.f){this.f.R(this.h===1);this.f.O(_a.c.b(_a.a.c,"AttachmentsFilePickerSelectDestination",!1,null));var r=this.e.d?this.e.d.a.bD.Id:this.H().a.bD.Id;t=[];if(this.e.f){var i=this;this.e.f.o(function(u){var f=i.dB(u,r,n);Array.add(t,f)})}this.eU(n);this.f.L(new _h.ce(t))}this.dF(t);this.dG();this.w=n?"AttachCloud":"ShareCloud";this.z();this.g.D();if(this.g.e){this.cm()?this.j.b().P(n?1:2):this.j.b().O(n?1:2);this.cx()}},dy:function(){if(this.f){this.f.R(this.h===1);var r=this.fb();if(this.e.f){var n=new _j.q;var i=this;this.e.f.o(function(t){var f=t;var u=null;if(i.de(f)){u=new _dg.b;u.D(_g.q.toString(f.e()));u.z(f.bD.Location)}else r||(u=new _dg.d);if(u){u.e(f.bD.Name);u.f(f.bD.Size);u.g(new _g.bh(f.bD.Id));var e=new _db.D(u,f.bD.ParentId);n.c(e)}});var t=_a.c.b(_a.a.c,"AttachmentAddFPRecentAttachmentsItemAttachments",!1,null);this.f.bz(n,t)}}this.w="Recent";this.z()},eU:function(n){this.f.u(n?this.h?"AttachmentsFilePickerAttachCloudImageFile":"AttachmentsFilePickerAttachCloudFile":"AttachmentsFilePickerShareCloudFile");this.f.G(this.dT());this.f.br(this.f.bf()?this.g.e:!1);this.f.bo(this.dc())},dc:function(){return this.e.d&&this.e.d.a?_g.q.toString(this.e.d.a.a()):this.s||this.q?"Group":this.N?"RecentFiles":"Unknown"},dT:function(){return this.e.d&&this.e.d.a?this.e.d.h():this.s||this.q?"Group files":"Unknown"},dG:function(){this.e.d&&this.e.d.a&&this.e.d.g(this.e.g.bF)},ek:function(){this.e.A(this.L);this.eE("ShouldHideSecondaryDataProviderCreators");this.e.bO(this.br)},dF:function(n){if(n){for(var u=_a.c.b(_a.a.c,"AttachmentsFilePickerFileSelection",!1,null),t=new _a.l,r=new Sys.StringBuilder,i=0;i<n.length;i++){var f=_a.bd.a(n[i].a());r.append(f);r.append(";")}t.a("C",n.length);t.b("T",r.toString());t.b("DP",this.dc());t.c("SRCH",!!this.u.e);u.l=t.toString();_a.c.a(u)}},ep:function(n){if(this.cU()){this.g.c=_a.c.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile",!1,null);this.bm(!1,this.o)}else this.dg(n)},eo:function(n){this.cW();var t=!_j.h.a(n);this.e.da(t);t?this.e.cO(n):this.e.cf()},cV:function(){this.cs()&&this.u.d()},cy:function(){this.u.A(this.cs())},em:function(n){this.cy()},el:function(n){this.cV()},fl:function(n,t){var i=this.e.h&&!this.e.h.a?this.e.h.b:null;this.u.C(i)},eg:function(n,t){this.e.Q&&this.cV()},dg:function(n){if(this.e.f&&this.e.f.x.length===1){var t=this.e.f.x[0];if(t.a()){if(t.a()===1||t.a()===2){var f=t.bD.Id;var i=null;if(t.a()===2){i=this.e.f.x[0].bD.PagingMetadata;this.r=i.GroupSmtpAddress}else if(this.r){if(i){if(!_gg.bS.isInstanceOfType(i))throw Error.invalidOperation(String.format("GroupsPagingMetadata is NULL. To expand subsequent folders within a Group, a non-null GroupsPagingMetadata is needed. GroupAddress: {0}, FolderName:{1}",this.r,t.bD.Name));}else i=new _gg.bS;i.GroupSmtpAddress=this.r;f=String.format("{0}_{1}",this.r,f)}else this.r=null;this.e.v();var u=this.e.d?this.e.d.c():null;var r=this.e.d;if(this.q||this.s){r=this.H();u=new _gg.bT;u.Type=3}this.u.d();this.e.z(new _ao.a(f,t.bD.Location,t.bD.Name,u,t.bD.ProviderEndpointUrl,r?r.a:null),!0,this.e.d?this.e.d.r():null,i)}}else{this.g.c=_a.c.b(_a.a.c,"AttachmentsFilePickerSelectCloudFile",!1,null);this.bm(!1,n)}}},ff:function(n){var t=this;this.f.h(this.h===1,this.h===1?this.bh:this.bg,function(i,r,u){t.g.c=_a.c.b(_a.a.c,"AttachmentsFilePickerSelectLocalFiles",!1,null);t.bu=i;t.bG=r;t.bv=u;t.bm(!0,n)})},dZ:function(){if(this.e){var i=Array.clone(this.e.r);this.e.bE();this.bE=i.length;this.w="BingImage";this.E.b&&this.E.a();for(var r=new Sys.StringBuilder,t=i,f=t.length,n=0;n<f;++n){var u=t[n];r.append(_am.b.b(u))}this.f.bV(r.toString())}},bm:function(n,t){if(!n&&this.cj()){this.dy();return}if(this.h===1){this.f.P(!1);n?this.D.a():this.M.a();return}if(this.bc&&!this.e.P&&n){this.D.a();return}if(this.e.t&&n){this.D.a();return}this.fh(n);this.f.P(!1);if(this.bl&&this.D.b&&!this.ba){this.g.P(this.ck);this.bl=!1}else{this.g.P(null);this.bl=!1}var r=n?this.D:this.M;var u=n?this.bk:this.bj;var i=this.dS(n,this.cm());if(r.b&&this.fd(i,n)){r.a();return}this.bj.c(!this.ch&&(this.e.d?this.e.d.n():!0));if(u.b&&this.fc(i)){u.a();return}this.g.bj(r);this.g.bn(u);this.g.bi(n);this.g.bh(this.cm());this.g.b=this.dA(n);this.g.bk(this.dH());this.g.bm(this.dV());this.g.bg(!!this.A&&this.A.a().iB().Enabled&&!i&&!this.cZ()&&!this.cj());this.g.M(!!i);this.f.P(!0);t(this.g)},dH:function(){return this.e.d?this.e.d.t:this.Q},fd:function(n,t){return(n===1||!this.dd()||!this.j.g().ReferenceAttachmentsEnabled||this.ec(t))&&this.j.g().ClassicAttachmentsEnabled},ec:function(n){return!n&&!!this.e.d&&this.e.d.T()===1},fc:function(n){return(n===2||!this.j.g().ClassicAttachmentsEnabled)&&this.j.g().ReferenceAttachmentsEnabled},eY:function(){if(this.p&&this.cn){for(var n=0;n<this.p.a();n++){var t=this.p.b(n);if(!_at.h.k(t.a()))return}this.bl=!0}},dA:function(n){return n?!!this.p&&this.p.a()>1:!!this.e.f&&this.e.f.x.length>1},dS:function(n,t){return this.cZ()?0:n?this.j.b().bD.AttachOrShareLocalFiles:t?this.j.b().bD.AttachOrShareGroupsFiles:this.j.b().bD.AttachOrShareCloudFiles},fh:function(n){this.g.a.r();if(n&&_a.o.a().Q)this.cY(!0,this.D,this.p.a());else if(this.e.f){this.dE(this.M);this.M.b&&this.cY(!1,this.M,this.e.f.x.length)}if(n&&this.f&&this.f.bd()){this.bk.c(!1);this.g.a.a(10216,this.Z().w())}this.co&&this.g.a.a(10315);this.ba&&this.g.a.a(10204,this.Z().w())},dQ:function(n){var i=0;if(n)for(var t=0;t<this.p.a();t++)i+=this.p.b(t).b();else if(this.e.f){var r=this;this.e.f.o(function(n){var t=n;i+=t.bD.Size})}return i},dR:function(){var n=0;var i=new _j.q;var t=this;this.e.f.o(function(i){var r=i;t.de(r)||(n+=r.bD.Size)});return n},de:function(n){return!_j.h.a(n.bD.Location)},dE:function(n){if(this.e.bj){n.c(!1);this.g.a.a(10205,this.Z().w())}else if(this.e.bC){n.c(!1);this.g.a.U(this.Z().E())}else n.c(!0)},cY:function(n,t,i){if(this.A&&this.A.a().eM().Enabled&&this.v.q()){var r=this.dQ(n);var f=this.f.be();var u=n?this.Q.w():this.Z().w();if(r>f*1024){t.c(!1);var o=i===1?10200:10201;this.g.a.a(o,_am.b.a(f),u)}else if(r>5242880){var e=i===1?10202:10203;this.g.a.a(e,_am.b.a(r/1024),u);t.c(!0)}else t.c(!0)}},fb:function(){var i=this.dR();var n=this.f.be();if(i>n*1024){var t=13306;this.f.z().a(t,_am.b.a(n));return!0}return!1},Z:function(){return this.e.d?this.e.d.t:this.Q},dV:function(){return!this.f.c()||!this.i||!this.i.a()?null:this.i.a().bD.DisplayName},cR:function(){this.f.G("Computer");this.f.bo("");this.f.br(this.f.bf()?this.g.e:!1)},ea:function(){this.f.R(!0);this.cT(!1)},cT:function(n){this.f.O(_a.c.b(_a.a.c,"AttachmentsFilePickerSelectDestination",!1,null));n&&this.f.u(this.h?"AttachmentsFilePickerAttachLocalImageFile":"AttachmentsFilePickerAttachLocalFile");this.cR();this.bu?this.bu():this.f.o().b&&this.f.o().a();this.w="AttachLocal";this.z();this.g.D();if(this.g.e){this.j.b().G(1);this.cx()}},fa:function(){if(this.dp()){this.f.O(_a.c.b(_a.a.c,"AttachmentsFilePickerSelectDestination",!1,null));this.f.u("AttachmentsFilePickerShareLocalFile");this.cR();this.bG?this.bG():this.f.w()&&this.f.w().b&&this.f.w().a();this.w="ShareLocal";this.z();this.g.D();if(this.g.e){this.j.b().G(2);this.cx()}}},cx:function(){_h.f.a(this.j.b().c(),this.cf);this.f.cs();this.g.M(!1)},fe:function(){if(!this.B){this.V(!1,!1,!1,!0);this.C(null)}this.e.p();this.K()},dm:function(){if(!this.da()&&this.H()){if(!this.s){this.V(!1,!1,!0,!1);this.C(null)}this.e.p();this.e.db(this.H().a);this.e.ck();this.K()}},eZ:function(){this.bi=new _ao.a("AttachmentsDataProvider_RecentDocuments","",_ufp.A.U,null,null,null);this.bi.a=!0;this.cu=new _ao.g(new(_h.dU.$$(_ao.g))(this.bi));this.bz()&&this.dn()},dn:function(){if(!this.N){this.V(!1,!0,!1,!1);this.r=null;this.C(null);this.e.bq(this.bi);this.e.bt(this.cu);this.e.p();this.e.cK();this.K()}},dl:function(){if((!this.q||!this.e.h.a)&&this.i&&this.i.a()){this.V(!0,!1,!1,!1);this.C(null);var i=new _gg.bT;i.Type=3;var n=new _gg.bS;n.GroupSmtpAddress=this.i.a().bD.SmtpAddress;this.r=n.GroupSmtpAddress;var t=new _ao.a(this.i.a().bD.SmtpAddress,"",this.i.a().bD.DisplayName,i,null,this.H().a);t.a=!0;this.e.z(t,!0,null,n);this.e.p();this.K()}},dD:function(){var n=new _a.l;n.a("W",this.f.c()?1:0);n.b("A",this.w?this.w:"");return n.toString()},fj:function(n,t){this.e.C&&(this.r=null)},dz:function(n,t){this.eE("HideGroupsButton");this.bd&&this.dh()},fg:function(){if(this.bB){if(!this.J){this.J=this.bD.e();this.J.b=this.cE}this.o(this.J)}},dt:function(){if(this.bC){this.G||(this.G=this.bw.e());this.o(this.G)}},dC:function(n){this.f&&this.f.bj(n,this.ba,!0);this.w="CreateNew";this.J.r();this.z()},dh:function(){!this.bb&&!this.R()||this.e.d||!this.bz()||this.q||this.s||this.B||(this.bc?this.dm():this.C(this.H()))},fm:function(n,t){this.K();this.eE("SelectedDataProvider")},eb:function(){var n=!1;this.e.r&&(n=this.e.r.length>0);return n},cU:function(){return this.e.f&&this.e.f.x.length>0?!this.e.d||!this.e.d.a.bD.AllowFolderSharing||this.h===1?!this.e.bj:!0:!1},cm:function(){return this.s||this.q},cs:function(){return this.e.d?!this.e.H&&(!!this.j&&this.j.c().bD.IsShadowMailbox||!!this.A&&this.A.a().iy().Enabled)&&this.e.d.L():!1},ei:function(n){this.G&&this.G.r();this.e.cm(n);this.e.A(this.L);this.C(n)},ej:function(n){this.e.d===n&&this.C(this.H())},ee:function(){this.z();this.cv.a("/options/attachmentoptions",null)},dX:function(n,t,i){if(!t){this.z();return!0}return!1},V:function(n,t,i,r){this.di(n);this.dk(t);this.dj(i);this.eu(r)}};_am.n=function(){this.c=Function.createDelegate(this,this.g);this.a=new _a.bG(1e3);_j.e.f||this.f()};_am.n.prototype={a:null,b:!0,f:function(){this.e();this.b=!1},e:function(){this.a.e()},d:function(n,t,i){if(this.b){var r=new _am.n.a;r.b=n;r.d=t;r.c=_a.d.d(_a.d.a());r.a=i;this.a.b(r)}},g:function(n){for(var t=new Sys.StringBuilder,r=0;r<this.a.a.length;r++){var i=this.a.f(r);t.append("\nSharePoint call name: "+i.d);t.append(", Time: "+i.c);t.append(", Correlation Id: "+i.b);_j.h.a(i.a)||t.append(", Exception: "+i.a);n&&t.appendLine("<BR>")}return new _a.bR("Attachments file picker diagnostics data:",t.toString())}};_am.n.a=function(){};_am.n.a.prototype={c:null,d:null,b:null,a:null};function AttachmentsFilePickerViewModelsComponent(){}AttachmentsFilePickerViewModelsComponent.$$cctor=function(){_a.t.a().a(AttachmentsFilePickerViewModelsComponent)};AttachmentsFilePickerViewModelsComponent.onOAuthFinished=function(n){var r=_a.w.b(n);var i=r.provider;if(_j.h.a(i)){var u=r.state;if(!_j.h.a(u)){var t=JsonParser.deserialize(u);t&&"provider"in t&&(i=t.provider)}}var f=_j.u.b(_g.q,i);AttachmentsFilePickerViewModelsComponent.a.b(f,r)};AttachmentsFilePickerViewModelsComponent.prototype={b:function(n,t,i){var v=this;n.b(_am.z,function(){return new _am.v(n.a(_a.q),n.a(_j.j),n.a(_a.f),i)}).a();var a=this;n.b(_am.c,function(){return new _am.c(n.a(_a.q),i.a(),n.a(_a.f),n.a(_at.s),n.a(_j.j),n.a(_am.z),i,!0)}).b(_am.I).a();var l=this;n.b(_am.l,function(){return new _am.l(n.a(_a.q),n.a(_j.j),n.a(_a.f),n.a(_g.h),n.a(_am.z),n.a(_am.c))}).a();var w=this;n.b(_am.h,function(){return new _am.h(n.a(_a.f),n.a(_j.j))}).a();var r=null;if(i.e().a().c().Enabled)if(i.a()==="Mouse"){var p=this;r=new(AttachmentsFilePickerViewModelsComponent.b.$$(_y.jr))(function(){var t=n.a(_y.s);return t?t.g:null})}else r=n.c(_y.ef);if(i.a()==="TouchNarrow"){var y=this;n.b(_am.i,function(){return new _am.i(n.f(_am.g).e(),n.a(_a.y),n.a(_j.o),n.a(_y.a),i.a()==="TouchNarrow"?n.a(_y.r):null)});var c=this;n.b(_am.g,function(){return new _am.g(n.a(_am.c),n.a(_am.h),r,n.f(_am.e),n.f(_am.i),n.a(_no.c),n.a(_am.n),n.a(_a.f),n.a(_a.bo),n.a(_j.j),n.a(_j.o),n.a(_y.a),n.a(_g.h),n.a(_a.q),n.a(_at.s),n.a(_am.l),n.a(_a.T),i,i.a()==="TouchNarrow"?n.a(_y.r):null)}).b(_y.bN).a()}else{var u=this;n.b(_am.b,function(){return new _am.b(n.a(_am.c),n.a(_am.h),r,n.f(_am.e),n.f(_am.k),n.f(_am.p),n.a(_no.c),n.a(_am.n),n.a(_a.f),n.a(_a.bo),n.a(_j.j),n.a(_j.o),n.a(_y.a),n.a(_g.h),n.a(_a.q),n.a(_at.s),n.a(_am.l),i,n.a(_a.T))}).b(_y.bN).a()}var f=this;n.b(_am.e,function(){return new _am.e(i.a(),n.a(_a.q),n.a(_j.o),n.a(_y.a),n.a(_a.f),i.a()==="TouchNarrow"?n.a(_y.r):null)});var e=this;n.b(_am.k,function(){return new _am.k(n.a(_j.o),n.a(_y.a))});var h=this;n.b(_am.p,function(){return new _am.p(n.a(_j.o),n.a(_y.a),n.a(_a.q),n.a(_am.l),n.a(_am.c))});var s=this;n.b(_am.D,function(){var u=n.a(_at.K);var r=n.a(_g.a).n();var t=_at.v.b(i);return new _am.D(u,r,n.a(_am.I),t?n.a(_y.bP):null,n.a(_at.H))}).b(_y.hE);var o=this;n.b(_am.n,function(){return new _am.n}).a();AttachmentsFilePickerViewModelsComponent.a=n.a(_y.bN)},a:function(){return null}};AttachmentsFilePickerViewModelsComponent.b=function(n){AttachmentsFilePickerViewModelsComponent.b.$$(this.$$gta["AttachmentsFilePickerViewModelsComponent.b"].T).initializeBase(this,[n])};AttachmentsFilePickerViewModelsComponent.b.$$=function(n){var u=AttachmentsFilePickerViewModelsComponent.__tc=AttachmentsFilePickerViewModelsComponent.__tc||{};var t="b"+"$"+n.getName().replace(/\./g,"_");if(!u[t]){var r=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];AttachmentsFilePickerViewModelsComponent.b.apply(this,t)};var h=_j.J;r.registerClass("AttachmentsFilePickerViewModelsComponent.__tc."+t,h,_j.cc.$$(n));var o={"AttachmentsFilePickerViewModelsComponent.b":{T:n},ctor:AttachmentsFilePickerViewModelsComponent.b};var c=h.prototype.$$gta;for(var l in c){var s={key:l,value:c[l]};o[s.key]=s.value}r.prototype.$$gta=o;var f=AttachmentsFilePickerViewModelsComponent.b.prototype;for(var e in f){var i={key:e,value:f[e]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return u[t]};AttachmentsFilePickerViewModelsComponent.b.prototype={d:function(){return!1},a:function(n){n&&n(this.e())},b:function(n){this.a(n)}};_am.E=function(){_am.E.initializeBase(this)};_am.E.prototype={b:!1,d:!1,c:function(){return this.b},a:function(n){if(this.b===n)return n;this.b=n;this.b&&(this.d=!0);return n},p:function(){return 600},q:function(){return 300},h:function(){return!0}};_am.e=function(n,t,i,r,u,f){this.N=Function.createDelegate(this,this.bc);this.O=Function.createDelegate(this,this.bd);this.z=Function.createDelegate(this,this.be);_am.e.initializeBase(this);this.u=n;this.G=t;this.w=i;this.K=r;this.i=u;this.j=f;this.bl(new _db.i);var e=this;this.H=new _j.g(function(){e.D();e.eP("AttachmentCanceled")},_a.a.c);this.u==="TouchNarrow"&&this.fh(this.R())};_am.e.prototype={H:null,u:0,G:null,w:null,K:null,i:null,a:null,p:null,o:null,r:null,v:null,g:!1,B:!1,A:!1,s:null,e:!1,c:null,E:null,h:null,q:null,J:!1,C:null,f:null,d:null,j:null,Q:function(n){this.eJ("AttachmentCanceled",n)},bf:function(n){this.eL("AttachmentCanceled",n)},bj:function(n){if(this.o!==n){this.o=n;this.eE("AttachCommand")}return n},P:function(n){if(this.r!==n){this.r=n;this.eI("InsertPictureInlineCommand","ShouldShowPersistAttachOrShareOptionCheckbox")}return n},bb:function(){return!this.h.b()&&!this.r},Z:function(){return!this.o.b&&!this.v.b},ba:function(){return!this.i.a().ez().Enabled},bn:function(n){if(this.v!==n){this.v=n;this.eE("ShareCommand")}return n},b:!1,Y:function(){return this.g?this.s?_ufp.A.n:this.i.a().Z().Enabled?this.b?_u.n.Qk:_u.n.Mz:this.b?_u.n.En:_u.n.By:this.i.a().Z().Enabled?this.b?String.format(_ufp.A.Bq,this.d.w()):String.format(_ufp.A.BW,this.d.w()):this.b?String.format(_ufp.A.z,this.d.w()):String.format(_ufp.A.BL,this.d.w())},X:function(){return this.i.a().Z().Enabled?this.b?_ufp.A.i:_ufp.A.Be:this.b?_ufp.A.v:_ufp.A.BM},U:function(){return this.b?_u.n.Ke:_u.n.NB},T:function(){return this.b?_ufp.A.Q:_ufp.A.Bp},bl:function(n){if(this.a!==n){this.a=n;this.eE("InfoBarViewModel")}return n},bi:function(n){if(this.g!==n){this.g=n;this.eE("AreLocalFiles")}return n},bh:function(n){if(this.B!==n){this.B=n;this.eE("AreGroupFiles")}return n},bg:function(n){if(this.A!==n){this.A=n;this.eE("AllowSettingAttachOrSharePreference")}return n},bm:function(n){if(this.s!==n){this.s=n;this.eE("ModernGroupDisplayName")}return n},M:function(n){if(this.e===n)return n;this.e=n;this.eE("PersistAttachOrShareOption");return n},V:function(){this.C||(this.C=new _at.W(!1));return this.C},W:function(){this.f||(this.f=new _am.E);return this.f},bx:function(){return this.u==="Mouse"?!this.w.b()||this.w.m()||this.K.b()?0:1:4},x:function(){return null},y:function(){return this.p},m:function(n){this.p=n;return n},by:function(){return!0},L:function(n){if(this.E!==n){this.E=n;this.eE("EmailAttachmentsFolderName")}return n},D:function(){this.p&&this.p()},dx:function(){_y.lB.prototype.dx.call(this);if(this.c){this.c.l=this.S();_a.c.a(this.c);this.c=null;this.f&&(this.f.d=!1)}},n:function(){return this.u==="TouchNarrow"?1:0},bk:function(n){if(this.d===n)return n;this.d=n;this.eE("DataProviderInfo");return n},bo:function(n,t,i){this.q=n;this.h=t;var u=this.q||"PersonalOneDriveKey";var r=_at.m.e(u);if(_j.h.a(r)){this.L(_ufp.A.Z);if(n&&(!i||!i.a(n,"AttachmentGetOneDriveUploadFolderName")))return;_j.h.a(this.q)||t.apcl("AttachmentDataProviders",this.z)}else this.L(r)},be:function(n,t){if(this.h.a()&&this.h.a().x.length){var i=new _at.m(this.q);i.b(this.O);i.c(this.N);this.G.a(i)}},bd:function(n){var t=n.f;_j.h.a(t)&&(t=_ufp.A.Z);this.L(t);this.h.rpcl("AttachmentDataProviders",this.z)},bc:function(n){this.h.rpcl("AttachmentDataProviders",this.z)},S:function(){var n=new _a.l;n.a("W",this.J?1:0);n.a("P",this.f&&this.f.d?1:0);return n.toString()},R:function(){var n=this.j.b();n.d(_ufp.A.S);if(this.w.a()){n.a(this.j.a(_y.b.b(),_y.b.b(),this.fg,""));n.e(3)}else n.a(this.j.a(_y.b.a(),_y.b.a(),this.fg,""));return n}};_am.t=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.t.initializeBase(this,[3,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.w(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.t.b=function(){return _fm.d.a("box_grey.png")};_am.t.a=function(){return _fm.d.a("box_dark.png")};_am.t.prototype={m:null,i:function(){return _am.t.b()},h:function(){return _am.t.a()},l:function(){return this.e()&&!this.a.b().bD.AttachmentsFilePickerHideAddBox},e:function(){return this.j.a().eC().Enabled&&!this.t(this.c)&&this.a.g().BoxAttachmentsEnabled&&this.a.g().ThirdPartyAttachmentsEnabled},d:function(n,t,i,r){var u=t.state;if(this.m===u){this.m=null;_am.f.prototype.d.call(this,n,t,i,r)}else this.f()},s:function(){return this.E()},o:function(n){this.a.b().bf(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eI("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var i="https://app.box.com/api/oauth2/authorize";var n=this.p;if(_j.h.a(n)){this.r();this.f();return}this.m=this.w();var t={state:this.m};this.q(i,n,"code",t)}};_am.l=function(n,t,i,r,u,f){this.R=Function.createDelegate(this,this.W);this.S=Function.createDelegate(this,this.X);this.Q=Function.createDelegate(this,this.V);_am.l.initializeBase(this);this.y=n;this.H=t;this.l=i;this.L=r;this.C=u;this.B=f;this.i(new _am.L(n,t,i,r,u,f));i&&i.a().eC().Enabled&&this.i(new _am.t(n,t,i,r,u,f));i&&i.a().eE().Enabled&&this.i(new _am.w(n,t,i,r,u,f));i&&i.a().eG().Enabled&&this.i(new _am.y(n,t,i,r,u,f));i&&i.a().eF().Enabled&&this.i(new _am.x(n,t,i,r,u,f))};_am.l.prototype={y:null,H:null,l:null,L:null,C:null,B:null,O:null,P:!1,A:!1,Y:function(n){n.n.a();this.bw("SelectedDataProviderCreator");return n},i:function(n){n.R(this.Q);_j.l.prototype.a.call(this,n)},M:function(n){this.bA("NewDataProviderCreated",n)},J:function(n){this.O=n;var t=this;this.o(function(t){var i=t;Object.getType(i)!==_gg.cP&&i.G(n)})},T:function(n){var t=null;var i=this;this.o(function(i){var r=i;r.c===n&&(t=r)});t||_j.e.c(_a.a.c,_j.h.c("{0} data provider creator does not exist",n));return t},U:function(){if(this.l&&this.l.a().cP().Enabled&&!this.P&&!this.A){this.A=!0;var n=new _ao.m;n.b(this.S);n.c(this.R);this.y.a(n)}},X:function(n){for(var i=n.e,t=0;t<i.length;t++){var r=null;switch(i[t].a()){case 7:r=new _am.A(i[t],this.y,this.H,this.l,this.L,this.C,this.B);break;case 8:r=new _am.B(i[t],this.y,this.H,this.l,this.L,this.C,this.B);break;default:_j.e.c(_a.a.c,String.format("This data provider creator is not supported Wopi data provider creator. Provider type = {0}",i[t].a()));continue}this.i(r);r.G(this.O)}this.P=!0;this.A=!1},W:function(n){_j.e.b(_a.a.c,"Failed to load Wopi data providers.");this.A=!1},V:function(n){this.bO("NewDataProviderCreated",n)}};_am.f=function(n,t,i,r,u,f,e){this.K=Function.createDelegate(this,this.W);this.L=Function.createDelegate(this,this.X);this.M=Function.createDelegate(this,this.Y);_am.f.initializeBase(this);this.c=n;this.g=t;this.C=i;this.j=r;this.a=u;this.A=f;this.b=e;this.v=_at.s.a(r,this.c);this.H=new _j.g(this.M,_a.a.c)};_am.f.prototype={n:null,H:null,g:null,j:null,a:null,A:null,b:null,p:null,y:null,x:null,C:null,v:null,U:function(){return this.v.w()},D:function(){return _j.h.c(_ufp.A.BD,this.v.w())},O:function(){return"code"},c:0,R:function(n){this.eJ("OnDataProviderCreated",n)},u:function(n){if(this.n!==n){this.n=n;this.eE("AddDataProviderCommand")}return n},G:function(n){this.x=n;this.r()},d:function(n,t,i,r){if(!n){this.f();_j.e.c(_a.a.c,_j.h.c("{0} oAuth code not returned in the redirect page.",_g.q.toString(this.c)));return}var f=this.N(_g.q.toString(this.c),"AttachmentsAddDataProvider");var u=new _ao.d(this.c,n,this.y);var o=this;u.b(function(n){o.T(n,i,r);o.B(f)});var e=this;u.c(function(n){e.S(n);f.m="FailedAddingProvider";e.B(f)});this.g.a(u)},r:function(){var n=new _ao.e(this.c);n.b(this.L);n.c(this.K);this.g.a(n)},V:function(){return window.location.host==="exchangelabs.live-int.com"?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa"},s:function(){return _j.h.c("{0}//{1}{2}ADPOAuthRedirect.html?provider={3}",window.location.protocol,window.location.host,window.location.pathname,_g.q.toString(this.c))},E:function(){var t=_j.h.c("{0}//{1}{2}ADPOAuthRedirect.html",window.location.protocol,window.location.host,window.location.pathname);var n=encodeURIComponent(_j.h.c("provider={0}&url={1}",_g.q.toString(this.c),t));return _j.h.c("{0}/ADPRedirect.aspx?{1}",this.V(),n)},q:function(n,t,i,r){this.y=this.s();var u=n;u=_a.w.a(u,"client_id",t);u=_a.w.a(u,"redirect_uri",this.y);u=_a.w.a(u,"response_type",i);if(r)for(var o=Object.keys(r),h=o.length,f=0;f<h;++f){var e=o[f];u=_a.w.a(u,e,r[e])}var s=this.N(_g.q.toString(this.c),"AttachmentsAddDataProviderAuthWindowOpened");this.B(s);_a.Y.a(u,600,600,!0)},f:function(){var n=this.v.w();this.Z(_ufp.A.O,_j.h.c(_ufp.A.BO,n))},Z:function(n,t){this.C.a(_a.u,new _a.u([t],0,null,0,!1,null,null,n,this.x,null))},t:function(n){if(this.b&&this.b.e)for(var t=0;t<this.b.e.x.length;t++)if(this.b.e.x[t].a.a()===n)return!0;return!1},w:function(){for(var i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),r=i.length-1,n=new Sys.StringBuilder("owa_csrf_token_"),t=0;t<16;t++)n.append(i[Math.round(Math.random()*r)]);return n.toString()},T:function(n,t,i){var u=n;var r=this.A.a(u.f,i);t(r);this.eQ("OnDataProviderCreated",r);this.eI("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},S:function(n){_ao.e.isInstanceOfType(n)?_j.e.b(_a.a.c,"GetNewAttachmentDataProviderCreationInfoAction failed"):_ao.d.isInstanceOfType(n)&&_j.e.b(_a.a.c,"AddNewAttachmentDataProviderAction failed");this.f()},Y:function(){this.o(!0)||_j.e.c(_a.a.c,_j.h.c("Failed to persist the configuration for removing '{0}' placeholder",this.D()));this.eI("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},X:function(n){var t=n;t.e===this.c&&(this.p=t.f.ProviderAppKey)},W:function(n){_j.e.b(_a.a.c,"GetNewAttachmentDataProviderCreationInfoAction failed")},N:function(n,t){var r=_a.c.b(_a.a.c,t,!1,null);var i=new _a.l;i.b("DP",n);r.l=i.toString();return r},B:function(n){_a.c.a(n)}};_am.w=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.w.initializeBase(this,[2,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.w(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.w.b=function(){return _fm.d.a("dropbox_grey.png")};_am.w.a=function(){return _fm.d.a("dropbox_dark.png")};_am.w.prototype={m:null,i:function(){return _am.w.b()},h:function(){return _am.w.a()},l:function(){return this.e()&&!this.a.b().bD.AttachmentsFilePickerHideAddDropbox},e:function(){return this.j.a().eE().Enabled&&!this.t(this.c)&&this.a.g().DropboxAttachmentsEnabled&&this.a.g().ThirdPartyAttachmentsEnabled},d:function(n,t,i,r){var u=t.state;if(this.m===u){this.m=null;_am.f.prototype.d.call(this,n,t,i,r)}else this.f()},o:function(n){this.a.b().bg(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eI("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var i="https://www.dropbox.com/1/oauth2/authorize";var n=this.p;if(_j.h.a(n)){this.r();this.f();return}this.m=this.w();var t={state:this.m};this.q(i,n,"code",t)}};_am.x=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.x.initializeBase(this,[6,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.w(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.x.b=function(){return _fm.d.a("facebook_grey.png")};_am.x.a=function(){return _fm.d.a("facebook_dark.png")};_am.x.prototype={m:null,O:function(){return"access_token"},i:function(){return _am.x.b()},h:function(){return _am.x.a()},l:function(){return this.e()&&!this.a.b().bD.AttachmentsFilePickerHideAddFacebook},e:function(){return this.j.a().eF().Enabled&&this.a.g().ThirdPartyAttachmentsEnabled&&!this.t(this.c)},d:function(n,t,i,r){var u=t.state;if(this.m===u){this.m=null;_am.f.prototype.d.call(this,n,t,i,r)}else this.f()},s:function(){var t=encodeURIComponent(_j.h.c("provider={0}",_g.q.toString(this.c)));var n=_j.h.c("{0}//{1}",window.location.protocol,window.location.host);return _j.h.c("{0}/FBOAuthRedirect.html?{1}",n,t)},o:function(n){this.a.b().bh(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eI("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var t=this.p;if(_j.h.a(t)){this.r();this.f();return}this.m=this.w();var n={state:this.m};n.scope=String.format("{0},{1}","user_photos","email");this.q("https://www.facebook.com/dialog/oauth",t,"token",n)}};_am.y=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.y.initializeBase(this,[5,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.w(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.y.b=function(){return _fm.d.a("gdrive_grey.png")};_am.y.a=function(){return _fm.d.a("gdrive_dark.png")};_am.y.prototype={m:null,i:function(){return _am.y.b()},h:function(){return _am.y.a()},l:function(){return this.e()&&!this.a.b().bD.AttachmentsFilePickerHideAddGDrive},e:function(){return this.j.a().eG().Enabled&&this.a.g().ThirdPartyAttachmentsEnabled&&!this.t(this.c)},d:function(n,t,i,r){var u=t.state;if(!_j.h.a(u)){var e=JsonParser.deserialize(u);var f=e.state;if(this.m===f){this.m=null;_am.f.prototype.d.call(this,n,t,i,r);return}}this.f()},s:function(){var n=window.location.host==="exchangelabs.live-int.com"?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";return _j.h.c("{0}/ADPRedirect.aspx",n)},o:function(n){this.a.b().bi(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eI("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var r="https://accounts.google.com/o/oauth2/auth";var n=this.p;if(_j.h.a(n)){this.r();this.f();return}this.m=this.w();var u=_j.h.c("{0}//{1}{2}ADPOAuthRedirect.html",window.location.protocol,window.location.host,window.location.pathname);var t={state:this.m,provider:_g.q.toString(this.c),url:u};var i={state:JsonParser.serialize(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent"};this.q(r,n,"code",i)}};_am.L=function(n,t,i,r,u,f){this.J=Function.createDelegate(this,this.P);_am.L.initializeBase(this,[1,n,t,i,r,u,f]);this.u(new _j.g(this.J,_a.a.c));var s=this;this.b.apcl("AttachmentDataProviders",function(){s.z()});var o=this;this.b.w(function(){o.z()});var e=this;this.b.n(function(){e.z()})};_am.L.prototype={m:null,i:function(){return _fm.a.Z},h:function(){return _fm.a.Z},l:function(){return this.e()&&!this.a.b().bD.AttachmentsFilePickerHideAddOneDriveConsumer},e:function(){var t=this.j.a().iO().Enabled&&!this.j.a().b().Enabled;var n=this.b.t;return(t||n)&&this.a.g().OnedriveAttachmentsEnabled&&this.a.g().ThirdPartyAttachmentsEnabled&&!this.t(this.c)},d:function(n,t,i,r){var u=t.state;if(this.m===u){this.m=null;_am.f.prototype.d.call(this,n,t,i,r)}else this.f()},s:function(){return this.E()},o:function(n){this.a.b().bj(n);return!!_h.f.a(this.a.b().c(),this.g)},z:function(){this.eI("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},P:function(){var i="https://login.live.com/oauth20_authorize.srf";var n=this.p;if(_j.h.a(n)){this.r();this.f();return}this.m=this.w();var t={scope:"wl.basic onedrive.readwrite wl.offline_access",state:this.m};this.q(i,n,"code",t)}};_am.A=function(n,t,i,r,u,f,e){_am.A.initializeBase(this,[n,t,i,r,u,f,e])};_am.A.b=function(){return _fm.d.a("box_grey.png")};_am.A.a=function(){return _fm.d.a("box_dark.png")};_am.A.prototype={i:function(){return _am.A.b()},h:function(){return _am.A.a()}};_am.B=function(n,t,i,r,u,f,e){_am.B.initializeBase(this,[n,t,i,r,u,f,e])};_am.B.b=function(){return _fm.d.a("egnyte_grey.png")};_am.B.a=function(){return _fm.d.a("egnyte_dark.png")};_am.B.prototype={i:function(){return _am.B.b()},h:function(){return _am.B.a()}};_am.R=function(n,t,i,r,u,f,e){this.P=Function.createDelegate(this,this.bc);this.Q=Function.createDelegate(this,this.bd);this.J=Function.createDelegate(this,this.ba);_am.R.initializeBase(this,[n.a(),t,i,r,u,f,e]);this.m=n;this.u(new _j.g(this.J,_a.a.c));var h=this;this.b.apcl("AttachmentDataProviders",function(){h.z()});var s=this;this.b.w(function(){s.z()});var o=this;this.b.n(function(){o.z()})};_am.R.prototype={m:null,i:function(){return null},h:function(){return null},l:function(){return!1},e:function(){return this.j.a().cP().Enabled&&this.a.g().ThirdPartyAttachmentsEnabled&&this.bb()&&!this.t(this.c)},bb:function(){return!!this.m&&!!this.m.bD.AuthorizationUri},d:function(n,t,i,r){_am.f.prototype.d.call(this,n,t,i,r)},G:function(n){this.x=n;if(!this.m.bD.AuthorizationUri){var t=new _ao.n(this.c);t.b(this.Q);t.c(this.P);this.g.a(t)}},s:function(){return this.E()},o:function(n){return!1},z:function(){this.eI("AddDataProviderEnabled","AddDataProviderEnabledInOptions")},ba:function(){this.q(this.m.bD.AuthorizationUri,this.m.bD.ProviderAppKey,"code",null)},bd:function(n){this.m=n.e},bc:function(n){_j.e.b(_a.a.c,"Failed to get data provider creator with provider type:{0}.",this.c)}};_am.o=function(n){this.l=Function.createDelegate(this,this.S);this.b=_am.a.c;this.h=_am.a.b;_am.o.initializeBase(this);this.a=n;var i=n.d;if(i){var t=i.r();this.b=t.SortOrder;this.h=t.SortColumn}this.a.apcl("IsSortingSupported",this.l)};_am.o.a=function(){return _fm.b.a(_fm.a.F,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_am.o.b=function(){return _fm.b.a(_fm.a.F,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_am.o.c=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_am.o.d=function(){return _fm.b.a(_fm.a.v,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_am.o.prototype={a:null,d:0,f:0,c:0,g:0,e:0,B:function(){return this.j(0,this.b)},y:function(){return this.j(2,this.d)},J:function(){return this.j(1,this.f)},v:function(){return this.j(3,this.c)},M:function(){return this.j(4,this.g)},E:function(){return this.j(5,this.e)},A:function(){return this.i(0,this.b)},x:function(){return this.i(2,this.d)},H:function(){return this.i(1,this.f)},u:function(){return this.i(3,this.c)},L:function(){return this.i(4,this.g)},D:function(){return this.i(5,this.e)},C:function(){return this.a.i?this.b?_ufp.A.J:_ufp.A.Bo:null},z:function(){return this.a.i?this.d?_ufp.A.M:_ufp.A.s:null},K:function(){return this.a.i?this.f?_ufp.A.t:_ufp.A.p:null},w:function(){return this.a.i?this.c?_ufp.A.J:_ufp.A.Bo:null},N:function(){return this.a.i?this.g?_ufp.A.J:_ufp.A.Bo:null},G:function(){return this.a.i?this.e?_ufp.A.M:_ufp.A.s:null},p:function(n){if(this.b!==n){this.b=n;this.eS("NameHeaderImageId","NameHeaderHoveredImageId","NameHeaderToolTip")}return n},o:function(n){if(this.d!==n){this.d=n;this.eS("LastModifiedHeaderImageId","LastModifiedHeaderHoveredImageId","LastModifiedHeaderToolTip")}return n},r:function(n){if(this.f!==n){this.f=n;this.eS("SizeHeaderImageId","SizeHeaderHoveredImageId","SizeHeaderToolTip")}return n},n:function(n){if(this.c!==n){this.c=n;this.eS("FromHeaderImageId","FromHeaderHoveredImageId","FromHeaderToolTip")}return n},s:function(n){if(this.g!==n){this.g=n;this.eS("SubjectHeaderImageId","SubjectHeaderHoveredImageId","SubjectHeaderToolTip")}return n},q:function(n){if(this.e!==n){this.e=n;this.eS("ReceivedDateHeaderImageId","ReceivedDateHeaderHoveredImageId","ReceivedDateHeaderToolTip")}return n},O:function(n){if(this.h!==n){this.h=n;this.m()}return n},R:function(n){return this.h===n?this.Q(n):0},t:function(n,t){this.O(n);this.P(n,t)},P:function(n,t){switch(n){case 0:this.p(t);break;case 1:this.r(t);break;case 2:this.o(t);break;case 3:this.n(t);break;case 4:this.s(t);break;case 5:this.q(t);break;default:break}},Q:function(n){var t=0;switch(n){case 0:this.p(this.k(this.b));t=this.b;break;case 1:this.r(this.k(this.f));t=this.f;break;case 2:this.o(this.k(this.d));t=this.d;break;case 3:this.n(this.k(this.c));t=this.c;break;case 4:this.s(this.k(this.g));t=this.g;break;case 5:this.q(this.k(this.e));t=this.e;break;default:break}return t},k:function(n){switch(n){case 0:n=1;break;case 1:n=0;break;default:break}return n},j:function(n,t){return this.a.i&&this.h===n?t?_am.o.a():_am.o.c():null},i:function(n,t){return this.a.i&&this.h===n?t?_am.o.b():_am.o.d():null},S:function(n,t){this.m()},m:function(){this.eN(["NameHeaderImageId","NameHeaderHoveredImageId","NameHeaderToolTip","LastModifiedHeaderImageId","LastModifiedHeaderHoveredImageId","LastModifiedHeaderToolTip","SizeHeaderImageId","SizeHeaderHoveredImageId","SizeHeaderToolTip","FromHeaderImageId","FromHeaderHoveredImageId","FromHeaderToolTip","SubjectHeaderImageId","SubjectHeaderHoveredImageId","SubjectHeaderToolTip","ReceivedDateHeaderImageId","ReceivedDateHeaderHoveredImageId","ReceivedDateHeaderToolTip"])}};_am.c=function(n,t,i,r,u,f,e,o){this.bV=Function.createDelegate(this,this.cv);this.bx=Function.createDelegate(this,this.ct);this.bU=Function.createDelegate(this,this.cu);this.X=Function.createDelegate(this,this.cD);this.bA=Function.createDelegate(this,this.ce);this.bB=Function.createDelegate(this,this.cF);this.by=Function.createDelegate(this,this.cA);this.bZ=Function.createDelegate(this,this.cE);this.cb=Function.createDelegate(this,this.cH);this.bW=Function.createDelegate(this,this.cz);this.ca=Function.createDelegate(this,this.cG);this.bX=Function.createDelegate(this,this.cB);this.bY=Function.createDelegate(this,this.cC);this.bz=Function.createDelegate(this,this.cd);this.u=_a.I.a();_am.c.initializeBase(this);this.bb=n;this.j=new _j.l;this.bM=t;this.N=i;this.bQ(new _j.l);this.bH=u;this.bG=f;this.cc=e;this.bR=o;this.i=!1;this.E=!1;this.W=!1;this.T=!1;this.V=!1;this.U=!0;this.K=new _j.g(this.bY,_a.a.c);this.J=new _j.g(this.bX,_a.a.c);this.L=new _j.g(this.ca,_a.a.c);this.bc=new _j.g(this.bW,_a.a.c);this.be=new _j.g(this.cb,_a.a.c);this.bd=new _j.g(this.bZ,_a.a.c);this.K.c(!1);this.J.c(!1);this.L.c(!1);this.y=r;i&&i.a()&&i.a().C()&&i.a().C().Enabled&&(_am.c.c=i.a().C().MCBingInlineImagePickerBaseEndpoint||"https://insertmedia.bing.office.net")};_am.c.prototype={e:null,bl:null,bn:null,d:null,h:null,j:null,o:null,bH:null,bb:null,y:null,bG:null,g:null,B:!1,Q:!1,bk:!1,m:null,l:null,O:null,bv:!1,bg:null,C:!1,bh:null,s:null,bM:0,P:!1,f:null,K:null,J:null,L:null,bc:null,be:null,bd:null,q:null,i:!1,U:!1,E:!1,W:!1,T:!1,V:!1,bu:!1,bj:!1,bC:!1,bR:!1,bf:null,bm:null,bN:null,H:0,N:null,bF:null,cc:null,x:null,r:null,t:!1,bP:function(n){this.H!==n&&(this.H=n);return n},Y:null,ba:!1,a:function(){return this.e},cP:function(n){if(this.e!==n){this.e=n;this.eE("AttachmentDataProviders");this.bT(n)}return n},cT:function(n){if(this.bl!==n){this.bl=n;this.eE("PrimaryDataProviders")}return n},cU:function(n){if(this.bn!==n){this.bn=n;this.eE("SecondaryDataProviders")}return n},bq:function(n){if(this.h!==n){this.h=n;this.dd();this.cS(this.co());this.cQ(new _am.o(this));this.eE("CurrentFolder")}return n},cQ:function(n){if(this.q!==n){this.q&&this.q.dispose();this.q=n;this.eE("CurrentFolderSortInfo")}return n},br:function(n){if(this.B!==n){this.B=n;this.eE("IsDataInProgress");this.bS();this.ch(n)}return n},ch:function(n){if(this.bk&&this.Q!==n){this.Q=n;this.eE("IsSearchingInProgress")}return n},bt:function(n){if(this.g===n)return n;if(this.g){this.g.bn(this.by);this.g.fY(this.bf)}this.g=n;if(this.g){var i=this.d;var t=this;this.bf=function(n,r){t.cs(i)};this.g.bc(this.by);this.g.fU(this.bf);this.g.d()?this.br(!0):this.bD()}this.eE("ItemsTable");return n},S:function(n){if(this.d!==n){var t=this.d;this.d=n;if(this.d){this.bP(this.d.bs());this.d.bd(!0);this.d.d||this.d.x(this.d.U());this.d.apcl("AttachmentItemsFilterBy",this.bB)}if(t){t.bd(!1);t.x(null);t.rpcl("AttachmentItemsFilterBy",this.bB)}this.bS();this.bw();this.eE("SelectedDataProvider")}return n},bQ:function(n){if(this.f!==n){this.f&&this.f.f(this.bA);this.f=n;this.f&&this.f.e(this.bA);this.ce(null,null);this.eE("SelectedAttachmentDataProviderItems")}return n},bo:function(n){if(this.r!==n){this.r=n;this.eE("SelectedAttachmentsChanged")}return n},R:function(n){if(this.O!==n){this.O=n;this.eE("InfoMessage")}return n},cj:function(n){if(this.bv!==n){this.bv=n;this.eE("ShowEmptySearchResultMessage")}return n},bp:function(n){if(this.o!==n){var t=this.o;this.o=n;if(this.o&&this.o!==_am.c.b&&(this.h!==n||t===_am.c.b)){this.v();this.z(this.o,!0,this.d?this.d.r():null)}this.eE("BreadCrumbsSelectedItem")}return n},cS:function(n){if(this.C===n)return n;this.C=n;this.eE("IsOneDriveProGroupsView");return n},Z:!1,bs:function(n){if(this.i!==n){this.i=n;this.df();this.eE("IsSortingSupported")}return n},cW:function(n){if(this.U!==n){this.U=n;this.eE("ShouldShowModifiedHeader")}return n},ci:function(n){if(this.E!==n){this.E=n;this.eE("ShouldShowClickableSizeHeader")}return n},cZ:function(n){if(this.W!==n){this.W=n;this.eE("ShouldShowUnclickableSizeHeader")}return n},cV:function(n){if(this.T!==n){this.T=n;this.eE("ShouldShowFromHeader")}return n},cY:function(n){if(this.V!==n){this.V=n;this.eE("ShouldShowSubjectHeader")}return n},cX:function(n){if(this.bu!==n){this.bu=n;this.eE("ShouldShowReceivedDateHeader")}return n},cq:function(){if(!this.bg){var t=this,n=this;this.bg=new _y.bs(new _am.P,function(n){return _gg.j.isInstanceOfType(n)?n.bD.GroupCategory:""},function(n){return n},"")}return this.bg},bI:function(){return this.bM==="Mouse"?this.y.a().O():this.y.a().P()},G:function(n){this.eJ("OnDataProvidersLoadedEvent",n)},bO:function(n){this.eL("OnDataProvidersLoadedEvent",n)},cR:function(n){this.bj=n;this.eE("IsAnyFolderSelected");return n},cr:function(){var n=this.bJ();return n?n.G():!1},b:function(){return this.t},w:function(n){this.eJ("DataProviderAddedToDPFilesViewModel",n)},n:function(n){this.eJ("DataProviderRemovedFromDPFilesViewModel",n)},cg:function(n){this.eL("DataProviderRemovedFromDPFilesViewModel",n)},dc:function(){if(this.r){this.x=this.r;this.bo(null)}},cN:function(){if(this.x){this.bo(this.x);this.x=null}},bE:function(){this.bo(null);this.x=null},cm:function(n){n.G(this.X);this.e.a(n);this.bT(this.e);this.eQ("DataProviderAddedToDPFilesViewModel",n)},cM:function(n){n.Z(this.X);this.e.p(n,!0);this.bT(this.e);this.eQ("DataProviderRemovedFromDPFilesViewModel",n)},A:function(n){this.bN=n;if(this.e){var t=this;this.e.o(function(i){var r=i;r.f()&&r.bm(n,function(n){t.cM(n)})})}},c:function(){this.l=_a.c.b(_a.a.c,"AttachmentsFilePickerGetDataProviders",!1,null);this.p();var n=new _at.z(2);n.b(this.bU);n.c(this.bx);this.bb.a(n)},cL:function(){if(!this.e){_j.e.b(_a.a.c,"Failed to ReloadFirstPrimaryDataProvider since AttachmentDataProviders is still null");return}this.p();for(var n,t=0;t<this.e.x.length;t++){n=this.e.x[t];if(n.a.a()===1||!n.a.a()){this.d===n?this.bL(n,null):this.S(n);break}}},z:function(n,t,i,r){this.bi(n,t,t,r,!1,i,null)},cO:function(n){this.v("AttachmentsFilePickerSearchItems");this.bi(this.h,!1,!0,null,!1,this.d?this.d.r():null,n)},da:function(n){if(n){this.bs(!1);this.bp(_am.c.b)}else{this.bw();this.bp(this.h);this.ch(!1)}this.bk=n},D:function(n){if(!this.h){_j.e.b(_a.a.c,"CurrentFolder is null when ReExpandCurrentFolderWithSortColumn");return}for(var i=0;i<this.f.x.length;i++){var r=this.f.x[i];this.u.a(r.bD.Id,!0)}var t=new _gg.ba;t.SortColumn=n;t.SortOrder=this.q.R(n);this.bi(this.h,!0,!0,null,!0,t,null);this.cp(n,t.SortOrder)},cf:function(){this.p();this.bi(this.h,!1,!0,null,!0,this.bF,null)},cp:function(n,t){var r=_a.c.b(_a.a.c,"AttachmentsFilePickerSort",!1,null);var i=new _a.l;i.a("C",n);i.a("O",t);r.l=i.toString();_a.c.a(r)},bi:function(n,t,i,r,u,f,e){if(n===this.s){this.ck();return}if(f)this.q&&this.q.t(f.SortColumn,f.SortOrder);else{f=new _gg.ba;f.SortColumn=_am.a.b;f.SortOrder=_am.a.c}if(t){this.p();this.bq(n);this.bF=f}var c=new _ao.j(n,n.f,f,n.e,e,n.d,r,u,this.H);var h=this;var o=_h.c.b(c,_h.g.a(),function(n){return new _ao.i(n,h.N)});i&&this.bt(o);var s=50;o.by&&o.by.x.length>0&&(s=o.by.x.length);o.k(new _h.m(0,s),null,null);i&&this.bS()},ck:function(){this.bq(this.s);this.bt(this.bh);this.bw();if(this.g){this.v("AttachmentsFilePickerGetGroups");this.g.bm();this.br(!0)}},cK:function(){if(this.g){this.v("AttachmentsFilePickerGetRecentItems");this.g.bm();this.br(!0)}},cI:function(){this.l=_a.c.b(_a.a.c,"AttachmentsFilePickerGetDataProvidersPreload",!1,null);var n=new _at.z(2);n.b(this.bV);n.c(this.bx);this.bb.a(n)},db:function(n){if(!this.s||!this.bh){this.s=new _ao.a("AttachmentsDataProvider_Groups","",_ufp.A.BU,null,null,n);this.s.a=!0;this.bh=new _ao.f(new(_h.dU.$$(_ao.f))(this.s))}},v:function(n){n||(n="AttachmentsFilePickerChangeFolder");if(this.m){var t=this.m;t.m="Abandoned";t.l=this.M();_a.c.a(this.m);this.m=null}this.m=_a.c.b(_a.a.c,n,!1,null)},p:function(){this.f.g()},cd:function(n){this.S(n);this.p();this.bL(n,null);this.bw()},bL:function(n,t){if(n)if(t){var r=new _ao.a("","",t.DisplayName,t,n.a.bD.EndPointUrl,n.a);r.a=!0;this.z(r,!1,n.r())}else{this.v("AttachmentsFilePickerLoadRootFolder");var u=n.c()?n.c().DisplayName:n.a.bD.DisplayName;var i=new _ao.a("","",u,n.c(),n.a.bD.EndPointUrl,n.a);i.a=!0;this.z(i,!0,n.r())}},dd:function(){if(this.h){if(this.o!==this.h||!this.j.x.length||this.j.x[this.j.x.length-1]!==this.h){var n=this.j.m(this.h);if(n>=0&&n<this.j.x.length-1)this.j.r(n+1,this.j.x.length-(n+1));else if(this.h.a||this.d&&this.h.Id===this.d.a.bD.Id){this.j.g();this.j.a(this.h)}else this.j.a(this.h);this.bp(this.h)}}else this.j.g()},cy:function(n){return n.a.bD.IsThirdPartyProvider||_am.q.isInstanceOfType(n)},bT:function(n){var r=new _j.l;var t=new _j.l;var i=this;n.o(function(n){var u=n;i.cy(u)?t=i.cn(t,u):r.a(u)});this.cT(r);this.cU(t)},cn:function(n,t){for(var i=0;i<n.x.length;i++){var r=n.x[i];if(r.a.bD.DisplayName.localeCompare(t.a.bD.DisplayName)>0){n.t(i,t);return n}}n.a(t);return n},cA:function(n,t){this.br(this.g.d());if(!this.B){if(this.m){this.m.l=this.M();_a.c.a(this.m);this.m=null;this.d&&this.d.g(this.g.bF)}if(this.u.f()>0){for(var u=new _j.l,f=this.g.by.x.length,i=f-1;i>=0;i--){var r=this.g.by.x[i];if(this.u.c(r.bD.Id)){u.a(r);this.u.e(r.bD.Id)}}this.bQ(u);this.u.f()>0&&(this.u=_a.I.a())}}},cs:function(n){if(this.g.bT){var u,r;var t=this.g.ce;switch(t.h){case 2:u=_ufp.A.H;r="AccessDenied";break;case 4:u=_ufp.A.B;r="NotFound";break;default:u=_ufp.A.C;r=_at.q.c(t);break}if(t.h===2&&n.f()){var f=this;this.bm=function(t){if(t===n){f.cg(f.bm);f.cJ(n)}};this.n(this.bm);n.w.a()}this.R(u);if(this.m){var i=this.m;i.m=t.P();i.o=r;i.n=t.O();i.l=this.M();_a.c.a(i);this.m=null}}},cl:function(n){var h=n;_am.c.a=h.e;if(_am.c.a.length<=0){if(!this.e||this.e.x.length<=0){this.R(this.bI());this.ba=!0}}else{this.ba=!1;for(var o=new _j.l,s=new _at.ba,c=_am.c.a,l=c.length,e=0;e<l;++e){var i=c[e];var u=!1;if(this.e)for(var f=0;f<this.e.x.length;f++){var r=this.e.x[f];if(r.a.bD.Id===i.bD.Id){r.bt(i);o.a(r);u=!0;break}}var t=null;if(!u){t=this.bG.a(i,this.bz);if(t){t.G(this.X);o.a(t)}}(t||u)&&s.b(i.a(),!0);t&&t.a.bD.Type===5&&!t.a.bD.IsThirdPartyProvider&&(this.t=!0)}this.cP(o);this.y.i(s);this.e.w(this.d)||this.S(null)}if(this.l){this.l.n=h.O();this.l.l=this.M();_a.c.a(this.l);this.l=null}this.Z=!0;this.eT("OnDataProvidersLoadedEvent",this,null)},cu:function(n){this.cl(n)},cv:function(n){this.cl(n);if(this.e&&this.bR)for(var t,r=0;r<this.e.x.length;r++){t=this.e.x[r];if(t.p()){for(var u=t.i(),i=0;i<u.d.length;i++)this.bL(t,u.d[i]);break}}},ct:function(n){this.S(null);this.R(this.bI());if(this.l){this.l.m=n?n.P():null;this.l.n=n?n.O():null;this.l.l=this.M();_a.c.a(this.l);this.l=null}this.eT("OnDataProvidersLoadedEvent",this,null)},bS:function(){if(this.B){this.bD();return}this.g&&(this.g.by&&this.g.by.x.length?this.bD():this.bk?this.cj(!0):this.O||this.R(_ufp.A.q))},bD:function(){this.cj(!1);this.R(null)},co:function(){return this.h&&this.h.Id==="AttachmentsDataProvider_Groups"?!0:!!this.d&&!!this.d.c()&&this.d.c().__type===_gg.bT._dataContractName&&this.d.c().Type===3&&this.j.x.length===1},M:function(){var n=new _a.l;n.a("W",this.P?1:0);this.d&&this.d.a&&n.b("DP",_g.q.toString(this.d.a.a()));return n.toString()},ce:function(n,t){var u=!1,f=!1;if(this.f)for(var i=0;i<this.f.x.length;i++){var r=this.f.x[i];this.bK(r)||(u=!0);(this.cw(r)||this.cx(r))&&(f=!0);if(u&&f)break}this.cR(u);this.bC=f;this.eE("SelectedAttachmentsChanged")},bK:function(n){return!n.a()||_gg.h.isInstanceOfType(n)},cx:function(n){return this.N&&this.N.a().bG().Enabled?this.bK(n)&&_j.h.a(_a.bd.a(n.bD.Name))&&n.bD.MimeType==="application/onenote":this.bK(n)&&_j.h.a(_a.bd.a(n.bD.Name))},cw:function(n){var r=this.bJ();if(r){var i=r.M();if(i)for(var u=n.bD.MimeType.toLowerCase(),t=0;t<i.d.length;t++)if(i.d[t].toLowerCase()===u)return!0}return!1},bw:function(){if(this.h&&this.h.Id==="AttachmentsDataProvider_Groups")this.ci(!0);else if(this.d){this.ci(this.d.l());this.cZ(this.d.V())}_j.e.a(_a.a.c,"ShouldShowClickableSizeHeader = {0}",this.E);this.h&&this.h.Id==="AttachmentsDataProvider_Groups"?this.bs(!1):this.d?this.bs(this.d.j()):this.bs(!1);_j.e.a(_a.a.c,"IsSortingSupported = {0}",this.i);this.d&&this.de()},de:function(){var n=this.bJ();if(n){this.cV(n.H());this.cY(n.K());this.cX(n.J());this.cW(n.I())}},df:function(){_j.e.a(_a.a.c,"UpdateSortingCommands with IsSortingSupported={0}",this.i);this.K.c(this.i);this.L.c(this.i);this.J.c(this.i);this.bc.c(this.i);this.be.c(this.i);this.bd.c(this.i)},cJ:function(n){if(this.Y){var u=n.a.a();var t=this.Y.T(u);if(t&&t.l()){var r=n.t.w();var f=this;var i=function(n,i){n&&t.n.a()};this.bH.a(_a.u,new _a.u([_j.h.c(_ufp.A.BI,r)],0,i,1,!1,null,null,_ufp.A.D,this.bN,null))}}},cC:function(){this.D(0)},cB:function(){this.D(2)},cG:function(){this.D(1)},cz:function(){this.D(3)},cH:function(){this.D(4)},cE:function(){this.D(5)},cD:function(n){this.cd(n)},bJ:function(){return this.d?this.y.c(this.d.a.a()):null},cF:function(n,t){this.bP(this.d.u);this.cf()}};_am.h=function(n,t){this.i=Function.createDelegate(this,this.d);this.p=Function.createDelegate(this,this.l);_am.h.initializeBase(this);this.q=n;this.n(_ufp.A.Bf);this.y(new _j.g(this.p,_am.h.a));this.z(new _j.g(this.i,_am.h.a));this.x(new _j.g(this.i,_am.h.a))};_am.h.prototype={e:0,q:null,b:!1,c:!1,m:null,a:null,f:null,j:null,k:null,g:null,h:null,A:function(n){if(this.b!==n){this.b=n;this.v();this.eE("IsSearchEnabled")}return n},B:function(n){if(this.c!==n){this.c=n;this.w();this.eI("IsSearchTextBoxInFocus","DoesUserIntendToSearch")}return n},r:function(){return this.c||!_j.h.a(this.a)},n:function(n){if(this.h!==n){this.h=n;this.eE("Placeholder")}return n},y:function(n){if(this.f!==n){this.f=n;this.eE("EnterCommand")}return n},x:function(n){this.j=n;this.eE("CancelCommand");return n},u:function(){return this.k},z:function(n){this.k=n;this.eE("EscapeCommand");return n},o:function(n){if(this.e!==n){this.e=n;this.eE("State")}return n},s:function(n){if(this.a!==n){this.a=n;this.eI("QueryString","DoesUserIntendToSearch")}return n},d:function(){this.s("");this.l()},C:function(n){if(this.b){this.n(_j.h.b(n)?_ufp.A.Bf:_j.h.c(_ufp.A.Bc,n));return!0}return!1},l:function(){if(this.b&&this.m!==this.a){this.m=this.a;this.t(this.a);this.o(_j.h.a(this.a)?0:1)}},w:function(){!this.c&&_j.h.a(this.a)&&this.l()},v:function(){this.b||this.o(0)},t:function(n){this.g&&this.g(n)}};_am.s=function(n){_am.s.initializeBase(this);this.a=n;this.a.U()};_am.s.prototype={a:null};_am.p=function(n,t,i,r,u){this.p=Function.createDelegate(this,this.v);this.o=Function.createDelegate(this,this.s);this.j=Function.createDelegate(this,this.r);_am.p.initializeBase(this);this.f=n;this.i=t;this.q=i;this.g=new _j.g(this.j,_a.a.c);this.b=new _j.l;this.a=u;this.d=r;r.J(null);this.h=new _am.s(this.d);this.u()};_am.p.prototype={g:null,f:null,i:null,q:null,h:null,a:null,b:null,d:null,e:null,bx:function(){return!this.f.b()||this.f.m()||this.i.b()?0:1},x:function(){return null},c:null,y:function(){return this.c},m:function(n){this.c=n;return n},by:function(){return!0},w:function(n){if(this.e!==n){this.e=n;this.eE("PrimaryDataProvider")}return n},r:function(){this.c&&this.c()},u:function(){this.a.G(this.o);var n=this;this.d.M(function(t){n.s()});this.a.n(this.p);this.a.c()},s:function(){this.b.g();this.a.A(null);this.a.e.x.length||_j.e.b(_a.a.d,"AttachmentDataProviders has no elements.");for(var n=0;n<this.a.e.x.length;n++){var t=this.a.e.x[n];n?t.a.a()!==4&&this.b.a(t):this.w(t)}},v:function(n){this.b.p(n,!0)}};_am.j=function(){_am.j.initializeBase(this);this.a=dataProviderModel;this.set_dataProviderPivots(this.createDataProviderPivots());this.selectedPivotChangedHandler=selectedPivotChangedHandler};_am.j.prototype={a:null};_am.m=function(n,t){this.a=n;this.b=t};_am.m.prototype={a:null,b:0};_am.u=function(n,t,i,r,u,f){_am.u.initializeBase(this,[n,t,i,r,u,f])};_am.u.a=function(){return _fm.d.a("box.png")};_am.u.prototype={e:function(){return _am.u.a()},n:function(){return!0},f:function(){return!0},o:function(){return!1},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"Files"}};_am.r=function(){};_am.r.prototype={b:0,c:0,a:!1};_am.a=function(n,t,i,r,u,f){this.O=Function.createDelegate(this,this.bn);this.P=Function.createDelegate(this,this.bo);this.Q=Function.createDelegate(this,this.br);_am.a.initializeBase(this);this.a=n;this.E=i;this.A=u;this.bc(this.z());t&&this.R(t);this.t=_at.s.a(u,this.a.a());this.H=r;this.K=!!u&&u.a().bm().Enabled&&!!f&&f.d().b("15.01.0484.000");this.w=new _j.g(this.Q,_a.a.c);this.M=new _j.g(this.P,_a.a.c);this.u=0;this.v=1;this.K&&this.bx()};_am.a.prototype={q:null,B:!1,a:null,d:null,b:null,w:null,M:null,C:null,H:null,E:null,A:null,D:null,K:!1,s:null,v:0,u:0,T:function(){return 0},bk:function(){return!_am.a.a&&!!this.s},V:function(){return!1},o:function(){return!0},J:function(){this.q||(this.q=new _am.r);return this.q},r:function(){var n=new _gg.ba;n.SortColumn=_am.a.b;n.SortOrder=_am.a.c;return n},f:function(){return!1},t:null,bd:function(n){if(this.B!==n){this.B=n;this.eE("IsSelected")}return n},bt:function(n){if(this.a!==n){this.a=n;this.bc(this.z());this.d&&this.x(this.U());this.eE("DataProviderModel")}return n},bc:function(n){if(this.b===n)return n;this.b=n;this.eI("DataProviderPivots","DataProviderPivotsArray");return n},bi:function(){return this.b.d()},x:function(n){if(this.d&&n&&this.d.b===n.b&&this.d.c===n.c)return n;this.d=n;this.d&&this.eT("SelectedPivotChangedHandler",this,null);this.eI("SelectedPivot","SelectedPivotIndex");return n},bj:function(){return!this.b||!this.a?-1:!this.d&&this.a?this.X():this.b.m(this.d)},bv:function(n){this.x(this.b.x[n]);return n},U:function(){return this.b?this.bl():null},c:function(){return this.b?this.d.a:null},bb:function(n){if(this.u!==n){this.u=n;this.eE("AttachmentItemsFilterBy")}return n},bu:function(n){if(this.s!==n){this.s=n;this.eI("ShouldShowItemsFilterByContextMenu","ItemsFilterByContextMenu")}return n},R:function(n){this.eJ("SelectedPivotChangedHandler",n)},bp:function(n){this.eL("SelectedPivotChangedHandler",n)},G:function(n){this.eJ("PivotClickHandler",n)},Z:function(n){this.eL("PivotClickHandler",n)},L:function(){return this.a.bD.IsSearchSupported},bm:function(n,t){this.D=n;this.C=t},bs:function(){_am.a.a?this.bb(1):this.be(1,0,!0);return this.u},bq:function(n,t){var i=n;if(i.e&&this.C){this.S(t);this.C(this)}else this.ba(t)},ba:function(n){n.m="RemoveProviderFailed";this.S(n);this.bw()},Y:function(){return null},m:function(n,t){var r=_a.c.b(_a.a.c,n,!1,null);var i=new _a.l;i.a("N",t);i.b("DP",this.W());r.l=i.toString();_a.c.a(r)},bh:function(n){var i=_a.c.b(_a.a.c,n,!1,null);var t=new _a.l;t.b("DP",this.W());i.l=t.toString();return i},S:function(n){_a.c.a(n)},bw:function(){!this.D;var n=this.t.w();this.H.a(_a.u,new _a.u([_j.h.c(_ufp.A.P,n)],0,null,0,!1,null,null,_ufp.A.u,this.D,null))},br:function(){var t=this.bh("AttachmentsRemoveDataProvider");var n=new _ao.q(this.a.bD.Id);var r=this;n.b(function(n){r.bq(n,t)});var i=this;n.c(function(n){i.ba(t)});this.E.a(n)},bo:function(){this.eT("PivotClickHandler",this,null)},W:function(){return this.a?_g.q.toString(this.a.a()):"Unknown"},z:function(){var t=this.a.b();if(!t||!t.b())return null;for(var i=new _j.l,n=0;n<t.b();n++){var u=_j.h.c("{0} {1}",this.a.bD.DisplayName,this.a.b().a(n).AriaLabel);var r=_j.h.c(_ufp.A.j,u);i.a(new _ff.f(t.a(n).DisplayName,t.a(n),r))}return i},bl:function(){if(!this.a.a())for(var t=this.a.b().a(this.X()),n=0;n<this.b.x.length&&t;n++)if(this.b.x[n].b===t.DisplayName)return this.b.x[n];return this.b.x[this.a.bD.DefaultScopeIndex]},X:function(){if(!this.a.a())for(var n=0;n<this.a.b().b();n++)if(!this.a.b().a(n).Type)return n;return this.a.bD.DefaultScopeIndex},bx:function(){var t=this.Y();if(t){var i=new _fm.e(new Array(0));i.p.a(new _fm.n(_ufp.A.W));for(var n=0;n<t.length;n++){var r=t[n].b;i.p.a(new _am.K(t[n].a,n+1,r,!n,this.O))}this.bu(i)}},bn:function(n,t){this.be(n,t,!1)},be:function(n,t,i){if(this.v!==n){var u=this.s.p.x[this.v];u.i(!1);this.v=n;if(i){var r=this.s.p.x[this.v];r.i(!0)}}this.bb(t)}};_am.v=function(n,t,i,r){this.c=n;this.e=t;this.b=i;this.d=r};_am.v.prototype={c:null,e:null,b:null,d:null,a:function(n,t){var i=n.a();switch(i){case 0:return new _am.N(n,t,this.c,this.e,this.b,this.d);case 1:return new _am.M(n,t,this.c,this.e,this.b,this.d);case 2:return new _am.F(n,t,this.c,this.e,this.b,this.d);case 3:return new _am.u(n,t,this.c,this.e,this.b,this.d);case 5:return new _am.H(n,t,this.c,this.e,this.b,this.d);case 4:return this.b.a().jb().Enabled?new _am.q(n,t,this.c,this.e,this.b,this.d):null;case 6:return new _am.G(n,t,this.c,this.e,this.b,this.d);case 7:return new _am.O(n,t,this.c,this.e,this.b,this.d);case 8:return new _am.J(n,t,this.c,this.e,this.b,this.d)}_j.e.b(_am.v.a,String.format("This data provider is not a defined AttachmentDataProviderType in the client code. Provider type = {0}",i));return null}};_am.F=function(n,t,i,r,u,f){_am.F.initializeBase(this,[n,t,i,r,u,f])};_am.F.a=function(){return _fm.d.a("dropbox.png")};_am.F.prototype={e:function(){return _am.F.a()},n:function(){return!0},f:function(){return!0},o:function(){return!1},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"My files"}};_am.G=function(n,t,i,r,u,f){_am.G.initializeBase(this,[n,t,i,r,u,f]);var e;this.q=(e=new _am.r,e.c=2,e.a=!0,e)};_am.G.a=function(){return _fm.d.a("facebook.png")};_am.G.prototype={T:function(){return 1},e:function(){return _am.G.a()},n:function(){return!1},f:function(){return!0},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!1},j:function(){return!1},h:function(){return"Photos"},o:function(){return!!this.b}};_am.H=function(n,t,i,r,u,f){_am.H.initializeBase(this,[n,t,i,r,u,f]);var e;this.q=(e=new _am.r,e.b=2,e.a=!0,e)};_am.H.a=function(){return _fm.d.a("gdrive.png")};_am.H.prototype={e:function(){return _am.H.a()},n:function(){return!0},f:function(){return this.a.bD.IsThirdPartyProvider},o:function(){return!1},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"Files"}};_am.q=function(n,t,i,r,u,f){_am.q.initializeBase(this,[n,t,i,r,u,f])};_am.q.a=function(){return _fm.d.a("recent-attachments_32x32.png")};_am.q.prototype={e:function(){return _am.q.a()},n:function(){return!1},f:function(){return!1},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"Files"},o:function(){return!1},r:function(){var n=new _gg.ba;n.SortColumn=5;n.SortOrder=1;return n},Y:function(){var n=new Array(5);n[0]=new _am.m(_ufp.A.Y,0);n[1]=new _am.m(_ufp.A.y,2);n[2]=new _am.m(_ufp.A.I,3);n[3]=new _am.m(_ufp.A.Bb,4);n[4]=new _am.m(_ufp.A.Ba,5);return n}};_am.M=function(n,t,i,r,u,f){_am.M.initializeBase(this,[n,t,i,r,u,f]);var e;this.q=(e=new _am.r,e.b=2,e.a=!0,e)};_am.M.prototype={f:function(){return this.a.bD.IsThirdPartyProvider},o:function(){return this.N()},j:function(){return!this.by()},l:function(){return!1},V:function(){return!0},g:function(n){this.m(this.bf(),n)},h:function(){return this.bf()},i:function(){var t=new _j.q;var i=this.y(this.a.b().a(this.a.bD.DefaultScopeIndex));(i!==4||this.N())&&t.c(this.a.b().a(this.a.bD.DefaultScopeIndex));if(i)for(var n=0;n<this.a.b().b();n++){var r=this.y(this.a.b().a(n));if(!r){t.c(this.a.b().a(n));break}}return t},z:function(){var n=this.a.b();if(!n||!n.b())return null;for(var i=new _j.l,t=0;t<n.b();t++)(this.y(n.a(t))!==4||this.N())&&i.a(new _ff.f(n.a(t).DisplayName,n.a(t),this.bg(n.a(t))));return i},by:function(){return!!this.c()&&this.y(this.c())===4},y:function(n){return n.__type===_gg.lY._dataContractName,n.Type},bf:function(){var n=this.y(this.c());switch(n){case 4:return"ODCRecentFiles";case 0:return"ODCFiles";default:return"ODCOther"}},N:function(){return!!this.A&&this.A.a().ip().Enabled}};_am.Q=function(n,t,i,r,u,f){_am.Q.initializeBase(this,[n,t,i,r,u,f])};_am.Q.prototype={e:function(){return _fm.a.Z},n:function(){return!0},p:function(){return!0},bg:function(n){var t=_j.h.c("{0} {1}",this.a.bD.DisplayName,n.AriaLabel);return _j.h.c(_ufp.A.j,t)}};_am.N=function(n,t,i,r,u,f){_am.N.initializeBase(this,[n,t,i,r,u,f]);var e;this.q=(e=new _am.r,e.a=!!u&&u.a().es().Enabled,e)};_am.N.prototype={j:function(){return!0},h:function(){var n=this.c().Type;switch(n){case 0:return"My files";case 4:return"Recent";case 1:return"Shared with me";case 3:return"Group files"}return"Unknown"},g:function(n){var i=this.c().Type;var t=null;switch(i){case 0:t="AttachmentsFilePickerMyFiles";break;case 4:t="AttachmentsFilePickerRecentFiles";break;case 1:t="AttachmentsFilePickerSharedWithMeFiles";break;case 3:t="AttachmentsFilePickerGroupFiles";break}_j.h.a(t)||this.m(t,n)},L:function(){return _am.a.prototype.L.call(this)&&this.y()},i:function(){var i=new _j.q;var t=this.a.b().a(this.a.bD.DefaultScopeIndex);t.Type!==4&&i.c(t);if(t.Type)for(var n=0;n<this.a.b().b();n++){var r=this.a.b().a(n);if(!r.Type){i.c(r);break}}return i},l:function(){return this.y()},z:function(){var n=this.a.b();if(!n||!n.b())return null;for(var i=new _j.l,t=0;t<n.b();t++)n.a(t).Type!==4&&i.a(new _ff.f(n.a(t).DisplayName,n.a(t),this.bg(n.a(t))));return i},y:function(){return!!this.c()&&this.c().__type===_gg.bT._dataContractName&&!this.c().Type}};_am.S=function(n,t,i,r,u,f){_am.S.initializeBase(this,[n,t,i,r,u,f])};_am.S.prototype={e:function(){return null},n:function(){return!0},f:function(){return!0},g:function(n){this.m("AttachmentsFilePickerMyFiles",n)},p:function(){return!1},i:function(){return new _j.q},l:function(){return!0},j:function(){return!0},h:function(){return"Files"},o:function(){return!1}};_am.O=function(n,t,i,r,u,f){_am.O.initializeBase(this,[n,t,i,r,u,f])};_am.O.prototype={e:function(){return _am.u.a()}};_am.J=function(n,t,i,r,u,f){_am.J.initializeBase(this,[n,t,i,r,u,f])};_am.J.a=function(){return _fm.d.a("egnyte.png")};_am.J.prototype={e:function(){return _am.J.a()}};_am.k=function(n,t){this.p=Function.createDelegate(this,this.u);this.o=Function.createDelegate(this,this.s);this.q=Function.createDelegate(this,this.v);this.j=Function.createDelegate(this,this.r);_am.k.initializeBase(this);this.c=n;this.i=t;this.d=new _j.g(this.j,_a.a.c);this.h=new _j.g(this.q,_a.a.c);this.f=new _j.g(this.o,_a.a.c);this.g=new _j.g(this.p,_a.a.c)};_am.k.prototype={d:null,c:null,i:null,h:null,f:null,g:null,bx:function(){return!this.c.b()||this.c.m()||this.i.b()?0:1},x:function(){return null},a:null,y:function(){return this.a},m:function(n){this.a=n;return n},by:function(){return!0},b:null,r:function(){this.a&&this.a()},v:function(){this.e(0)},s:function(){this.e(1)},u:function(){this.e(2)},e:function(n){this.b&&this.b(n)}};_am.C.registerClass("_am.C",_a.bu,_fm.m);_am.K.registerClass("_am.K",_fm.g);_am.d.registerClass("_am.d",_at.Y);_am.D.registerClass("_am.D",null,_y.hE);_am.i.registerClass("_am.i",_y.lB);_am.b.registerClass("_am.b",_a.bu,_y.bN,_bc.j,_bc.s,_bc.w,_a.kh,_j.bs,Sys.IDisposable,_y.bp);_am.g.registerClass("_am.g",_am.b,_y.B,_bc.w,_a.kh,_j.bs,Sys.IDisposable,_y.eZ);_am.n.registerClass("_am.n");AttachmentsFilePickerViewModelsComponent.registerClass("AttachmentsFilePickerViewModelsComponent",null,_a.jv,_j.ce);_am.E.registerClass("_am.E",_a.bu,_y.gk,_a.kh,_j.bs,Sys.IDisposable);_am.e.registerClass("_am.e",_y.lB,_bc.j,_bc.s,_bc.w,_a.kh,_j.bs,Sys.IDisposable);_am.f.registerClass("_am.f",_a.bu);_am.t.registerClass("_am.t",_am.f);_am.l.registerClass("_am.l",_j.l);_am.w.registerClass("_am.w",_am.f);_am.x.registerClass("_am.x",_am.f);_am.y.registerClass("_am.y",_am.f);_am.L.registerClass("_am.L",_am.f);_am.R.registerClass("_am.R",_am.f);_am.A.registerClass("_am.A",_am.R);_am.B.registerClass("_am.B",_am.R);_am.o.registerClass("_am.o",_a.gb);_am.c.registerClass("_am.c",_a.bu,_am.I,_a.kh,_j.bs,Sys.IDisposable);_am.h.registerClass("_am.h",_a.gb);_am.s.registerClass("_am.s",_a.bu);_am.p.registerClass("_am.p",_y.lB,_bc.j,_bc.s,_bc.w,_a.kh,_j.bs,Sys.IDisposable);_am.j.registerClass("_am.j",_a.bu);_am.a.registerClass("_am.a",_a.bu);_am.u.registerClass("_am.u",_am.a);_am.F.registerClass("_am.F",_am.a);_am.G.registerClass("_am.G",_am.a);_am.H.registerClass("_am.H",_am.a);_am.q.registerClass("_am.q",_am.a);_am.Q.registerClass("_am.Q",_am.a);_am.M.registerClass("_am.M",_am.Q);_am.N.registerClass("_am.N",_am.Q);_am.S.registerClass("_am.S",_am.a);_am.O.registerClass("_am.O",_am.S);_am.J.registerClass("_am.J",_am.S);_am.k.registerClass("_am.k",_y.lB,_bc.j,_bc.s,_bc.w,_a.kh,_j.bs,Sys.IDisposable);_am.d.a=_a.a.c;AttachmentsFilePickerViewModelsComponent.a=null;AttachmentsFilePickerViewModelsComponent.$$cctor();_am.c.b=new _ao.a(null,null,"Search",null,null,null);_am.c.a=null;_am.c.c=null;_am.h.a=_a.a.c;_am.a.b=2;_am.a.c=1;_am.a.a=!1;_am.v.a=_a.a.c;
window.scriptsLoaded['microsoft.owa.attachments.filepicker.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.attachments.filepicker.viewmodels.js'] = (new Date()).getTime();
