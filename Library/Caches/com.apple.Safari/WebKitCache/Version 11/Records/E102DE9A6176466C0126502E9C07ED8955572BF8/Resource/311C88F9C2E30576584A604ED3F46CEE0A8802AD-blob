var HomePage;!function(e){var t=function(){function e(){}return e}();e.BannerSettings=t;var n=function(){function e(){this.$banner=$("#BannerContainer"),this.$settings=$("#BannerSettings"),this.init()}return e.prototype.init=function(){var e=this;this.$banner.length&&this.$settings.length&&(this.settings=JSON.parse(this.$settings.html()),$("#bannerInfoLink").click(function(t){e.close()}),$("#bannerCloseLink").click(function(t){e.close(),t.preventDefault()}),this.initialized=!0)},e.prototype.close=function(){if(this.initialized){var e=new Date;e.setFullYear(e.getFullYear()+1),document.cookie=this.settings.dismissCookieName+"=1; path=/; secure; expires="+e.toUTCString(),this.$banner.hide()}},e}();e.Banner=n;var a=function(){function e(){}return e}();e.MSABannerSettings=a;var i=function(){function e(){this.$msaBanner=$("#MSABannerContainer"),this.$msaSettings=$("#MSABannerSettings"),this.init()}return e.prototype.init=function(){var e=this;this.$msaBanner.length&&this.$msaSettings.length&&(this.msaSettings=JSON.parse(this.$msaSettings.html()),$("#msaBannerDismissLink").click(function(t){e.close(),t.preventDefault()}),$("#msaBannerInfoLink").click(function(t){e.close()}),this.initialized=!0)},e.prototype.close=function(){if(this.initialized){var e=new Date;e.setFullYear(e.getFullYear()+1),document.cookie=this.msaSettings.dismissCookieName+"=1; path=/; secure; expires="+e.toUTCString(),this.$msaBanner.hide()}},e}();e.MSABanner=i}(HomePage||(HomePage={})),$(function(){HomePage.banner=new HomePage.Banner,HomePage.msaBanner=new HomePage.MSABanner});var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},HomePage;!function(e){function t(){new i($("#hero-section")),new o($("#what-is-office-365-section")),new s($("#get-office-today-section")),new r($("#hero-section")),new c($("#social-media-section"))}var n=function(){function e(){}return e.debounce=function(e,t,n){var a;return function(){var i=this,r=arguments,o=function(){a=null,n||e.apply(i,r)},s=n&&!a;clearTimeout(a),a=setTimeout(o,t),s&&e.apply(i,r)}},e}(),a=function(){function e(e){var t=this;if(this.$el=e,e.length){var a=$.Deferred(),i=function(){t.isItemPartiallyVisible(t.$el)&&a.resolve()},r=n.debounce(function(){i()},100,!1);$(window).on("load",i),$(window).on("resize",r),$(window).on("scroll",r),a.then(function(){return t.loadImages().then(function(){return t.playAnimations().then(function(){$(window).off("load",i),$(window).off("resize",r),$(window).off("scroll",r),t.initialized()})})})}}return e.prototype.isItemPartiallyVisible=function(e){var t=window.innerHeight,n=window.innerWidth,a=e[0].getBoundingClientRect();return a.top<=t&&a.bottom>=0&&a.left<=n&&a.right>=0},e.prototype.loadImages=function(){return this.$el.find("img[data-src]").each(function(){var e=$(this);e.attr("src",e.attr("data-src")).removeAttr("data-src")}),$.Deferred().resolve()},e.prototype.playAnimations=function(){return $("."+e.animateBeforeClass,this.$el).removeClass(e.animateBeforeClass),$.Deferred().resolve()},e}();a.animateBeforeClass="animate-before";var i=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.initialized=function(){this.connectVideoControls(),this.setupParallax(),this.connectScrollButton()},t.prototype.connectVideoControls=function(){var e=this.$el.find("#background-video").get(0);if(e){var t=this.$el.find("#play-button"),n=this.$el.find("#pause-button");t.click(function(){e.play(),t.hide(),n.show()}),n.click(function(){e.pause(),n.hide(),t.show()})}},t.prototype.setupParallax=function(){var e=this.$el.find(".parallax-item"),t=this.$el.find(".fade-in-out");if(!(0===e.length||0===t.length||window.outerWidth<1024)){window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){$(window).scroll(e)}}());var n=e.position().top;this.parallax(e,t,n)}},t.prototype.parallax=function(e,t,n){var a=this,i=window.pageYOffset;e.css({"-moz-transform":"translateY("+(n-i/4)+"px)","-webkit-transform":"translateY("+(n-i/4)+"px)","-o-transform":"translateY("+(n-i/4)+"px)",transform:"translateY("+(n-i/4)+"px)"}),window.innerWidth>=1024&&t.css("opacity",1-i/($(window).height()/2)),window.requestAnimationFrame(function(){return a.parallax(e,t,n)})},t.prototype.connectScrollButton=function(){this.$el.find("#scroll-button").click(function(){$("html, body").animate({scrollTop:.75*$(window).height()},1e3,"swing")})},t}(a),r=function(){function e(e){e.length&&(this.$document=e,this.$simpleSignout=e.find("#personalization-remove-link"),this.$switchAccountLink=e.find("#switch-account-link"),this.$lastEmail=e.find("#last-signed-in-email"),this.$inputEmailWrapper=e.find("#NewEmail"),this.$inputEmail=e.find("#try-different-email"),this.$signInButton=e.find("#hero-banner-sign-back-in-to-office-365-link"),this.$closeNewEmailButton=e.find("#closeNewEmail"),this.signOutClick(),this.SwitchAccount(),this.SignInWithNewEmail(),this.CloseNewEmail())}return e.prototype.signOutClick=function(){this.$simpleSignout.click(function(e){e.preventDefault(),$.ajax({url:"/RemovePersonalizationContent",type:"POST",success:function(){window.location.href=window.location.origin},error:function(e,t,n){}})})},e.prototype.SwitchAccount=function(){var e=this;this.$switchAccountLink.click(function(t){t.preventDefault(),e.$inputEmail.val(""),e.$inputEmail.attr("aria-hidden","false"),e.$lastEmail.hide(),e.$inputEmailWrapper.show()})},e.prototype.SignInWithNewEmail=function(){var e=this;this.$signInButton.click(function(t){var n=$.trim(e.$inputEmail.val()),a=e.$signInButton.attr("href"),i=e.updateQueryStringParameter(a,n);e.$signInButton.attr("href",i)})},e.prototype.CloseNewEmail=function(){var e=this;this.$closeNewEmailButton.click(function(t){t.preventDefault(),e.$lastEmail.show(),e.$inputEmailWrapper.hide(),e.$inputEmail.val("")})},e.prototype.updateQueryStringParameter=function(e,t){if(e){var n=/login_hint=(.*?)(?=&|$)/g,a=encodeURI("login_hint="+t);return e.replace(n,a)}},e}(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialized=function(){},t}(a),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialized=function(){},t}(a),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.initialized=function(){},t}(a);e.init=t}(HomePage||(HomePage={}));var awa=awa||{},behaviorKey;awa.isInitialized=!1,awa.verbosityLevels={NONE:0,ERROR:1,WARNING:2,INFORMATION:3},awa.behavior={UNDEFINED:0,NAVIGATIONBACK:1,NAVIGATION:2,NAVIGATIONFORWARD:3,APPLY:4,REMOVE:5,SORT:6,EXPAND:7,REDUCE:8,CONTEXTMENU:9,TAB:10,COPY:11,EXPERIMENTATION:12,STARTPROCESS:20,PROCESSCHECKPOINT:21,COMPLETEPROCESS:22,DOWNLOADCOMMIT:40,DOWNLOAD:41,SEARCHAUTOCOMPLETE:60,SEARCH:61,PURCHASE:80,ADDTOCART:81,VIEWCART:82,ADDWISHLIST:83,FINDSTORE:84,CHECKOUT:85,REMOVEFROMCART:86,PURCHASECOMPLETE:87,SIGNIN:100,SIGNOUT:101,SOCIALSHARE:120,SOCIALLIKE:121,SOCIALREPLY:122,CALL:123,EMAIL:124,COMMUNITY:125,VOTE:140,SURVEYINITIATE:141,SURVEYCOMPLETE:142,REPORTAPPLICATION:143,REPORTREVIEW:144,CONTACT:160,REGISTRATIONINITIATE:161,REGISTRATIONCOMPLETE:162,CHATINITIATE:180,CHATEND:181,TRIALSIGNUP:200,TRIALINITIATE:201,PARTNERREFERRAL:220,VIDEOSTART:240,VIDEOPAUSE:241,VIDEOCONTINUE:242,VIDEOCHECKPOINT:243,VIDEOJUMP:244,VIDEOCOMPLETE:245,VIDEOBUFFERING:246,VIDEOERROR:247,VIDEOMUTE:248,VIDEOUNMUTE:249,VIDEOFULLSCREEN:250,VIDEOUNFULLSCREEN:251,VIDEOREPLAY:252,VIDEPLAYERLOAD:253,VIRTUALEVENTJOIN:260,VIRTUALEVENTEND:261,IMPRESSION:280,CLICK:281,RICHMEDIACOMPLETE:282,ADBUFFERING:283,ADERROR:284,ADSTART:285,ADCOMPLETE:286,ADSKIP:287,ADTIMEOUT:288,OTHER:300},awa.behaviorKeys=[];for(behaviorKey in awa.behavior)awa.behaviorKeys.push(behaviorKey);awa.actionType={CLICKLEFT:"CL",CLICKRIGHT:"CR",SCROLL:"S",ZOOM:"Z",RESIZE:"R",KEYBOARDENTER:"KE",KEYBOARDSPACE:"KS",OTHER:"O"},awa.cookie=function(){function e(e,n){var a,i,r,o=t(e);if(o&&n)for(a=o.split("&"),i=0;i<a.length;i++)if(r=a[i].split("="),r[0]&&n.toLowerCase()===r[0].toLowerCase())return r[1];return null}function t(e){for(var t,a,i=document.cookie.split(";"),r=0;r<i.length;r++){for(t=i[r];" "===t.charAt(0);)t=t.substring(1);if(a=t.split("="),n(a.shift())===e)return n(a.join("="))}return null}function n(e){var t=decodeURIComponent(e.replace("/+/g"," "));return 0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),t}function a(e,t,n){var a,i;n?(i=new Date,i.setTime(i.getTime()+864e5*n),a="; expires="+i.toUTCString()):a="",window.document.cookie=e+"="+t+a+"; path=/;"}function i(e){a(e,"",-1)}return{getCookie:t,getCookieKeyValue:e,setCookie:a,deleteCookie:i}}(),awa.cv=function(){function e(){return d(t())}function t(){return b.concat(".",E.toString())}function n(){var e=t();if(d(e))return e}function a(e){var t,n,a,i,r;if(d(e)){for(t=e.split("."),n=t.length,t[n-1]=(parseInt(t[n-1],10)+1).toString(),a="",i=0;i<n;i++)a+=t[i],i<n-1&&(a+=".");if(r=t[0].length===h.baseLength?h.maxCorrelationVectorLength:T.maxCorrelationVectorLength,a.length<=r)return a}}function i(){var e=t();return!!d(e)&&m(e.length+2)}function r(){return!!d(t())&&m(b.length+1+(E+1+"").length)}function o(e){if(!d(e))return awa.logger.logWarning("Cannot set invalid correlation vector value"),null;var n=e.lastIndexOf(".");return b=e.substr(0,n),E=parseInt(e.substr(n+1),10),t()}function s(e){return e?o(e):(b=c(),E=0,n())}function c(){for(var e="",t=0;t<w.baseLength;t++)e+=C.charAt(Math.floor(Math.random()*C.length));return e}function u(){if(i())return b=b.concat(".",E.toString()),E=0,t()}function l(){if(r())return E+=1,t()}function d(e){if(e){var t=e.split(".")[0];if(t){if(16===t.length)return y=1,p(e);if(22===t.length)return y=2,g(e)}}}function p(e){if(T.validationPattern.test(e)&&e.length<=T.maxCorrelationVectorLength)return!0}function g(e){if(h.validationPattern.test(e)&&e.length<=h.maxCorrelationVectorLength)return!0}function m(e){return 1===y?e<=T.maxCorrelationVectorLength:e<=h.maxCorrelationVectorLength}function f(){w=T}function v(){w=h}var h,w,y,b="",E=0,C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T={};return T.maxCorrelationVectorLength=63,T.baseLength=16,T.validationPattern=new RegExp("^["+C+"]{"+T.baseLength.toString()+"}(.[0-9]+)+$"),h={},h.maxCorrelationVectorLength=127,h.baseLength=22,h.validationPattern=new RegExp("^["+C+"]{"+h.baseLength.toString()+"}(.[0-9]+)+$"),w=h,y=2,{header:"MS-CV",tag:"cV",isInit:e,canExtend:i,canIncrement:r,getValue:n,setValue:o,init:s,extend:u,increment:l,incrementExternal:a,isValid:d,useCv1:f,useCv2:v}}(),awa.logger=function(){function e(e){awa.consoleVerbosity>=awa.verbosityLevels.ERROR&&console&&console.error&&console.error("JSLL: "+e)}function t(e){awa.consoleVerbosity>=awa.verbosityLevels.WARNING&&console&&console.warn&&console.warn("JSLL: "+e)}function n(e){awa.consoleVerbosity>=awa.verbosityLevels.INFORMATION&&console&&console.log&&console.log("JSLL: "+e)}return{logError:e,logWarning:t,logInformation:n}}(),awa.capabilitiesCheck=function(){return function(){if(!JSON||!JSON.stringify)return awa.logger.logError("Unable to write event: the global JSON.stringify method does not exist"),awa.isAvailable=!1,!1}}(),awa.utils=function(){function e(e,n){var a,i,r;if(n)try{return"{}"===(a=JSON.stringify(n))&&"timing"===e?t():a}catch(t){return i='{"error": "ERROR: could not stringify {0} {1}"}',r="string"==typeof n?n:"",i.replace("{0}",e).replace("{1}",r)}}function t(){for(var e,t=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"],n="{",a=0;a<t.length;a++)e=O[t[a]],S(e)&&(n+='"'+t[a]+'":'+e,a<t.length-1&&(n+=","));return n+"}"}function n(e){return{"microsoft.com":"c1.microsoft.com","xbox.com":"c.xbox.com","live.com":"c.live.com","microsoftstore.com":"c.microsoftstore.com","msn.com":"c.msn.com","windows.com":"c.windows.com"}[e]}function a(e,t){if("string"===e)return"string"==typeof t||t instanceof String||t instanceof Date;if("bool"===e)return"boolean"==typeof t||t instanceof Boolean;if(!("number"==typeof t||t instanceof Number))return!1;if("uint8"===e){if(t<0||t>255||t%1!=0)return!1}else if("uint16"===e){if(t<0||t>65535||t%1!=0)return!1}else if("uint32"===e){if(t<0||t>4294967295||t%1!=0)return!1}else if("uint64"===e){if(t<0||t>0x10000000000000000||t%1!=0)return!1}else if("int8"===e){if(t<-128||t>127||t%1!=0)return!1}else if("int16"===e){if(t<-32768||t>32767||t%1!=0)return!1}else if("int32"===e){if(t<-2147483648||t>2147483647||t%1!=0)return!1}else if("int64"===e){if(t<-0x8000000000000000||t>0x8000000000000000||t%1!=0)return!1}else if("float"===e){if(t<-3.402823e38||t>3.402823e38)return!1}else if("double"===e&&(t<-Number.MAX_VALUE||t>Number.MAX_VALUE))return!1;return!0}function i(){if(""===A){var e=o().toLowerCase();A=-1!==e.indexOf("windows phone")?"WindowsPhone":-1!==e.indexOf("win")?"Windows":-1!==e.indexOf("mac")?"MacOS":-1!==e.indexOf("x11")?"Unix":-1!==e.indexOf("android")?"Android":-1!==e.indexOf("linux")?"Linux":-1!==e.indexOf("webos")?"webOS":-1!==e.indexOf("blackberry")?"BlackBerry":-1!==e.indexOf("ipod")||-1!==e.indexOf("ipad")||-1!==e.indexOf("iphone")?"iOS":-1!==e.indexOf("symbian")?"Symbian":-1!==e.indexOf("nokia")?"Nokia":"Unknown"}return A}function r(){N=window.navigator&&window.navigator.userAgent?window.navigator.userAgent:""}function o(){return""===N&&r(),N}function s(e,t){var n;return e&&e[t]&&(n=e[t],delete e[t]),n}function c(e,t){return e=l(e),u(e.getBoundingClientRect(),t)>0}function u(e,t){var n=e.left,a=e.top,i=e.right,r=e.bottom,o=t.left,s=t.top,c=t.right,u=t.bottom;return Math.max(0,Math.min(i,c)-Math.max(n,o))*Math.max(0,Math.min(r,u)-Math.max(a,s))}function l(e){return"function"==typeof jQuery&&e instanceof jQuery?e[0]:e}function d(e){var t=String(e);return 1===t.length&&(t="0"+t),t}function p(e){return e.getUTCFullYear()+"-"+d(e.getUTCMonth()+1)+"-"+d(e.getUTCDate())+"T"+d(e.getUTCHours())+":"+d(e.getUTCMinutes())+":"+d(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}function g(){var e;try{e=window.performance.getEntries().filter(function(e){return"script"===e.initiatorType||"link"===e.initiatorType})}catch(e){}return e}function m(){var e;return O.loadEventStart>0&&(e=O.loadEventStart-O.navigationStart),e}function f(){return document.title.substring(0,150)}function v(e){return"["+e+"]"}function h(e,t){return L=t,y(e,b)}function w(e){return y(e,E)}function y(e,t){var n=e;if(n){for(n=l(n);!t(n);)if(n=n.parentNode,!(n=l(n))||!n.getAttribute)return null;return n}}function b(e){var t=e.getAttribute(L);return S(t)||""===t}function E(e){return"A"===e.nodeName}function C(e){var t,n;return e&&(n=e.split(":"),t=n.length>1&&"js"===n[0].toLowerCase()?e:x+e),t}function T(e){for(var t in e)S(e[t])&&("{}"!==JSON.stringify(e[t])||"callback"===t)||delete e[t]}function S(e){return!(void 0===e||null===e||""===e)}function I(e,t){var n,a;T(e);for(n in t)a=t[n],"object"==typeof e[a]?T(e[a]):delete e[a]}var A="",N="",O=window.performance?window.performance.timing:void 0,x="JS:",L="",M=function(){var e,t,n={},a=!1,i=0,r=arguments.length;for("[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(a=arguments[0],i++),e=function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=a&&"[object Object]"===Object.prototype.toString.call(e[t])?M(!0,n[t],e[t]):e[t])};i<r;i++)t=arguments[i],e(t);return n};return{stringifyField:e,getMuidHost:n,isOfCorrectType:a,getOs:i,getUserAgent:o,extractFieldFromObject:s,isElementTrulyVisible:c,dateToISOString:p,extend:M,returnDomObjectIfjQuery:l,findClosestByAttribute:h,findClosestAnchor:w,getPerformanceData:g,getPageLoadTime:m,getTitle:f,removeInvalidElements:T,removeNonObjectsAndInvalidElements:I,bracketIt:v,getAppIdWithPrefix:C,isValueAssigned:S}}(),awa.ids=function(){function e(){function e(){return Math.floor(16*Math.random()).toString(16)}return"xxxxxxxx-xxxx-4xxx-Rxxx-xxxxxxxxxxxx".replace(/x/g,e).replace("R",(8|Math.floor(3*Math.random())).toString(16))}function t(){return f.getCookie("MS0")}function n(){return f.getCookie("MUID")}function a(){return m}function i(){return w?m=e():w=!0,m}function r(){return f.getCookie(y)}function o(){var e=f.getCookie("MUID");return e&&e.length?"t:"+e:e}function s(e){if(v=null,e){for(var t=0;t<b.length;t++)if(b[t]===e.substring(0,2)){v=e;break}v||awa.logger.logWarning("Unsupported app user id: "+e+". Supported app user ids are: c:, i:, and w:")}}function c(e){var t;if(!e||e.length<4)return!1;var n=!1,a=e.substring(0,3).toString().toUpperCase();for(t=0;t<E.length;t++)if(E[t]+":"===a&&e.length<=256){n=!0;break}return n}function u(e){var t,n;if(!e)return void(h=null);if(e!==h)for(h=null,t=e.split(","),n=0;n<t.length;n++)c(t[n])?h?h+=","+t[n]:h=t[n]:awa.logger.logWarning("Unsupported flight id format for this app expId: "+t[n])}function l(){return h}function d(e){e&&(g=e)}function p(){return g}var g,m=e(),f=awa.cookie,v=null,h=null,w=!1,y="Treatments",b=["c:","i:","w:"],E=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"];return{getSessionId:t,getVisitorId:n,getMuidUserId:o,setAppUserId:s,getAppUserId:function(){return v},readExpIdFromCookie:function(){return u(r()),l()},readExpIdFromCoreData:function(e){return u(e),l()},getImpressionGuid:a,getPageViewImpressionGuid:i,getGroups:r,setDeviceClass:d,getDeviceClass:p,setExpIdCookieName:function(e){y=e},getExpIdCookieName:function(){return y}}}(),awa.vortexEvents=function(){function e(){s.length>0&&(awa.writeEvent(s),s=[])}function t(){for(;s.length>0;)awa.writeEvent(s.pop())}function n(n,a){if(!0===a)return void awa.writeEvent(n);if(c){if("complete"===c)return void awa.writeEvent(n)}else if("complete"===document.readyState)return void awa.writeEvent(n);(0===s.length||0===u)&&(window.addEventListener?window.addEventListener("load",t):window.attachEvent&&window.attachEvent("onload",t)),s.push(n),u>1&&s.length>=u&&e()}function a(e){var t={};"CorsDisallowed"===e.type?t={name:"Ms.Cll.Javascript.CorsDisallowed",data:{"Ms.Cll.Javascript.CorsDisallowed":{eventName:e.eventName}}}:"EventTooLong"===e.type&&(t={name:"Ms.Cll.Javascript.EventTooLong",data:{"Ms.Cll.Javascript.EventTooLong":{eventName:e.eventName,payloadLength:e.payloadLength}}}),n(t)}function i(e,t){n({name:"Ms.Webi.ClientError",data:{"Ms.Webi.ClientError":{errorInfo:JSON.stringify(e),wasDisplayed:t||!1,customSessionGuid:o.getSessionId(),impressionGuid:o.getImpressionGuid()}}})}function r(e){n({name:"Ms.Webi.OutgoingRequest",cV:e.cV,data:{"Ms.Qos.OutgoingServiceRequest":{operationName:e.currentOperationName,targetUri:e.requestUri,latencyMs:e.latencyMs,serviceErrorCode:e.serviceErrorCode||-1,succeeded:e.isSuccess,requestMethod:e.httpMethod,responseContentType:e.contentType,protocolStatusCode:e.httpStatusCode,dependencyOperationName:e.operationName,dependencyOperationVersion:e.operationVersion,dependencyName:e.serviceName,dependencyType:e.serviceType||"WebService",responseSizeBytes:e.responseSize},"Ms.Webi.OutgoingRequest":{customSessionGuid:o.getSessionId(),impressionGuid:o.getImpressionGuid(),message:e.errorMessage,retryCount:e.retryCount,customData:e.customData}}})}var o=awa.ids,s=[],c=null,u=0;return{sendError:i,sendApiComplete:r,sendJsllEvent:a,SendOrScheduleEvent:n,batchQueuedEvents:e,drainQueuedEvents:t,batchEventsByNumber:function(e){u=e},overrideQueueBehavior:function(e){e&&e.domReadyState&&(c=e.domReadyState)}}}(),awa.errorHandler=function(){function e(e){var t=window.onerror;window.onerror=function(){t&&t.apply(this,arguments),e.apply(this,arguments)}}function t(e){return e.stack?e.stack.substring(0,1e3):""}function n(){if(arguments){var e={Page:window.location.href,Script:arguments[1]||"",Message:arguments[0]||"",LineNumber:arguments[2]||0,StackTrace:arguments[4]?t(arguments[4]):"",UserAgent:awa.utils.getUserAgent()||"",Platform:window.navigator.platform||""};i.sendError(e,!1)}}function a(){e(n)}var i=awa.vortexEvents;return{init:a}}(),awa.timespanHandler=function(){function e(e,n){var a=(new Date).getTime();if(n)return a-t[e];t[e]=a}var t={};return{recordTimeSpan:e}}(),function(){function e(e,n){var a=new Image;a.onload=function(){1===a.width&&A(e)},a.onerror=function(){awa.logger.logWarning("Telemetry image beacon not sent properly. Sending through POST."),t(n)},a.src=e}function t(e){var t,n,a,i,r;for(y="",t=0;t<e.length;t++)t>0&&(y+="\n"),y+=JSON.stringify(e[t]);n="",awa.OnSuccessfulVortexRequest&&(n=d.endpoint+"/t.req?"+y),a="",u.isValueAssigned(e[0].ext.javascript.msfpc)&&(a="?ext-javascript-msfpc='"+encodeURIComponent(e[0].ext.javascript.msfpc)+"'",n+=a),"xhr"===C?(i=new XMLHttpRequest,i.open("POST",encodeURI(d.endpoint+a),!0),i.withCredentials=!0,i.onload=function(){200===i.status?A(n):I(i.statusText,i.status)},i.onerror=function(){I(i.statusText,i.status)},i.send(y)):"XDomainRequest"===C?(r=new window.XDomainRequest,r.onload=function(){A(n)},r.onerror=function(){N(r)},r.open("POST",d.endpoint),r.send(y)):awa.logger.logError("No event is sent.")}function n(e){var n,a;for(y="",n=0;n<e.length;n++)n>0&&(y+="\n"),y+=JSON.stringify(e[n]);a="",awa.OnSuccessfulVortexRequest&&(a=d.endpoint+"/t.bcn?"+y),navigator.sendBeacon(d.endpoint,y)?A(a):t(e)}function a(e,t){var n=document.head||document.getElementsByTagName("head")[0]||document.documentElement,a=document.createElement("script");t||(a.onload=function(){A(e)}),a.async=!0,a.src=e,n.appendChild(a)}function i(){return d.callback&&"function"==typeof d.callback.signedinStatus?d.callback.signedinStatus():d.isLoggedIn}var r,o,s,c;awa._schemas=awa._schemas||[];var u=awa.utils,l=u.isValueAssigned,d={endpoint:"https://web.vortex.data.microsoft.com/collect/v1",sendMode:1,batchSize:10,authMethod:0,logLevel:awa.verbosityLevels.NONE,syncMuid:!0,provisionMsfpc:!0,useDefaultContentName:!0,useShortNameForContentBlob:!1,debounceMs:{scroll:600,resize:3e3},muidDomain:"microsoft.com",biBlobAttributeTag:"data-m",isLoggedIn:!1,shareAuthStatus:!1,cookiesToCollect:["MSFPC","ANON"],useBeacon:!0,autoCapture:{pageView:!0,onLoad:!0,onUnload:!0,click:!0,scroll:!1,resize:!1,jsError:!0,addin:!0,perf:!0,assets:!1,lineage:!1},callback:{pageName:null,pageActionPageTags:null,pageViewPageTags:null,contentUpdatePageTags:null,pageActionContentTags:null,signedinStatus:null},coreData:{referrerUri:document.referrer,requestUri:"",appId:window.location.hostname,pageName:"",pageType:"",env:"",product:"",market:"",serverImpressionGuid:"",expId:"",pageTags:{}}},p=[];for(r in d)"object"==typeof d[r]&&p.push(r);var g="4.1.0",m=function(){var e=u.getUserAgent(),t=e.indexOf("MSIE ");return t>0&&parseInt(e.substring(t+5,e.indexOf(".",t)),10)<9}(),f=m?2083:15e3,v="",h=!1,w=0,y="",b=!1,E=l(navigator)&&l(navigator.sendBeacon);awa.experimentIdTag="expId",awa.isAvailable=!0,awa.getRequestBody=function(){return y},awa.getQueryStringParameters=function(){return v},Object.freeze&&Object.freeze(awa.verbosityLevels),awa.capabilitiesCheck();var C=window.XDomainRequest?"XDomainRequest":"xhr",T=function(){return"XDomainRequest"!==C||!d.endpoint||0===d.endpoint.indexOf(window.location.protocol)||(awa.logger.logError("Unable to write event: CORS requests are not supported cross-protocol in this browser"),!1)},S=function(){awa.vortexEvents.overrideQueueBehavior({domReadyState:"complete"}),awa.vortexEvents.drainQueuedEvents()},I=function(e,t){awa.logger.logError("Failure sending data to vortex: "+e+"Error: "+t.toString())},A=function(e){awa.OnSuccessfulVortexRequest&&awa.OnSuccessfulVortexRequest(e),1===d.sendMode&&!1===b&&(b=!0,S()),awa.logger.logInformation("Success sending data to vortex")},N=function(e){awa.logger.logError("Failure sending data to vortex using XDomainRequest.  Status code:"+e.status)},O=function(e,t,n){if(l(t)&&(n||0!==t.length)){var a=n?"":"'";v.length>0&&(v+="&"),v+=e+"="+a+encodeURIComponent(t.toString())+a}},x=function(e,t,n,a){for(var i,r,o,s,c,d,p,g,m,f,v="C"===a?"*":"-",h=t.fields,w=0;w<h.length;w++)if(i=h[w],r=n[i.name],l(r))if(O(v+i.name,r,"string"!==i.type),"map"===i.type){o={};for(s in r){if(!u.isOfCorrectType(i.key,s))return awa.logger.logError("A key in the map was of the wrong type: "+i.name),!1;if(!u.isOfCorrectType(i.element,r[s]))return awa.logger.logError("A value in the map was of the wrong type: "+i.name),!1;o[s]=r[s]}e[i.name]=o}else if("list"===i.type||"set"===i.type){if(c=[],"[object Array]"!==Object.prototype.toString.call(r))return awa.logger.logError("The "+i.type+" "+i.name+" was not an array as expected"),!1;for(d=0;d<r.length;d++){if(l(r[d])&&!u.isOfCorrectType(i.element,r[d]))return awa.logger.logError("The list contains a value of the wrong type: "+i.name),!1;c[d]=r[d]}e[i.name]=c}else if("struct"===i.type){if(p={},!x(p,i.def,r,a))return!1;e[i.name]=p}else{if(!u.isOfCorrectType(i.type,r))return awa.logger.logError("Property is the wrong type: "+i.name),!1;e[i.name]=r}else if(i.req)return awa.logger.logError("Missing required property: "+i.name),!1;for(g in n){for(m=!1,f=0;f<h.length;f++)if(h[f].name===g){m=!0;break}m||awa.logger.logWarning("An unexpected field was found in  the event content and dropped: "+g)}return!0};for(awa.init=function(e){if(!awa.isInitialized){awa.isInitialized=!0,e&&(u.removeNonObjectsAndInvalidElements(e,p),d=u.extend(!0,d,e));var t=d.sendMode;0==t&&!1===d.provisionMsfpc&&(b=!0),(t>=1||!0===d.provisionMsfpc)&&awa.vortexEvents.overrideQueueBehavior({domReadyState:"notComplete"}),2===t&&awa.vortexEvents.batchEventsByNumber(d.batchSize),awa.consoleVerbosity=d.logLevel,awa.ct.initialize(d)}},awa.writeEvent=function(r){var o,s,c,u,l,p,g,m=!0,w=[];if("[object Array]"===Object.prototype.toString.call(r))for(m=!1,o=0;o<r.length;o++)s=awa._validateAndTranslateEvent(r[o]),s.success&&w.push(s.event);else c=awa._validateAndTranslateEvent(r),c.success&&w.push(c.event);if(0!==w.length){if(m&&v&&(u=d.endpoint.length+v.length)+7>f&&(awa.logger.logWarning("event is too large to send using get -- using post instead"),l={},l.eventName=r.name,l.payloadLength=u,l.type="EventTooLong",awa.vortexEvents.sendJsllEvent(l),m=!1),!m&&!T())return l={},l.eventName=r.name,l.type="CorsDisallowed",void awa.vortexEvents.sendJsllEvent(l);m&&v?!1===b?(p="/t.js",g=!1,!0===d.shareAuthStatus&&!0===i()&&-1===document.cookie.toLowerCase().indexOf("bounced=")&&!1===h&&(p=1===d.authMethod?"/asm.js":2===d.authMethod?"/asa.js":p,g=!0),a(d.endpoint+p+"?"+v,g)):E&&!0===d.useBeacon&&!1===d.shareAuthStatus?n(w):(p=!0===d.shareAuthStatus&&!0===i()?1===d.authMethod?"/asm.gif":2===d.authMethod?"/asa.gif":p:"/t.gif",e(d.endpoint+p+"?"+v,w)):E&&!0===d.useBeacon&&!0===b&&!1===d.shareAuthStatus?n(w):t(w)}},awa.sendEventThroughIframe=function(e){var t,n=document.createElement("iframe");n.id="telframe",n.style.display="none",t=function(e){++w>1&&A(e)},n.attachEvent?n.attachEvent("onreadystatechange",function(){"interactive"==n.readyState&&t(e)}):n.onload=function(){t(e)},n.src=e,h=!0,document.body.appendChild(n)},awa._validateAndTranslateEvent=function(e){function t(e,t,n){b[e]=t,O(e,t,n)}var n,a,i,r,o,s,c,p,m,f,h,w,y,b={},E={},C={},T={event:b,success:!1};if(v="",!e)return awa.logger.logError("Unable to write null event"),T;if(!e.name)return awa.logger.logError("Unable to write event with missing name"),T;if(!awa._schemas.hasOwnProperty(e.name))return awa.logger.logError("Unable to write event: a schema for the event named {"+e.name+"} does not exist"),T;if(!e.data)return awa.logger.logError("Unable to write event: the event is missing content"),T;t("ver","2.1"),t("name",e.name),t("time",u.dateToISOString(new Date)),t("os",u.getOs()),t("deviceClass",awa.ids.getDeviceClass()),n=e.appId?e.appId:d.coreData.appId,t("appId",u.getAppIdWithPrefix(n)),"true"===e.isSensitive&&t("flags",524288,!0),a=awa._schemas[e.name];for(i in a)if("name"!==i){if(r=a[i],!e.data.hasOwnProperty(i))return awa.logger.logError("Unable to write event: missing expected part: "+i),T;if("C"===r.part?o=C:(o={},C.baseData=o,C.baseType=i,O("*baseType",i)),!x(o,r.def,e.data[i],r.part))return T}for(s in e.data)a[s]&&a[s].part||awa.logger.logWarning("An unexpected property was found in the event content and dropped: "+s);b.data=C,b.tags={},e.hasOwnProperty(awa.cv.tag)?t(awa.cv.tag,e.cV):awa.cv.isInit()&&t(awa.cv.tag,awa.cv.getValue());var S={},I=e.env,A=l(I)?I:d.coreData.env;return l(A)&&(S.env=A,E.app=S,O("ext-app-env",A)),c=d&&d.coreData&&d.coreData.expId?awa.ids.readExpIdFromCoreData(d.coreData.expId):awa.ids.readExpIdFromCookie(),c&&(u.isOfCorrectType("string",c)?(S[awa.experimentIdTag]=c,E.app=S,O("ext-app-"+awa.experimentIdTag,c)):awa.logger.logError("The supplied experiment id is invalid: "+e[awa.experimentIdTag]+"Continuing to process event without this value.")),p=awa.ids.getAppUserId(),p&&(u.isOfCorrectType("string",p)?(S={},S.userId=p,E.app=S,O("ext-app-userId",p)):awa.logger.logError("ignoring the app userId value because it is invalid: "+p)),m={},f=window.location.hostname,l(f)||(f="file:"===window.location.protocol?"local":f),m.ver="1.1",m.libVer=g,m.domain=f,E.javascript=m,O("ext-javascript-ver","1.1"),O("ext-javascript-libVer",g),O("ext-javascript-domain",f),h=awa.cookie.getCookie("MSFPC"),u.isValueAssigned(h)&&(m.msfpc=h,O("ext-javascript-msfpc",h)),w=awa.ids.getMuidUserId(),w&&(u.isOfCorrectType("string",w)?(y={},y.localId=w,E.user=y,O("ext-user-localId",w)):awa.logger.logError("ignoring the userid value because it is invalid: "+w)),b.ext=E,T.success=!0,T},awa._registerSchemas=function(e){for(var t=0;t<e.length;t++)awa._schemas[e[t].name]=e[t]},awa.console=window.console||{},awa.console.fallback=awa.console.log||function(){},o=["log","info","warn","error","trace"],s=0;s<o.length;s++)c=o[s],awa.console[c]||(awa.console[c]=awa.console.fallback);awa.extendCoreData=function(e){u.removeInvalidElements(e),d.coreData=u.extend(!0,d.coreData,e)}}(),awa._registerSchemas([{name:"Ms.Cll.Javascript.CorsDisallowed","Ms.Cll.Javascript.CorsDisallowed":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"}]}}},{name:"Ms.Cll.Javascript.EventTooLong","Ms.Cll.Javascript.EventTooLong":{part:"C",def:{fields:[{req:!0,name:"eventName",type:"string"},{req:!0,name:"payloadLength",type:"int32"}]}}},{name:"Ms.Cll.Javascript.Error","Ms.Telemetry.Error":{part:"B",def:{fields:[{name:"errorName",type:"string"},{name:"errorMessage",type:"string"},{name:"severity",type:"int32"},{name:"errorType",type:"string"},{name:"errorCode",type:"int32"},{name:"lineNumber",type:"uint32"},{name:"isDisplayed",type:"bool"},{name:"errorLocation",type:"string"},{name:"errorMethod",type:"string"}]}},"Ms.Cll.Javascript.Error":{part:"C",def:{fields:[{req:!0,name:"code",type:"int32"},{req:!0,name:"message",type:"string"}]}}},{name:"Ms.Webi.ClientError","Ms.Webi.ClientError":{part:"B",def:{fields:[{req:!0,name:"errorInfo",type:"string"},{name:"wasDisplayed",type:"bool"},{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"serverImpressionGuid",type:"string"},{name:"errorName",type:"string"},{name:"errorMessage",type:"string"},{name:"severity",type:"int32"},{name:"errorType",type:"string"},{name:"errorCode",type:"int32"},{name:"lineNumber",type:"uint32"},{name:"isDisplayed",type:"bool"},{name:"errorLocation",type:"string"},{name:"errorMethod",type:"string"}]}}},{name:"Ms.Webi.OutgoingRequest","Ms.Qos.OutgoingServiceRequest":{part:"B",def:{fields:[{req:!0,name:"operationName",type:"string"},{name:"targetUri",type:"string"},{req:!0,name:"latencyMs",type:"int32"},{name:"serviceErrorCode",type:"int32"},{req:!0,name:"succeeded",type:"bool"},{name:"requestMethod",type:"string"},{name:"responseContentType",type:"string"},{name:"protocol",
type:"string"},{name:"protocolStatusCode",type:"string"},{req:!0,name:"dependencyOperationName",type:"string"},{name:"dependencyOperationVersion",type:"string"},{req:!0,name:"dependencyName",type:"string"},{name:"dependencyType",type:"string"},{name:"responseSizeBytes",type:"int32"},{name:"requestStatus",type:"int32"}]}},"Ms.Webi.OutgoingRequest":{part:"C",def:{fields:[{name:"customSessionGuid",type:"string"},{name:"impressionGuid",type:"string"},{name:"message",type:"string"},{name:"retryCount",type:"int32"},{name:"customData",type:"string"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.PageView","Ms.Content.PageView":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"referrerUri",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"resHeight",type:"int32"},{name:"resWidth",type:"int32"},{name:"vpHeight",type:"int32"},{name:"vpWidth",type:"int32"},{name:"market",type:"string"}]}},"Ms.Webi.PageView":{part:"C",def:{fields:[{name:"cookieEnabled",type:"bool"},{name:"flashInstalled",type:"bool"},{name:"flashVersion",type:"string"},{name:"cookies",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.ContentUpdate","Ms.Content.ContentUpdate":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"pageTags",type:"string"},{name:"pageHeight",type:"int32"},{name:"vpHeight",type:"int32"},{name:"vpWidth",type:"int32"},{name:"market",type:"string"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"vScrollOffset",type:"int32"},{name:"hScrollOffset",type:"int32"},{name:"contentVer",type:"string"},{req:!0,name:"content",type:"string"}]}},"Ms.Webi.ContentUpdate":{part:"C",def:{fields:[{name:"pageLoadTime",type:"int32"},{name:"title",type:"string"},{name:"isJs",type:"bool"},{name:"cookieEnabled",type:"bool"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"isDomComplete",type:"bool"},{name:"serverImpressionGuid",type:"string"},{name:"timings",type:"string"}]}}},{name:"Ms.Webi.PageAction","Ms.Content.PageAction":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"},{name:"destUri",type:"string"},{name:"market",type:"string"},{name:"pageType",type:"string"},{name:"pageTags",type:"string"},{name:"product",type:"string"},{name:"screenState",type:"int32"},{name:"actionType",type:"string"},{name:"behavior",type:"int32"},{name:"contentVer",type:"string"},{name:"content",type:"string"}]}},"Ms.Webi.PageAction":{part:"C",def:{fields:[{name:"timeToAction",type:"int32"},{name:"cookieEnabled",type:"bool"},{name:"cookies",type:"string"},{name:"isJs",type:"bool"},{name:"title",type:"string"},{name:"referrerUri",type:"string"},{name:"isLoggedIn",type:"bool"},{name:"isManual",type:"bool"},{name:"serverImpressionGuid",type:"string"}]}}},{name:"Ms.Webi.PageUnload","Ms.Content.PageUnload":{part:"B",def:{fields:[{name:"ver",type:"string"},{req:!0,name:"impressionGuid",type:"string"},{req:!0,name:"pageName",type:"string"},{name:"uri",type:"string"}]}},"Ms.Webi.PageUnload":{part:"C",def:{fields:[{name:"dwellTime",type:"int32"},{name:"scrollDepth",type:"string"},{name:"serverImpressionGuid",type:"string"}]}}}]),awa.ct=function(){function e(e){var n,a,i,r;awa.isAvailable&&(K=e,Y=K.autoCapture,se=!0===K.useShortNameForContentBlob?oe.shortNames:oe.longNames,Y.pageView&&(!0===K.isLoggedIn&&!0===K.shareAuthStatus?t(function(){awa.ct.capturePageView({isAuto:!0})}):g({isAuto:!0})),Y.click&&(window.addEventListener?(n=-1!==navigator.appVersion.indexOf("MSIE")?"click":"mousedown",window.addEventListener(n,l,!1),window.addEventListener("keyup",l,!1)):document.attachEvent&&(document.attachEvent("onclick",l),document.attachEvent("keyup",l))),Y.jsError&&X.init(),Y.scroll&&(a=p(null,function(){f({isAuto:!0,actionType:awa.actionType.SCROLL})},K.debounceMs.scroll),window.addEventListener?window.addEventListener("scroll",a):window.attachEvent&&window.attachEvent("onscroll",a)),Y.resize&&(i=p(function(){f({isAuto:!0,actionType:awa.actionType.RESIZE})},null,K.debounceMs.resize),window.addEventListener?window.addEventListener("resize",i):window.attachEvent&&window.attachEvent("onresize",i)),Y.onUnload&&(r=function(){var e=B();ae.v=ae.v>e.v?ae.v:e.v},window.addEventListener?window.addEventListener("scroll",r):window.attachEvent&&window.attachEvent("onscroll",r),awa.timespanHandler.recordTimeSpan("dwellTime",!1),window.addEventListener?(window.addEventListener("beforeunload",y),window.addEventListener("unload",y)):window.attachEvent&&(window.attachEvent("onbeforeunload",y),window.attachEvent("onunload",y))),t(awa.ct.domReadyTasksWrapper))}function t(e){/in/.test(document.readyState)?setTimeout("awa.ct.onDomReadyDo("+e+")",9):e.call()}function n(){K.syncMuid&&r(),Y.onLoad&&("complete"===document.readyState?m():window.addEventListener?window.addEventListener("load",m):window.attachEvent&&window.attachEvent("onload",m))}function a(){awa.ct.domReadyTasks()}function i(){if(K.callback&&"function"==typeof K.callback.pageName)return K.callback.pageName();if(K.coreData.pageName)return K.coreData.pageName;var e=window.location.pathname,t=e.split("/");return t.length>2&&""!==t[2]?t[2]:"Home"}function r(){var e,t,n=te.getMuidHost(K.muidDomain||"microsoft.com");n?(e=(window.location.protocol||"http:")+"//"+n+"/c.gif?DI=4050&did=1&t=",t=document.createElement("IMG"),t.style.display="none",t.src=e,t.hidden="",t["aria-hidden"]="true",t.role="presentation"):awa.logger.logWarning("Unable to get a muid host for the configured muidDomain '"+K.muidDomain+"'.  Unable to sync muid")}function o(e){return"which"in e?3===e.which:"button"in e?2===e.button:void 0}function s(e){return"which"in e?1===e.which:"button"in e?1===e.button:void 0}function c(e){if("keyCode"in e)return 13===e.keyCode}function u(e){if("keyCode"in e)return 32===e.keyCode}function l(e){var t,n={A:!0,BUTTON:!0,AREA:!0,INPUT:!0},a=e||window.event,i=a.srcElement||a.target,r={isAuto:!0};if(o(a))r.behavior=awa.behavior.CONTEXTMENU,r.actionType=ne.CLICKRIGHT;else if(s(a))r.actionType=ne.CLICKLEFT;else if(c(a))r.actionType=ne.KEYBOARDENTER;else{if(!u(a))return;r.actionType=ne.KEYBOARDSPACE}for(;i&&i.tagName;){if(n[i.tagName.toUpperCase()]){t="INPUT"!==i.tagName.toUpperCase()||ce[i.type.toUpperCase()],t&&(d(i)||w(i,r));break}i=i.parentElement||i.parentNode;continue}}function d(e){var t=te.findClosestByAttribute(e,ie);return!!te.isValueAssigned(t)}function p(e,t,n){var a;return function(){var i=this,r=arguments,o=function(){a=null,t&&t.apply(i,r)},s=!a;clearTimeout(a),a=setTimeout(o,n),s&&e&&e.apply(i,r)}}function g(e){var t,n={},a=awa.utils.extend(!0,K.coreData.pageTags);a.metaTags=R(n),D(a),"function"==typeof K.callback.pageViewPageTags&&(a=te.extend(!0,a,K.callback.pageViewPageTags()));var r=V(),o={name:"Ms.Webi.PageView",data:{"Ms.Content.PageView":{ver:J,impressionGuid:Z.getPageViewImpressionGuid(),pageName:i(),uri:j(),referrerUri:K.coreData.referrerUri,resHeight:r.h,resWidth:r.w,market:n.market,pageType:n.pageType,pageTags:a,product:n.product,behavior:n.behavior?n.behavior:awa.behavior.UNDEFINED},"Ms.Webi.PageView":{cookieEnabled:F(),cookies:x(),isJs:!0,title:te.getTitle(),isLoggedIn:K.isLoggedIn,isManual:!0,serverImpressionGuid:n.serverImpressionGuid}},isSensitive:n.isSensitive,env:n.env},s=o.data["Ms.Content.PageView"],c=o.data["Ms.Webi.PageView"];Y.addin&&(t=k(),c.flashInstalled=t.installed||!1,c.flashVersion=t.version||""),e&&(b(o,s,c,e),e.pageTags&&(s.pageTags=te.extend(!0,a,e.pageTags))),s.pageTags=te.stringifyField("pageTags",s.pageTags),ee.SendOrScheduleEvent(o,!0)}function m(){f({isAuto:!0,isDomComplete:!0})}function f(e){var t,n={},a=awa.utils.extend(!0,K.coreData.pageTags);a.metaTags=R(n),D(a),e&&e.isDomComplete&&!0===Y.perf&&window.performance&&(window.performance.timing&&(a.timing=te.stringifyField("timing",window.performance.timing)),!0===Y.assets&&(t=te.getPerformanceData())&&(a.AssetPerformance=te.stringifyField("AssetPerformance",t))),"function"==typeof K.callback.contentUpdatePageTags&&(a=te.extend(!0,a,K.callback.contentUpdatePageTags()));var r=$(),o=B(),s=C(r),c={name:"Ms.Webi.ContentUpdate",data:{"Ms.Content.ContentUpdate":{ver:J,impressionGuid:Z.getImpressionGuid(),pageName:i(),uri:j(),pageTags:a,pageHeight:document.body.scrollHeight,vpHeight:r.h,vpWidth:r.w,market:n.market,behavior:n.behavior?n.behavior:awa.behavior.UNDEFINED,vScrollOffset:o.v,hScrollOffset:o.h,contentVer:z,content:T(s)},"Ms.Webi.ContentUpdate":{title:te.getTitle(),cookieEnabled:F(),isJs:!0,isManual:!0,isDomComplete:!1,isLoggedIn:K.isLoggedIn,serverImpressionGuid:n.serverImpressionGuid}},isSensitive:n.isSensitive,env:n.env},u=c.data["Ms.Content.ContentUpdate"],l=c.data["Ms.Webi.ContentUpdate"];e&&(b(c,u,l,e),e.pageTags&&(u.pageTags=te.extend(!0,a,e.pageTags))),u.pageTags=te.stringifyField("pageTags",u.pageTags),ee.SendOrScheduleEvent(c,!1)}function v(e){w(null,e)}function h(e,t){w(e,t)}function w(e,t){var n={},a=awa.utils.extend(!0,K.coreData.pageTags),r={};e=te.returnDomObjectIfjQuery(e),e&&(n.targetUri=L(e),r=A(e,!0),r=te.extend(r,M(e)),r.bhvr&&G(n,te.extractFieldFromObject(r,"bhvr"))),a.metaTags=R(n),D(a),"function"==typeof K.callback.pageActionPageTags&&(a=te.extend(!0,a,K.callback.pageActionPageTags(e)));var o=K.callback.pageActionContentTags,s={name:"Ms.Webi.PageAction",data:{"Ms.Content.PageAction":{ver:J,impressionGuid:Z.getImpressionGuid(),pageName:i(),uri:j(),destUri:n.targetUri,market:n.market,pageType:n.pageType,pageTags:a,product:n.product,actionType:n.actionType,behavior:n.behavior,contentVer:z,content:te.bracketIt(JSON.stringify(awa.utils.extend(r,"function"==typeof o?o(e):{},t?t.contentTags:{})))},"Ms.Webi.PageAction":{timeToAction:E(),cookies:x(),cookieEnabled:F(),isJs:!0,title:te.getTitle(),referrerUri:K.coreData.referrerUri,isLoggedIn:K.isLoggedIn,isManual:!0,serverImpressionGuid:n.serverImpressionGuid}},isSensitive:n.isSensitive,env:n.env},c=s.data["Ms.Content.PageAction"],u=s.data["Ms.Webi.PageAction"];t&&(b(s,c,u,t),t.pageTags&&(c.pageTags=te.extend(!0,a,t.pageTags)),t.referrerUri&&(u.referrerUri=te.extractFieldFromObject(c,"referrerUri"))),c.pageTags=te.stringifyField("pageTags",c.pageTags),ee.SendOrScheduleEvent(s,!0)}function y(){var e,t;re||(re=!0,e={},R(e),t={name:"Ms.Webi.PageUnload",data:{"Ms.Content.PageUnload":{ver:J,impressionGuid:Z.getPageViewImpressionGuid(),pageName:i()},"Ms.Webi.PageUnload":{dwellTime:awa.timespanHandler.recordTimeSpan("dwellTime",!0),scrollDepth:ae.v.toString()+"/"+document.body.scrollHeight.toString()}},isSensitive:e.isSensitive,env:e.env},ee.SendOrScheduleEvent(t,!0))}function b(e,t,n,a){a.appId&&(e.appId=a.appId),a.behavior&&G(t,a.behavior),a.uri&&(t.uri=a.uri),a.referrerUri&&(t.referrerUri=a.referrerUri),a.pageName&&(t.pageName=a.pageName),a.actionType&&(t.actionType=a.actionType),a.pageHeight&&(t.pageHeight=a.pageHeight),a.content&&(t.content=te.bracketIt(JSON.stringify(a.content))),a.targetUri&&(t.destUri=a.targetUri),a.vScrollOffset&&(t.vScrollOffset=a.vScrollOffset),a.hScrollOffset&&(t.hScrollOffset=a.hScrollOffset),n.isManual=!0!==a.isAuto||void 0,a.isDomComplete&&(n.isDomComplete=a.isDomComplete,n.pageLoadTime=te.getPageLoadTime()),a.pageLoadTime&&(n.pageLoadTime=a.pageLoadTime),a.timings&&(n.timings=JSON.stringify(a.timings))}function E(){if(window.performance&&window.performance.timing){var e=window.performance.timing.domComplete;if(0!==e)return(new Date).getTime()-e}return-1}function C(e){return{top:0,bottom:e.h,left:0,right:e.w}}function T(e){var t=[];return S(document.querySelectorAll(te.bracketIt(se.areaName)+","+te.bracketIt(se.slotNumber)+","+te.bracketIt(K.biBlobAttributeTag)),t,e),JSON.stringify(t)}function S(e,t,n){var a,i,r;if(e)for(a=0;a<e.length;a++)i=e[a],d(i)||te.isElementTrulyVisible(i,n)&&(r=A(i,!1))&&t.push(r)}function I(e){for(var t,n,a,i,r,o,s,c=[],u=[],l=[],d=[],p=K.biBlobAttributeTag,g=(se.contentName,"data-module-id"),m=void 0;e;)n=e.getAttribute(p)||e[p],a=e.getAttribute(g)||e[g],n?(i=JSON.parse(n))&&(t=i.cN||i.cT,c.push(t),a&&(m=t),l.push(i.id||void 0),u.push(i.sN||-1),d.push(i.tags||{})):(t=e.getAttribute(se.contentName)||e.getAttribute(se.contentType),c.push(t),a&&(m=t),l.push(e.getAttribute(se.id)||void 0),u.push(e.getAttribute(se.slotNumber)||-1),d.push(e.getAttribute("data-bi-tags")||{})),e=e.parentElement;for(r={lineage:c.join(">"),lineageOrdinal:u.join(">"),lineageById:l.join(">"),containerName:m},o=!1,s=0;s<d.length;s++)o=o||te.isValueAssigned(d[s]);return o&&(r.lineageTags=d),r}function A(e,t){var n,a,i,r,o,s,c,u,l;if(!e)return"";if(n={},a=awa.utils.findClosestByAttribute(e,K.biBlobAttributeTag),a&&(i=a.getAttribute(K.biBlobAttributeTag)),i)n=JSON.parse(i);else for(r=te.findClosestByAttribute(e,te.bracketIt(se.id)),r=te.returnDomObjectIfjQuery(e),o=te.findClosestByAttribute(e,se.areaName),s=awa.utils.extend({},O(o)),n={id:r.getAttribute(se.id)||e.id||"",aN:s.areaName,sN:r.getAttribute(se.slotNumber),cN:r.getAttribute(se.contentName)||N(e)||r.getAttribute("alt")||"",cS:r.getAttribute(se.contentSource)||s.contentSource,tN:s.templateName,pid:r.getAttribute(se.productId),cT:r.getAttribute(se.contentType)||s.type},n.id&&n.aN&&n.sN&&n.cN||awa.logger.logWarning("Invalid content blob.  Missing required attributes (id, aN/area, sN/slot), cN/contentName.  Content information will still be collected!"),se.isShortNames||(n={contentId:n.id,areaName:n.aN,slotNumber:n.sN,contentName:n.cN,contentSource:n.cS,templateName:n.tN,productId:n.pid,contentType:n.cT}),c=0;c<r.attributes.length;c++)u=r.attributes[c],u.name!==se.id&&u.name!==se.areaName&&u.name!==se.slotNumber&&u.name!==se.contentName&&u.name!==se.contentSource&&u.name!==se.templateName&&u.name!==se.productId&&u.name!==se.contentType&&-1!==u.name.indexOf("data-bi-")&&(l=u.name.replace("data-bi-",""),n[l]=u.value);return awa.utils.removeInvalidElements(n),K.autoCapture.lineage&&t&&(n=awa.utils.extend(n,I(e))),n}function N(e){if(!1===K.useDefaultContentName||q(e)||!e.tagName)return"";var t;switch(e.tagName){case"A":t=document.all?e.innerText||e.innerHTML:e.text||e.innerHTML;case"IMG":case"AREA":t=e.alt;default:t=e.value||e.name||e.alt||e.innerText||e.id}return t.substring(0,_)}function O(e){return e=te.returnDomObjectIfjQuery(e),e?{areaName:e.getAttribute(se.areaName),templateName:e.getAttribute(se.templateName),contentSource:e.getAttribute(se.contentSource),product:e.getAttribute(se.productId),type:e.getAttribute(se.contentType)}:void 0}function x(){var e,t,n,a="",i={},r=[],o=K.cookiesToCollect;if(!1===K.shareAuthStatus)r=o;else for(e=0;e<o.length;e++)"ANON"!==o[e]&&r.push(o[e]);try{try{window.varCustomerCookies&&window.varCustomerCookies.length>0&&(r=r.concat(window.varCustomerCookies))}catch(e){}for(t in r)i.hasOwnProperty(r[t])||(i[r[t]]="",""!==(n=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(r[t]).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1")))&&(a+=r[t]+"="+n+";"))}catch(e){}return a}function L(e){var t,n="";switch(e.tagName){case"A":case"AREA":n=e.href||"";break;case"IMG":n=W(e);break;case"INPUT":t=e.type,window.event,t&&ce[t.toUpperCase()]&&(n=e.form?e.form.action||window.location.pathname:window.location.pathname)}return n}function M(e){for(var t,n,a={};e;)if(!q(e)){for(t in e.attributes)t&&e.attributes[t]&&(n=e.attributes[t].name)&&0===n.toLowerCase().indexOf("ms.")&&(a[n]=e.attributes[t].value);e=e.parentElement||e.parentNode}return a}function k(){var e,t,n,a={};if(navigator.plugins["Shockwave Flash"])a.installed=!0,e=navigator.plugins["Shockwave Flash"],a.version=e.description.split(" ")[2];else if(-1!==navigator.userAgent.indexOf("MSIE"))for(t=(new Date).getFullYear()-1992,n=t;n>0;n--)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+n),a.installed=!0,a.version=n+".0";break}catch(e){}return a}function D(e){if(!e.enabledFeatures){var t=Q.getCookie("Features");t&&(e.enabledFeatures=t)}}function R(e){var t={},n={};return t=P("awa-",!0),e.env=U(t,K.coreData,"env"),e.pageType=U(t,K.coreData,"pageType"),e.product=U(t,K.coreData,"product"),e.market=U(t,K.coreData,"market"),e.serverImpressionGuid=U(t,K.coreData,"serverImpressionGuid"),e.isSensitive=U(t,K.coreData,"isSensitive"),n=P("ms.",!1),te.extend(!0,t,n)}function U(e,t,n){var a=te.extractFieldFromObject(e,n);return t[n]?t[n]:a}function P(e,t){for(var n,a,i,r={},o=document.querySelectorAll("meta"),s=0;s<o.length;s++)n=o[s],n.name&&(a=n.name.toLowerCase(),0===a.indexOf(e)&&(i=t?n.name.replace(e,""):n.name,r[i]=n.content));return r}function V(){var e={h:0,w:0};return window.screen&&(e.h=screen.height,e.w=screen.width),e}function $(){var e={h:0,w:0};return window.screen&&(e.h=window.innerHeight||document.body.clientHeight||document.documentElement.clientHeight,e.w=window.innerWidth||document.body.clientWidth||document.documentElement.clientWidth),e}function B(){return{h:parseInt(document.body.scrollLeft||document.documentElement.scrollLeft||window.pageXOffset||0,10),v:parseInt(document.body.scrollTop||document.documentElement.scrollTop||window.pageYOffset||0,10)}}function F(){if(navigator.cookieEnabled)return navigator.cookieEnabled;var e="MC0",t=Q.getCookie(e);return t||(document.cookie=e+"=1",t=Q.getCookie(e)),!!t}function W(e){var t,n=e;if(n&&(t=te.findClosestAnchor(n),1===t.length)){if(t[0].href)return t[0].href;if(t[0].src)return t[0].src}return""}function q(e){if(!e||!e.attributes)return!1;try{var t=e.getAttribute("data-dc");return!!te.isValueAssigned(t)&&"pii"===t.toLowerCase()}catch(e){return!1}}function H(e){for(var t=0;t<awa.behaviorKeys.length;t++)if(awa.behavior[awa.behaviorKeys[t]]===e)return!0;return awa.logger.logWarning("Unsupported behavior: "+e+"."),!1}function G(e,t){var n,a=Number(t);te.isOfCorrectType("uint16",a)?H(a)&&(e.behavior=a):te.isOfCorrectType("string",t)&&(n=awa.behavior[t.toUpperCase()],te.isOfCorrectType("uint16",n)&&(e.behavior=n))}function j(){return""===K.coreData.requestUri?window.location.href:K.coreData.requestUri}var J="1.0",z="2.0",_=200,K={},Y={},Q=awa.cookie,X=awa.errorHandler,Z=awa.ids,ee=awa.vortexEvents,te=awa.utils,ne=awa.actionType,ae={h:0,v:0},ie="data-bi-dnt",re=!1,oe={longNames:{isShortNames:!1,id:"data-bi-id",areaName:"data-bi-area",slotNumber:"data-bi-slot",contentName:"data-bi-name",contentSource:"data-bi-source",templateName:"data-bi-view",productId:"data-bi-product",contentType:"data-bi-type"},shortNames:{isShortNames:!0,id:"data-bi-id",areaName:"data-bi-an",slotNumber:"data-bi-sn",contentName:"data-bi-cn",contentSource:"data-bi-cs",templateName:"data-bi-tn",productId:"data-bi-pid",contentType:"data-bi-ct"}},se=oe.longNames,ce={BUTTON:!0,CHECKBOX:!0,RADIO:!0,RESET:!0,SUBMIT:!0};return{initialize:e,capturePageView:g,captureContentUpdate:f,capturePageAction:h,captureContentPageAction:v,domReadyTasksWrapper:a,onDomReadyDo:t,domReadyTasks:n}}(),awa.service=function(){function e(e){"function"==typeof e?i=e:"string"==typeof e&&(i=function(){return e})}var t=awa.timespanHandler,n=!0,a=!1,i=null,r=function(e){var r,o;if("function"==typeof jQuery){n&&($.support.cors=!0);var s,c=e.additionalHeaders||{},u=e.body,l=u?JSON.stringify(u):e.data||void 0,d=e.maxRetry||0,p=0,g=$.noop,m=e.operationName||e.url,f=e.errorFormatter||function(e){return e},v=awa.ids,h={url:e.url,type:e.method,data:l,crossDomain:!0,headers:{},success:e.success,timeout:e.timeout,error:e.error,jsonp:e.jsonp,jsonpCallback:e.jsonpCallback,cache:e.cache,beforeSend:function(t){if(g(t),e.contractVersion&&t.setRequestHeader("MS-Contract-Version",e.contractVersion),(!awa.utils.isValueAssigned(e.addCvToRequestHeader)&&a||e.addCvToRequestHeader)&&awa.cv.isValid(s)&&t.setRequestHeader("MS-CV",s),c)for(var n in c)t.setRequestHeader(n,c[n])}};return e.dataType&&(h.dataType=e.dataType),e.noCacheBusting||(h.cache=!1),e.contentType&&(h.contentType=e.contentType),e.accept&&(h.headers.Accept=e.accept),e.accepts&&(h.accepts=e.accepts),e.async&&(h.async=e.async),e.xhrFields&&(h.xhrFields=e.xhrFields),e.complete&&(h.complete=e.complete),e.contents&&(h.contents=e.contents),e.context&&(h.context=e.context),e.dataFilter&&(h.dataFilter=e.dataFilter),e.global&&(h.global=e.global),e.ifModified&&(h.ifModified=e.ifModified),e.isLocal&&(h.isLocal=e.isLocal),e.mimeType&&(h.mimeType=e.mimeType),e.password&&(h.password=e.password),e.processData&&(h.processData=e.processData),e.scriptCharset&&(h.scriptCharset=e.scriptCharset),e.statusCode&&(h.statusCode=e.statusCode),e.traditional&&(h.traditional=e.traditional),e.type&&(h.type=e.type),e.username&&(h.username=e.username),e.xhr&&(h.xhr=e.xhr),s=awa.cv.isValid(e.cV)?e.cV:awa.cv.increment(),r=function(t,n,a){var r=t.getResponseHeader("Content-Length"),o={name:"Ms.Webi.OutgoingRequest",cV:s,data:{"Ms.Qos.OutgoingServiceRequest":{operationName:e.currentOperationName||window.location.href,targetUri:i?i(h.url):h.url,latencyMs:a,serviceErrorCode:!n&&t.responseJSON&&t.responseJSON.code&&!isNaN(t.responseJSON.code)?t.responseJSON.code:-1,succeeded:n,requestMethod:h.type,responseContentType:h.dataType,protocolStatusCode:t.status.toString(),dependencyOperationName:m,dependencyOperationVersion:e.version&&e.version.toString(),dependencyName:e.serviceName,dependencyType:"WebService",responseSizeBytes:r&&parseInt(r,10)},"Ms.Webi.OutgoingRequest":{customSessionGuid:v.getSessionId(),impressionGuid:v.getImpressionGuid(),message:n?void 0:awa.utils.stringifyField("errorMessage",t.errorThrown),retryCount:p,customData:e.customDataCallBack&&"function"==typeof e.customDataCallBack?awa.utils.stringifyField("customData",e.customDataCallBack(t)):void 0}}};e.QosCallback&&"function"==typeof e.QosCallback&&e.QosCallback(t,o),awa.vortexEvents.SendOrScheduleEvent(o)},o=function(){var n=m+"_Retry_"+p;return t.recordTimeSpan(n),$.ajax(h).then(function(e,a,i){var o=t.recordTimeSpan(n,!0);return r(i,!0,o),i},function(a,i){var c,u=t.recordTimeSpan(n,!0);return r(a,!1,u),c=$.Deferred(),d>p&&(0===a.status||a.status>=500&&a.status<600)?(p++,s=awa.cv.isValid(e.cV)?awa.cv.incrementExternal(s):awa.cv.increment(),setTimeout(function(){o().done(c.resolve).fail(c.reject)},50)):c.reject(a,i),c.promise()})},o().then(function(e,t,n){return n},function(t){return f(t,e)})}awa.logger.logError("jQuery is not defined, cannot use service module")};return{post:function(e){return r(awa.utils.extend({},e,{method:"POST"}))},get:function(e){return r(awa.utils.extend({maxRetry:1},e,{method:"GET"}))},put:function(e){return r(awa.utils.extend({},e,{method:"PUT"}))},del:function(e){return r(awa.utils.extend({},e,{method:"DELETE"}))},patch:function(e){return r(awa.utils.extend({},e,{method:"PATCH"}))},doNotChangeSupportCors:function(){n=!1},alwaysAddCvToRequestHeader:function(){a=!0},setTargetUriOverride:e}}();var UnauthAriaLogger={};UnauthAriaLogger.ariaLoggingContext={},UnauthAriaLogger.Initialize=function(e){if(UnauthAriaLogger.ariaLoggingContext=e,!UnauthAriaLogger.ariaLoggingContext.ariaToken)throw new Error("ARIA token is not defined");microsoft.applications.telemetry.LogManager.initialize(UnauthAriaLogger.ariaLoggingContext.ariaToken),UnauthAriaLogger.Logger=new microsoft.applications.telemetry.Logger},UnauthAriaLogger.LogEvent=function(e,t,n){if(UnauthAriaLogger.Logger){var a=new microsoft.applications.telemetry.EventProperties;if(a.name=e,t&&a.setProperty("ElementId",t),a.setProperty("SessionId",UnauthAriaLogger.ariaLoggingContext.sessionId),a.setProperty("DeploymentEnvironment",UnauthAriaLogger.ariaLoggingContext.deploymentEnvironment),a.setProperty("DevEnvironment",UnauthAriaLogger.ariaLoggingContext.devEnvironment),a.setProperty("Geo",UnauthAriaLogger.ariaLoggingContext.geoName),a.setProperty("Flights",UnauthAriaLogger.ariaLoggingContext.flights),a.setProperty("CorrelationId",UnauthAriaLogger.ariaLoggingContext.correlationId),a.setProperty("RequestOrigin",UnauthAriaLogger.ariaLoggingContext.requestOrigin),a.setProperty("ViewType",UnauthAriaLogger.ariaLoggingContext.viewType),a.setProperty("RefreshVersion",UnauthAriaLogger.ariaLoggingContext.refreshVersion),n)for(var i in n)n.hasOwnProperty(i)&&a.setProperty(i,n[i]);UnauthAriaLogger.Logger.logEvent(a)}};