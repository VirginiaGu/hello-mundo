window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.userhighlighting.js'] = (new Date()).getTime();
Type.registerNamespace("_uh");_uh.c=function(){};_uh.c.prototype={none:0,keyPoint:1,request:2,contentRequest:4,meeting:8};_uh.c.registerEnum("_uh.c",!0);_uh.b=function(n,t){this.b=n;this.d=t};_uh.b.e=function(n){var t=n.fv()?n.fv():n.fu();return t?JsonParser.deserialize(t)[0]:null};_uh.b.d=function(n){var i=n["@correlationTrail"];if(!_j.h.a(i)){var t=i.match(_uh.b.a);if(t&&t.length===2)return t[1]}return""};_uh.b.f=function(n,t,i){var r=_uh.b.b(i).toLowerCase();return(t&i)===i&&n===r};_uh.b.b=function(n){switch(n){case 1:return _uh.c.toString(1);case 2:return _uh.c.toString(2);case 4:return _uh.c.toString(4);case 8:return _uh.c.toString(8);default:return""}};_uh.b.prototype={b:null,d:0,a:null,c:null,e:function(){try{if(this.b.eM())for(var u=JsonParser.deserialize(this.b.eM())[0],f=u.types,t=f,r=t.length,n=0;n<r;++n){var i=t[n];if(this.f(i.toLowerCase()))return!0}}catch(e){_j.e.c(_a.a.bf,"Unable to parse AutoHighlightTypes")}return!1},i:function(){this.a=_uh.b.e(this.b);if(this.a){this.c=_uh.b.d(this.a);return this.a.sentences}return null},j:function(n){var f=!1;var e="";var o=new Array(0);var u=new Array(0);if(!n.removed){var s=n.segments;e=n.text;for(var r=s,c=r.length,t=0;t<c;++t){var h=r[t];var i=this.k(h,u);if(!_j.h.a(i)){Array.add(o,i);f=!0}}}return f?new _uh.s(e,u,o,this.c):null},h:function(n){for(var u=this.a.sentences,r=u,f=r.length,t=0;t<f;++t){var i=r[t];i.text===n&&(i.removed="true")}return this.a},dispose:function(){this.b=null},g:function(n,t){return Array.contains(n,_uh.b.b(t).toLowerCase())},f:function(n){for(var i=_uh.b.c,u=i.length,t=0;t<u;++t){var r=i[t];if(_uh.b.f(n,this.d,r))return!0}return!1},k:function(n,t){var r=n.segment.toLowerCase();if(this.f(r)){if(n.actions)for(var e=n.actions,u=e,o=u.length,i=0;i<o;++i){var f=u[i];Array.add(t,f)}return r}return""}};_uh.h=function(n,t,i,r,u,f,e){this.v=Function.createDelegate(this,this.H);this.o=Function.createDelegate(this,this.C);this.p=Function.createDelegate(this,this.D);_uh.h.initializeBase(this);this.n=n;this.b=t;this.q=i;this.m=r;this.s=u;this.u=e;this.r=!!this.b.bZ();var h=this.r?this.b.bZ().bD.Value:this.b.cd().bD.Value;if(r){r.a().cf().Enabled&&(this.g|=1);if(r.a().eh().Enabled){this.g|=2;this.g|=4}r.a().bz().Enabled&&(this.g|=4);r.a().bq().Enabled&&(this.g|=8)}var o,s;s=_a.A.a(h,o={val:this.l}),this.l=o.val,s;this.t=f;_j.h.a(this.l)||this.E()};_uh.h.prototype={b:null,l:null,d:null,h:null,j:null,e:null,q:null,n:null,s:null,r:!1,t:null,u:null,g:0,m:null,c:null,i:null,f:null,B:function(){this.j||(this.j=new _mco.z);return this.j},a:function(n){if(n){this.f=n;if(this.d&&this.d.x.length>0){this.y();this.G();this.K()}}},eW:function(){this.w("");this.f=null;this.h=null;this.n=null;this.q=null;this.s=null;this.n=null;this.t=null;this.i=null;if(this.e){this.e.U(this.p);this.e.m(this.o);this.e=null}_a.h.b(this.d);var t;_a.h.a(t={val:this.j}),this.j=t.val;var n;_a.h.a(n={val:this.c}),this.c=n.val},E:function(){if(this.b.eM()){this.c=new _uh.b(this.b,this.g);if(this.c.e()){this.x();this.a(this.f)}}else this.J()},x:function(){if(this.eX||!this.b.fu()){this.dispose();return}try{var s=this.m.a().bz().Enabled;var h=_uh.c.toString(4).toLowerCase();var r=this.c.i();if(r){this.d=new(_ff.w.$$(_uh.e));this.h=new Array(r.length);for(var t=0,u=r,c=u.length,i=0;i<c;++i){var o=u[i];var n=this.c.j(o);if(n){var e=this.c.g(n.b,8)?this.u:null;if(s&&n.b.length===1&&Array.contains(n.b,h)&&!n.c){t++;continue}var f=this.n.d(n,t,this.f,this.m,this.s,this.v,this.t,e,this.b.bD.InternetMessageId);this.L(n);this.d.a(f);Array.insert(this.h,t,n.e)}t++}}}catch(l){_j.e.c(_a.a.bf,"Unable to parse AutoHighlightData")}this.A()},J:function(){this.e=new _uh.k(this.b.bD.ItemId,this.m);this.e.b(this.p);this.e.a(this.o);this.q.a(this.e)},D:function(n){if(_uh.k.isInstanceOfType(n)&&this.b.eM()&&this.b.fu()){this.c=new _uh.b(this.b,this.g);if(this.c.e()){this.x();this.a(this.f)}}else this.dispose()},C:function(n){this.e.U(this.p);this.e.m(this.o)},A:function(){if(!this.h||!this.h.length){this.dispose();return}if(this.r&&!this.z()){this.w("SentencesNotInMessageBody");this.dispose();return}},z:function(){for(var i=!0,f=this.l.replace(_uh.h.a,""),r=this.h,e=r.length,n=0;n<e;++n){var t=r[n];if(!_j.h.a(t)){var u=t.replace(_uh.h.a,"");if(f.indexOf(u)===-1){i=!1;break}}}return i},G:function(){var n=this.B().a(this.f,this.h,this.b);n||_j.e.b(_a.a.bf,"Auto highlighting failed")},K:function(){if(this.d){var n=this;this.d.o(function(t){t.bk(n.f)})}},H:function(n){try{var t=this.c.h(n);this.b.fv()?this.b.iN(JsonParser.serialize([t])):this.b.iM(JsonParser.serialize([t]));var i=new _uh.m(this.b);_a.g.a.a(i)}catch(r){_j.e.c(_a.a.bf,"Unable to remove auto highlight sentence data")}},y:function(){var n=document.createElement("span");n.style.display="none";n.id="EID_"+this.c.c;this.f.appendChild(n)},L:function(n){this.i||(this.i=new Array(0));for(var r=n.b,u=r.length,t=0;t<u;++t){var i=r[t];Array.contains(this.i,i)||Array.add(this.i,i)}},w:function(n){if(this.d){var i=_a.c.b(_a.a.bf,"EmailSummarizationAction",!1,null);var t=new _a.l;var r=0;var u=this;this.d.o(function(n){r+=n.n.length});t.b("TYPE","General");t.b("EID",this.c.c);t.a("SSC",this.d.x.length);t.a("SCC",r);t.a("MCC",this.l.length);t.b("S",this.i.toString());t.b("IMI",this.b.bD.InternetMessageId);i.l=t.toString();i.m=n;_a.c.a(i)}}};_uh.s=function(n,t,i,r){this.e=n;this.d=t;this.b=i;this.f=r;this.g()};_uh.s.prototype={e:null,b:null,f:null,a:null,c:null,d:null,g:function(){if(this.d)for(var n,t,i=0;i<this.d.length;i++){n=this.d[i];t=n["@type"];if(!_j.h.a(t))if(t==="ReplyAction"){this.a||(this.a=new Array(0));Array.add(this.a,n)}else t==="SubstrateSearchQuery"&&n.requests&&(this.c=n.requests[0])}}};_uh.e=function(n,t,i,r,u,f,e,o,s,h){this.U=Function.createDelegate(this,this.o);this.X=Function.createDelegate(this,this.bu);this.T=Function.createDelegate(this,this.bl);this.V=Function.createDelegate(this,this.bs);this.W=Function.createDelegate(this,this.bt);_uh.e.initializeBase(this,[n.e,t,i,r,f,o]);if(!n){this.dispose();return}this.d=n;this.b=u;this.B=e;this.G=h;this.v=s;this.J()};_uh.e.prototype={d:null,e:null,B:null,H:!1,b:null,G:null,u:null,v:null,bm:function(){this.e||(this.e=new _uh.o(this.W,this.V,this.h,this.B));return this.e},k:null,bo:function(){return this.b&&this.b.a().U().Enabled?_uh.d.d():_uh.d.i()},bn:function(){!this.u&&this.v&&(this.u=this.b&&this.b.a().U().Enabled?new _j.g(this.T,_a.a.bb):new _j.g(this.X,_a.a.bb));return this.u},bp:function(){return this.b&&this.b.a().U().Enabled?_nbs.a.WV:_nbs.a.oU},R:function(){return"AutoHighlightSentencePopupView"},Q:function(){return 220},w:function(){return"KP"},D:function(n){return _mco.z.b(n)},S:function(n){_mco.z.c(n)},P:function(n){_mco.z.a(n)},j:function(n){var t=new _a.l;this.o(t,this.h);t.b("TYPE","Action");t.b("T",this.k?"QR":"G");t.b("A",n);_a.c.c(_a.a.bf,"EmailSummarizationAction",t.toString(),0)},bh:function(n){if(this.x||this.e&&this.e.a&&this.e.a.q)this.E(n);else{this.a.a(!1);this.H&&this.dispose()}},eW:function(){_uh.u.prototype.eW.call(this);this.B=null;this.d=null;this.b=null;var n;_a.h.a(n={val:this.e}),this.e=n.val;_a.h.b(this.k)},J:function(){if(this.d.a&&this.b&&this.b.a().ei().Enabled&&this.f.c())for(var n=0;n<this.d.a.length;n++){this.k||(this.k=new _j.l);this.k.a(new _uh.p(this.n,this.d.a[n],this.f,this.O))}},o:function(n,t){n.b("EID",this.d.f);n.b("S",this.d.b.toString());n.a("I",t===-1?this.h:t);n.b("IMI",this.G)},bt:function(n,t){this.br(n,t);if(!n&&this.m){this.bi();this.m(this.n);this.H=!0}},bs:function(n,t){this.bq(n,t)},br:function(n,t){var i=new _a.l;this.o(i,t);i.b("TYPE","Liked");i.c("L",n);_a.c.c(_a.a.bf,"EmailSummarizationAction",i.toString(),0)},bq:function(n,t){var i=new _a.l;this.o(i,t);i.b("TYPE","Feedback");_j.h.a(n)||i.b("F",n);_a.c.c(_a.a.bf,"EmailSummarizationAction",i.toString(),0)},bl:function(){this.v.a(!0);this.a.a(!1);this.j("findATime")},bu:function(){this.v.a(!1);this.a.a(!1);this.j("schedule")}};_uh.t=function(n){this.e=Function.createDelegate(this,this.g);this.d=Function.createDelegate(this,this.f);_uh.t.initializeBase(this);this.b=n};_uh.t.prototype={b:null,a:null,c:null,be:function(n){n.bc("mouseenter",this.d,"onMouseEnterContentView");n.bc("mouseleave",this.e,"onMouseLeaveContentView");_j.bV.prototype.be.call(this,n)},bh:function(n){n.bi("mouseenter","onMouseEnterContentView");n.bi("mouseleave","onMouseLeaveContentView");this.b=null;this.a&&this.a.dispose();_j.bV.prototype.bh.call(this,n)},f:function(n){if(!this.a){var i=window.document.createElement("div");var r=this.X.z.parentNode;r.appendChild(i);this.a=this.b.d(i,!1);this.a.ba(this.c);this.a.y("ContentSuggestionsPopupView.PreviewPopup");this.a.f(!1);var t=this.b.g();t.d=0-this.X.z.clientHeight;t.l=this.X.z.clientWidth;t.c(this.X);this.a.d(t)}this.a.bn();this.a.a(!0);this.V().u()},g:function(n){this.a.a(!1)}};_uh.o=function(n,t,i,r){this.v=Function.createDelegate(this,this.E);this.t=Function.createDelegate(this,this.y);this.x=Function.createDelegate(this,this.K);this.w=Function.createDelegate(this,this.J);this.u=Function.createDelegate(this,this.D);_uh.o.initializeBase(this);this.g=n;this.o=t;this.f=i;this.p=r;this.r(2)};_uh.o.prototype={a:null,g:null,o:null,p:null,f:0,d:null,e:null,b:null,c:null,s:!0,H:function(n){this.s=n;this.eE("ShouldShowFeedback");return n},h:null,j:!1,i:null,l:null,m:!1,q:null,n:null,G:function(n){if(this.a!==n){this.a=n;this.eE("FeedbackDialogViewModel")}return n},A:function(){this.c||(this.c=new _j.g(this.u,_a.a.bf));return this.c},B:function(){this.d||(this.d=new _j.g(this.w,_a.a.bf));return this.d},C:function(){this.e||(this.e=new _j.g(this.x,_a.a.bf));return this.e},z:function(){this.b||(this.b=new _j.g(this.t,_a.a.bf));return this.b},eW:function(){var r;_a.h.a(r={val:this.b}),this.b=r.val;var u;_a.h.a(u={val:this.d}),this.d=u.val;var i;_a.h.a(i={val:this.e}),this.e=i.val;var n;_a.h.a(n={val:this.c}),this.c=n.val;var t;_a.h.a(t={val:this.a}),this.a=t.val;this.g=null;this.o=null;this.p=null;_a.gb.prototype.eW.call(this)},r:function(n){switch(n){case 2:this.h=_u.n.Km;this.j=!1;this.l=_u.R.Iy;this.i=this.B();this.m=!1;this.n=_u.R.Qu;this.q=this.C();break;case 0:this.h=_u.n.DN;this.j=!1;this.l=_u.n.Dw;this.i=this.z();this.m=!0;this.n="";break}this.eN(["Header","Option1Hidden","Option1Text","Option1Command","Option2Hidden","Option2Text","Option2Command"])},J:function(){this.g(!0,this.f);this.r(0)},K:function(){this.g(!1,this.f);this.r(0)},y:function(){if(!this.a){this.G(new _uh.n(this.v,this.f));this.a.D(this.p)}this.a.f(!0)},E:function(n,t){this.H(!1);this.o(n,t)},D:function(){}};_uh.n=function(n,t){this.m=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.v);_uh.n.initializeBase(this);this.j=n;this.B(!0);this.r(_u.n.Ko);this.l=t;this.i=new _j.g(this.n,_a.a.V);this.h=new _j.g(this.m,_a.a.V);var r=new _ff.d(this.i,_u.n.Sk,null,!0,!1);var i=new _ff.d(this.h,_u.R.Po,null,!1,!1);this.u(new _j.l);this.o.j([r,i])};_uh.n.prototype={j:null,i:null,h:null,l:0,g:null,eW:function(){var t;_a.h.a(t={val:this.h}),this.h=t.val;var n;_a.h.a(n={val:this.i}),this.i=n.val;this.j=null;_a.gb.prototype.eW.call(this)},v:function(){this.f(!1);_j.h.a(this.g)||this.j(this.g,this.l)},t:function(){this.f(!1)}};_uh.p=function(n,t,i,r){this.f=Function.createDelegate(this,this.k);this.e=n;this.c=t.text;this.g=t.rank;this.h=t.segment;this.d=i;this.b=r};_uh.p.prototype={e:null,c:null,g:0,h:null,d:null,a:null,b:null,j:function(){return String.format('"{0}"',this.c)},i:function(){this.a||(this.a=new _j.g(this.f,_a.a.bf));return this.a},dispose:function(){this.d=null;this.b=null;var n;_a.h.a(n={val:this.a}),this.a=n.val},k:function(){this.d.d(this.e,this.c);this.b()}};_uh.q=function(n,t,i){this.h=_uh.q.TResponse===Number||Type.isEnum(_uh.q.TResponse)?0:_uh.q.TResponse===Boolean?!1:null;_uh.q.$$(this.$$gta["_uh.q"].TResponse).initializeBase(this);if(n){this.j=n.EndpointUri;this.k=n.Method;this.e=n;var f="/ows"+this.j;var u=n.UrlParameters;if(u)for(var r=0;r<u.length;r++){var o=u[r].Key;var e=u[r].Value;f+=r?"&":"?";f+=o+"="+e;o==="cvid"&&(this.f=e)}this.n=f;this.d=t;this.l=i}};_uh.q.$$=function(n){var u=_uh.__tc=_uh.__tc||{};var i="q"+"$"+n.getName().replace(/\./g,"_");if(!u[i]){var t=u[i]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_uh.q.apply(this,t)};var o=_a.dh;t.registerClass("_uh.__tc."+i,o);var s={"_uh.q":{TResponse:n},ctor:_uh.q};t.prototype.$$gta=s;var e=_uh.q.prototype;for(var f in e){var r={key:f,value:e[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.b=function(t,i,r){r.val="";i.val=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;try{i.val=JsonParser.deserialize(t);return!0}catch(u){r.val="Exception when deserializing response. Response Text: "+t+". Exception: "+u.message;return!1}};t.a="HTTP Status: {0}. Message: {1}. CorrelationId: {2}"}return u[i]};_uh.q.prototype={k:null,n:null,l:0,d:null,j:null,e:null,f:null,ba:function(){var n=new XMLHttpRequest;var t=this;n.onreadystatechange=function(){n.readyState===4&&(n.status>=200&&n.status<300?t.p(n,t.d):t.o(n,t.d))};var o=this;n.ontimeout=function(){o.W(Error.create("Timeout"))};n.open(this.k,this.n,!0);n.timeout=this.l;var i=this.e.Headers;if(i)for(var e=Object.keys(i),u=e,s=u.length,r=0;r<s;++r){var f=u[r];n.setRequestHeader(f,i[f])}n.send(this.e.Body);return 1},p:function(n,t){var i;var r;var e,f,u;if(u=_uh.q.$$(this.$$gta["_uh.q"].TResponse).b(n.responseText,e={val:r},f={val:i}),r=e.val,i=f.val,u){this.h=r;this.W(null)}else{i=String.format(_uh.q.$$(this.$$gta["_uh.q"].TResponse).a,n.status,i,t);this.W(Error.create(i))}},o:function(n,t){var i=String.format(_uh.q.$$(this.$$gta["_uh.q"].TResponse).a,n.status,n.responseText,t);this.W(Error.create(i))}};_uh.v=function(){};_uh.v.prototype={Groups:null};_uh.y=function(){};_uh.y.prototype={Suggestions:null};_uh.x=function(){};_uh.x.prototype={FileName:null,FileExtension:null,Url:null,SiteId:null,Id:null,SiteTitle:null,Description:null,DateModified:null,FileSourceType:null};_uh.m=function(n){_uh.m.initializeBase(this,[2]);this.j=n;this.r="UpdateAutoHighlightDataAction"};_uh.m.a=function(n,t,i,r){var f=new _g.u(i);var u=new _g.K;r(u,t);f.Item=u;Array.add(n,f)};_uh.m.b=function(n,t){var i=t.bR()?_g.c.a(t.bR().e(),_g.c.q()):null;if(i){_mco.a.b(n,i.bD);i.dispose()}};_uh.m.prototype={j:null,o:null,k:!1,cI:function(n){if(this.k)throw Error.invalidOperation("Expected only one response message.");this.k=!0;this.s||(this.o=n.Items[0].ItemId)},t:function(){var n=new _g.bl;var r=this.j.bD.ItemId;n.ItemId=new _g.e(r.Id);n.ItemId.ChangeKey=r.ChangeKey;var t=[];_g.i.isInstanceOfType(this.j)&&this.j.bR()&&_g.c.a(this.j.bR().e(),_g.c.q())&&_uh.m.a(t,this.j,_g.c.q(),_uh.m.b);n.Updates=new Array(t.length);for(var i=0;i<t.length;i++)n.Updates[i]=t[i];return[n]}};_uh.j=function(n,t,i,r,u,f,e,o,s,h){this.K=Function.createDelegate(this,this.bv);this.L=Function.createDelegate(this,this.bw);this.M=Function.createDelegate(this,this.bx);_uh.j.initializeBase(this,[n,t,i,f,u,o,s,e,null,h]);this.l=r;this.J();var c=new _mf.k(this.l);c.a()};_uh.j.prototype={l:null,p:null,N:!0,q:null,g:null,by:function(n){this.N=n;this.eE("IsLoadingSuggestions");return n},J:function(){if(this.l&&this.d.c){var n=new(_uh.q.$$(_uh.v))(this.d.c,"",2e4);n.b(this.M);n.c(this.L);n.a(this.K);this.q=_a.c.b(_a.a.bf,"ReplyWith3SQuery",!1,null);this.g=new _a.l;this.l.a(n)}},bx:function(n){if(!this.eX){_j.e.a(_a.a.bf,"OnSubstrateSearchSuccess: Request sucessful");var u=n.h;if(!u||!u.Groups||u.Groups.length<1){_j.e.b(_a.a.bf,"OnSubstrateSearchSuccess: Unable to deserialize data");return}for(var f=u.Groups[0].Suggestions,s=f.length<3?f.length:3,e=new Array(0),r=0;r<s;r++){var i=f[r];var h=_a.d.b(i.DateModified);var t;var o=(t=new _uh.f(r,this.l,this.O,this.f,this.U),t.d=i.Id,t.z(i.Url),t.f=i.FileName,t.q=h.a(1),t.p=i.FileSourceType,t.y(i.FileExtension),t);Array.add(e,i.Id);this.p||(this.p=new _j.l);this.p.a(o)}this.g.a("RC",f.length);this.g.b("SCID",e.toString());this.eE("ContentSuggestionViewModels")}},bw:function(n){this.q.m="ActionFailed";this.q.o=n.G.message},bv:function(n){this.g.b("CVID",n.f);this.o(this.g,-1);this.q.l=this.g.toString();_a.c.a(this.q);this.by(!1);n.U(this.M);n.T(this.L);n.m(this.K)},R:function(){return"ContentSuggestionsPopupView"},Q:function(){return 225},j:function(n){var t=new _a.l;this.o(t,this.h);t.b("TYPE","Action");t.b("T","RW");t.b("A",n);_a.c.c(_a.a.bf,"EmailSummarizationAction",t.toString(),0)},eW:function(){_uh.e.prototype.eW.call(this);this.l=null;this.g=null;_a.h.b(this.p)}};_uh.f=function(n,t,i,r,u){this.n=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.x);this.r=Function.createDelegate(this,this.v);_uh.f.initializeBase(this);this.m=n;this.j=t;this.l=i;this.b=r;this.e=u};_uh.f.a=function(n){var t=_uh.d.e();switch(n){case"docx":t=_uh.d.b();break;case"pptx":t=_uh.d.h();break;case"pdf":t=_uh.d.g();break;case"xlsx":t=_uh.d.c();break}return t};_uh.f.prototype={c:null,j:null,l:null,e:null,b:null,a:null,m:0,z:function(n){this.c=n;_j.h.a(this.c)||this.A();return n},y:function(n){this.g=_uh.f.a(n);return n},h:!1,p:null,q:null,s:0,d:null,t:function(){this.a||(this.a=new _j.g(this.r,_a.a.bf));return this.a},f:null,g:null,i:null,u:function(){var n=new _a.l;this.e(n,-1);n.c("P",!_j.h.a(this.i));n.a("CSI",this.m);n.b("ID",this.d);_a.c.c(_a.a.bf,"ReplyWithSuggestionPreviewShown",n.toString(),0)},eW:function(){this.j=null;this.l=null;this.b=null;this.e=null;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.g=null},A:function(){this.h=!0;this.eE("IsLoadingPreviewImage");var t=new _g.cF;t.Url=this.c;var n=new _mco.b(t);n.b(this.o);n.a(this.n);this.j.a(n)},x:function(n){if(!this.eX){var r=n;var t=r.N.LinkPreview;if(t.__type===_gg.bc._dataContractName){var i=t;this.i=i.PreviewImageInBase64;this.eE("PreviewImageSrc")}}},w:function(n){this.h=!1;this.eE("IsLoadingPreviewImage");n.U(this.o);n.m(this.n)},v:function(){if(!_j.h.a(this.c)&&this.b&&this.b.c()){var n=new _db.d;n.s(this.f);n.u(this.c);n.r(this.d);n.q(_g.q.toString(0));n.p(_mf.k.c(0));n.t(this.s);var t=new _a.l;this.e(t,-1);t.b("ID",this.d);t.a("CSI",this.m);_a.c.c(_a.a.bf,"ReplyWithSuggestionClicked",t.toString(),0);this.b.i(n)}this.l()}};_uh.k=function(n,t){_uh.k.initializeBase(this);this.f=n;this.h=new _g.bz(this.L);this.e=t};_uh.k.prototype={f:null,h:null,e:null,K:function(n){var t;var i=new _g.bx((t=new _g.X,t.BaseShape="IdOnly",t.AdditionalProperties=this.k(),t));i.ItemIds=[_g.e.a(this.f)];var r=new _g.bw(this.M(),i);n.a(r,this.h,this.J,this.H)},cI:function(n){var t=n.Items[0];if(t&&t.ExtendedProperty&&t.ExtendedProperty.length>0){var i=_h.d.a().a(t.ItemId.Id);if(i&&i.bR()){i.hB(t);_h.c.h(i)}}},k:function(){var t=_h.d.a().a(this.f.Id);var n=new Array(0);if(t){if(this.j()){t.eM()||Array.add(n,_g.c.bh());t.fu()||Array.add(n,_g.c.q());t.fv()||Array.add(n,_g.c.bd())}this.l()&&(t.ep()||Array.add(n,_g.c.i()))}return n},l:function(){return!!this.e&&this.e.a().bA().Enabled},j:function(){return _mco.p.a(this.e)}};_uh.d=function(){};_uh.d.f=function(){return _fm.b.a(_fm.a.et,_fm.WebfontSizes.a.c)};_uh.d.a=function(){return _fm.b.a(_fm.a.bi,_fm.WebfontSizes.a.m)};_uh.d.i=function(){return _fm.b.a(_fm.a.w,_fm.WebfontSizes.a.c)};_uh.d.d=function(){return _fm.b.a(_fm.a.cw,_fm.WebfontSizes.a.e,"ms-fcl-tp-b")};_uh.d.h=function(){return _fm.d.a("c_powerpoint_cloud_aw.png")};_uh.d.b=function(){return _fm.d.a("c_word_cloud_aw.png")};_uh.d.g=function(){return _fm.d.a("c_pdf_cloud_aw.png")};_uh.d.c=function(){return _fm.d.a("c_excel_cloud_aw.png")};_uh.d.e=function(){return _fm.d.a("c_generic_cloud_aw.png")};_uh.u=function(n,t,i,r,u,f){this.bc=Function.createDelegate(this,this.bJ);this.ba=Function.createDelegate(this,this.bI);this.bg=Function.createDelegate(this,this.bO);this.bb=Function.createDelegate(this,this.E);this.Z=Function.createDelegate(this,this.bH);this.Y=Function.createDelegate(this,this.bz);this.bf=Function.createDelegate(this,this.bM);this.bd=Function.createDelegate(this,this.bK);this.be=Function.createDelegate(this,this.bL);this.O=Function.createDelegate(this,this.bD);_uh.u.initializeBase(this);this.n=n;this.h=t;this.y=r;this.m=u;this.f=f;this.bk(i)};_uh.u.prototype={i:null,a:null,x:!1,z:0,y:null,A:null,c:null,C:null,r:null,s:null,t:null,f:null,bF:function(){!this.r&&this.m&&(this.r=new _j.g(this.be,_a.a.bf));return this.r},bG:function(){!this.s&&this.f&&this.f.c()&&(this.s=new _j.g(this.bd,_a.a.bf));return this.s},n:null,m:null,h:0,R:function(){return"KeyPointPopupView"},Q:function(){return 150},bE:function(){return this.z?this.z:this.Q()},bk:function(n){if(n){this.C=n;this.i&&this.bj();this.i=n.querySelectorAll("#"+this.w()+this.h);this.bA();this.bC(this.C)}},eW:function(){this.m=null;this.f=null;this.c&&(this.c=_j.m.a().b(this.c));this.A&&(this.A=_j.m.a().b(this.A));this.a&&this.bP();this.C=null;this.y=null;this.t=null;var i;_a.h.a(i={val:this.r}),this.r=i.val;var t;_a.h.a(t={val:this.s}),this.s=t.val;var n;_a.h.a(n={val:this.a}),this.a=n.val;if(this.i){this.bj();this.i=null}},bD:function(){this.a.a(!1)},bi:function(){_j.B.a(this.i,this.bf)},bh:function(n){this.x?this.E(n):this.a.a(!1)},E:function(n){if(n.b().id.startsWith(this.w())){this.D(n.b())&&this.S(n.b());var t=this;this.c=_j.m.a().a(_a.a.bf,"MouseLeaveEvent",function(){t.bh(n)},500)}},bN:function(n){if(n.b()&&this.D(n.b())&&this.a){var i=this.a.o;var t=n.b().getBoundingClientRect();i.a(t.left+t.width/2-this.bE()/2);i.b(t.bottom+8);this.a.bn();this.a.a(!0);this.z||(this.z=this.a.z.clientWidth);this.j("showPopup")}},bH:function(n){this.c&&(this.c=_j.m.a().b(this.c));this.t||(this.t=window.document.querySelector("[id^=UserHighlightPopup]"));if((!this.t||!_j.k.s(this.t))&&this.a&&!this.a.b()){this.P(n.b());var t=this;this.A=_j.m.a().a(_a.a.bf,"OnMouseEnter",function(){t.bN(n)},500)}},bA:function(){_j.B.a(this.i,this.Y)},bz:function(n,t){_j.k.b(t,"mouseenter",this.Z);_j.k.b(t,"mouseleave",this.bb)},bj:function(){_j.B.a(this.i,this.bg)},bO:function(n,t){_j.k.c(t,"mouseenter");_j.k.c(t,"mouseleave")},bB:function(){this.a.bc("mouseenter",this.ba,"mouseEnterPopup");this.a.bc("mouseleave",this.bc,"mouseLeavePopup")},bP:function(){this.a.a(!1);this.a.bi("mouseenter","mouseEnterPopup");this.a.bi("mouseleave","mouseLeavePopup")},bI:function(n){this.c&&(this.c=_j.m.a().b(this.c));this.x=!0},bJ:function(n){this.x=!1;this.E(n)},bM:function(n,t){t.className="";t.style.cursor="";t.id=""},bC:function(n){var i=window.document.createElement("div");var r=n.parentNode;r.appendChild(i);var t=this.y.d(i,!0);t.y(this.R());t.ba(this);t.d(this.y.h());this.a=t;this.a.z.id=this.w()+this.h;this.bB()},bK:function(){this.f.d(this.n,"");this.a.a(!1);this.j("quote")},bL:function(){this.bi();this.m(this.n);this.j("remove");this.dispose()}};_uh.l=function(n,t){this.a=n;this.b=t};_uh.l.prototype={a:null,b:null,d:function(n,t,i,r,u,f,e,o,s){return n.c&&r&&r.a().bz().Enabled?new _uh.j(n,t,i,this.b,r,this.a,e,f,u,s):new _uh.e(n,t,i,this.a,r,f,u,e,o,s)},c:function(n,t,i,r,u){return new _uh.w(n,t,i,this.a,r,u)}};_uh.g=function(n,t,i,r){this.a=n;this.c=t;this.e=i;this.b=r};_uh.g.prototype={a:null,c:null,e:null,b:null,d:function(n,t){var i=new _fce.l(n,this.a,this.c,this.e,this.b,null);i.f(!1);i.h(!1);i.e=!0;i.w=!1;t&&_j.k.a(i.z,"box-shadow","0px 0px 7px rgba(0,0,0,0.4)");return i},f:function(){return new _cmc.K(this.a,this.b)},h:function(){return new _fce.E(this.a,this.b)},g:function(){return new _fce.v(this.a,this.c,this.b)}};function UserHighlightingComponent(){}UserHighlightingComponent.$$cctor=function(){_a.t.a().a(UserHighlightingComponent)};UserHighlightingComponent.prototype={b:function(n,t,i){var f=this;n.b(_uh.g,function(){return new _uh.g(n.a(_fc.f),n.a(_j.j),n.a(_y.a),n.a(_ff.b))});var u=this;n.b(_uh.l,function(){return new _uh.l(n.a(_uh.g),n.a(_a.q))});var r=this;n.b(UserHighlightingFactory,function(){return new UserHighlightingFactory(n.a(_fc.f),n.a(_j.j),n.a(_y.a),n.a(_ff.b),n.a(_a.q),n.a(_uh.l),n.a(_uh.g))}).b(_mco.P).a()},a:function(){return null}};function UserHighlightingFactory(n,t,i,r,u,f,e){this.f=n;this.h=t;this.i=i;this.g=r;this.d=u;this.c=f;this.e=e}UserHighlightingFactory.prototype={f:null,h:null,i:null,g:null,d:null,c:null,e:null,b:function(n,t,i,r){return new _uh.r(this.e,this.c,n,t,i,r)},a:function(n,t,i,r,u){return new _uh.h(this.c,n,this.d,r,t,i,u)}};_uh.r=function(n,t,i,r,u,f){this.w=Function.createDelegate(this,this.S);this.v=Function.createDelegate(this,this.Q);this.q=Function.createDelegate(this,this.P);this.z=Function.createDelegate(this,this.L);this.u=Function.createDelegate(this,this.N);this.A=Function.createDelegate(this,this.M);this.C=Function.createDelegate(this,this.T);this.B=Function.createDelegate(this,this.O);_uh.r.initializeBase(this);this.p=n;this.n=t;this.m=i;this.o=r;this.b(u);this.g=f};_uh.r.prototype={y:150,e:null,i:null,j:null,t:null,m:null,d:null,l:null,o:null,c:null,f:null,g:null,n:null,p:null,s:null,J:function(){this.i||(this.i=new _j.g(this.B,_a.a.cg));return this.i},K:function(){!this.j&&this.g&&this.g.c()&&(this.j=new _j.g(this.C,_a.a.cg));return this.j},r:function(){return!!this.c&&this.c.b()},D:function(){this.l||(this.l=new _uh.i);return this.l},b:function(n){if(!this.c){this.c=n;this.R()}},a:function(n){this.d=n;_j.k.b(this.d,"mouseup",this.A);document.addEventListener("scroll",this.u,!0);_j.k.b(document.body,"blur",this.z);this.r()&&this.x(this.c.a())},eW:function(){this.h();if(this.d){_j.k.c(this.d,"mouseup");document.removeEventListener("scroll",this.u,!0);_j.k.c(document.body,"blur")}this.m=null;this.d=null;this.o=null;this.g=null;this.n=null;this.p=null;if(this.c){this.c.c(this.q);this.c=null}if(this.f){for(var n=0;n<this.f.length;n++){var u,f;_a.h.a(f={val:this.f[u=n]}),this.f[u]=f.val}this.f=null}this.e&&this.e.bP(this.v);var e;_a.h.a(e={val:this.i}),this.i=e.val;var t;_a.h.a(t={val:this.j}),this.j=t.val;var i;_a.h.a(i={val:this.l}),this.l=i.val;var r;_a.h.a(r={val:this.e}),this.e=r.val;_a.gb.prototype.eW.call(this)},U:function(){this.f=new Array(0);for(var t=this.c.a(),n=0;n<t.length;n++){var i=this.n.c(t[n],n,this.d,this.w,this.g);Array.add(this.f,i)}},R:function(){this.c&&(this.c.b()?this.x(this.c.a()):this.c.d(this.q))},P:function(){this.c.c(this.q);this.x(this.c.a())},H:function(){if(this.d){var i=window.document.createElement("div");var r=this.d.parentNode;if(r){r.appendChild(i);var t=this.p.d(i,!0);t.z.id="UserHighlightPopup";t.ba(this);t.y("UserHighlightingControlView");var n=this.p.f();n.b=1;n.a=8;n.d=!0;n.f=!0;n.i=!0;t.d(n);this.e=t;this.e.bd(this.v)}}},Q:function(n,t){this.e.b()?this.s=_a.c.b(_a.a.cg,"UserHighlightPopupShown",!1,null):this.s&&_a.c.a(this.s)},W:function(n){var i=this.E();if(i&&i.rangeCount>0){var t=i.getRangeAt(0);if(t){if(_j.h.b(i.toString())||t.endContainer===t.startContainer&&t.endOffset===t.startOffset)return;if(!this.d||!this.d.contains(t.startContainer)||!this.d.contains(t.endContainer))return;var f=t.cloneContents();if(f.querySelectorAll("[id^=userSelect]").length>0)return;this.t=i;var r=t.getClientRects();var u=r[r.length-1];this.V(u)}}},V:function(n){this.e||this.H();this.e.o.c=new _cmc.L(n.top,n.bottom,n.right-this.y/2);this.e.bn();this.e.a(!0);this.y=this.e.z.clientWidth},h:function(){this.e&&this.e.b()&&this.e.a(!1)},E:function(){var n;n=this.o?this.o.getSelection():document.selection?document.selection:window.getSelection();return n},N:function(n){this.h();return!0},L:function(n){this.h()},M:function(n){if(this.r()){this.h();var t=this;_j.m.a().a(_a.a.cg,"HandleMouseUp: Attempting to show highlight popup",function(){t.W(n)},200)}},O:function(){var n=this.t.toString();this.D().a(this.d,[n],this.m);var i=this.G(n);var t=this.n.c(i,this.f?this.f.length:0,this.d,this.w,this.g);this.f||(this.f=new Array(0));Array.add(this.f,t);this.E().removeAllRanges()},x:function(n){if(this.d&&n&&n.length>0){for(var r=new Array(0),u=n,f=u.length,t=0;t<f;++t){var i=u[t];i&&Array.add(r,i.b())}this.D().a(this.d,r,this.m);this.U()}},G:function(n){if(this.r()){var i=this.c.e(n);var t=new _a.l;t.b("G",i.a());_a.c.c(_a.a.cg,"UserHighlightAdd",t.toString(),0);this.h();return i}return null},S:function(n){this.r()&&this.c.f(n)},T:function(){if(this.g){_a.c.c(_a.a.cg,"UserHighlightQuote");this.g.d(this.t.toString(),"");this.h()}}};_uh.w=function(n,t,i,r,u,f){_uh.w.initializeBase(this,[n.b(),t,i,r,u,f]);this.b=n};_uh.w.prototype={b:null,w:function(){return"userSelect"},eW:function(){_uh.u.prototype.eW.call(this);this.b=null},D:function(n){return _uh.i.b(n)},S:function(n){_uh.i.c(n)},P:function(n){_uh.i.a(n)},j:function(n){var i=new _a.l;i.b("G",this.b.a());var t=null;switch(n){case"showPopup":break;case"remove":t="UserHighlightRemove";break;case"quote":t="UserHighlightQuote";break}t&&_a.c.c(_a.a.cg,t,i.toString(),0)}};_uh.i=function(){this.b=-1;_uh.i.initializeBase(this,[new Array(0)])};_uh.i.a=function(n){_j.k.f(n,"ms-bg-color-themeLighter");_j.k.d(n,"ms-bg-color-themeLight")};_uh.i.c=function(n){_j.k.f(n,"ms-bg-color-themeLight");_j.k.d(n,"ms-bg-color-themeLighter")};_uh.i.b=function(n){return _j.k.l(n,"ms-bg-color-themeLight")};_uh.i.prototype={d:function(){return"ms-bg-color-themeLighter"},a:function(n,t,i){var r=_mco.l.prototype.a.call(this,n,t,i);this.b=this.b===-1?t.length:this.b+1;return r},h:function(n,t){_j.k.f(t,this.d())},k:function(n,t){var i=this.b===-1?t.e:this.b;n.id="userSelect"+i;n.style.cursor="pointer"}};_uh.a=function(){};_uh.a.$$cctor=function(){_uh.a._I()};_uh.a.S=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='_uh_2'> <span class='_uh_5 _uh_7'></span> <div> <button type='button' class='ms-font-s ms-fcl-np _uh_4'></button> <button type='button' class='ms-font-s ms-fcl-np _uh_4'></button> </div> </div> </div><div> <div></div> </div><div> <button type='button' class='_uh_g ms-font-s ms-fcl-np'></button> </div><div>  <button type='button' class='_uh_8 ms-font-mi ms-fwt-sb ms-fcl-np'></button>    <span class='_uh_f ms-fcl-ns'></span>   <button type='button' class='_uh_9 ms-font-mi ms-fwt-sb ms-fcl-ns'></button>   <button type='button' class='_uh_9 ms-font-mi ms-fwt-sb ms-fcl-ns'></button> </div><div> <div class='_uh_b'> <div class='_uh_b _uh_d'></div> <div class='_uh_c'> <span class='_uh_h _uh_k'></span> <button type='button' class='ms-font-s ms-fcl-np _uh_j'></button> <div></div> </div> <div class='ms-bgc-nlra _uh_e'></div> </div> <div></div>   </div><div> <div class='_uh_y'> <span class='_uh_B'></span> <div class='_uh_z'> <span class='ms-font-s ms-fcl-np _uh_D'></span> <span class='_uh_A'> <span class='ms-font-xs ms-fcl-ns'></span> <span class='ms-font-xs ms-fcl-ns'></span> </span> </div> </div>  </div><div> <button type='button' class='_uh_w _uh_x'></button> </div><div> <div class='_uh_E'> <div class='_uh_v ms-font-s ms-fcl-nt'></div> <div> <img class='_uh_F'/> <span class='_uh_v ms-font-s ms-fcl-nt'></span> </div> <div class='_uh_H'> <div class='_uh_G'> <span class='ms-font-s ms-fcl-nt'></span> </div> </div> </div> </div><div> <div class='_uh_p'> <span class='_uh_t popupShadow'></span> <div class='_uh_v _uh_I _uh_u ms-font-s ms-fontWeight-semibold ms-fcl-tp'></div> <div>  <span class='_uh_v _uh_u ms-font-s ms-fontWeight-semibold ms-fcl-tp'></span>  <span class='_uh_v ms-font-s ms-fcl-ns'></span>  <div class='backgroundWhite _uh_p'></div> </div>  <div></div>  <div class='ms-bgc-nlra _uh_q'></div> </div> <div></div>   </div><div> <textarea class='_uh_J ms-border-color-themePrimary'></textarea> </div><div> <div class='_uh_K'> <span class='_uh_M _uh_O'></span> <div> <button type='button' class='ms-font-s ms-fcl-np _uh_L'></button> <button type='button' class='ms-font-s ms-fcl-np _uh_L'></button> </div> </div> </div>";_j.i.a().appendChild(n);return n};_uh.a.bv=function(n){return n.J()};_uh.a.bw=function(n){return _nbs.a.Rk};_uh.a.K=function(n){return n.K()};_uh.a.bu=function(n){return n.j()};_uh.a.bt=function(n){return n.i()};_uh.a.H=function(n){return n.m};_uh.a.bm=function(n){return n.A()};_uh.a.bl=function(n){return n.h};_uh.a.bo=function(n){return n.j};_uh.a.bp=function(n){return n.l};_uh.a.bn=function(n){return n.i};_uh.a.br=function(n){return n.n};_uh.a.bq=function(n){return n.q};_uh.a.D=function(n){return n.k};_uh.a.ba=function(n){return n.bo()};_uh.a.q=function(n){return _uh.e.isInstanceOfType(n)?n.bn():null};_uh.a.bb=function(n){return n.bp()};_uh.a.p=function(n){return n.V()};_uh.a.n=function(n){return n.bm()};_uh.a.I=function(n){return n.s};_uh.a.G=function(n){return n.a};_uh.a.o=function(n){return n.q};_uh.a.z=function(n){return n.b()};_uh.a.P=function(n){return n.x};_uh.a.L=function(n){return n.p};_uh.a.M=function(n){return n.w};_uh.a.N=function(n){return n.o};_uh.a.O=function(n){return n.y};_uh.a.bf=function(n){return n.g};_uh.a.be=function(n){return n.f};_uh.a.bh=function(n){return n.q};_uh.a.bd=function(n){return n.t()};_uh.a.F=function(n){return n.h};_uh.a.s=function(n){return n.i};_uh.a.bg=function(n){return n.p};_uh.a.r=function(n){return n.N};_uh.a.E=function(n){return n.p};_uh.a.bj=function(n){return 3800};_uh.a.bi=function(n){return n.g};_uh.a.X=function(n){return n.b};_uh.a.J=function(n){return n.bG()};_uh.a.bs=function(n){return n.bF()};_uh.a.i=function(n,t){n.l(t)};_uh.a.d=function(n,t){n.T(t)};_uh.a.f=function(n,t){n.j(t)};_uh.a.b=function(n,t){n.K(t)};_uh.a.C=function(n,t){n.bj(t)};_uh.a.g=function(n,t){n.a(t)};_uh.a.y=function(n,t){n.bk(t)};_uh.a.j=function(n,t){n.ba(t)};_uh.a.Q=function(n,t){n.f(t)};_uh.a.B=function(n,t){n.a(t)};_uh.a.w=function(n,t){n.n(t)};_uh.a.A=function(n,t){n.j(t)};_uh.a.v=function(n,t){n.m(t)};_uh.a.u=function(n,t){n.l(t)};_uh.a.x=function(n,t){n.bf(t)};_uh.a.V=function(n,t){n.a(t)};_uh.a.bc=function(n,t){n.c=t};_uh.a.t=function(n,t){n.b(t)};_uh.a.W=function(n,t){n.a(t)};_uh.a.U=function(n,t){n.c(t)};_uh.a.T=function(n,t){n.d(t)};_uh.a.Y=function(n,t){n.a(t)};_uh.a.bk=function(n,t){n.g=t};_uh.a.Z=function(n,t){n.c(t)};_uh.a.h=function(){_uh.a.m||(_uh.a.m=new _fc.l);return _uh.a.m};_uh.a.R=function(){_uh.a.l||(_uh.a.l=new _fc.n);return _uh.a.l};_uh.a.e=function(){_uh.a.k||(_uh.a.k=new _fc.k);return _uh.a.k};_uh.a._I=function(){var s="UserHighlightingControlView";new _j.d(s,function(){_uh.a.a[s]===undefined&&(_uh.a.a[s]=[[[-1,4,null,null,null,"ImageId",null,_uh.a.i,0,null,null,null,_uh.d.f()],[-1,0,["HighlightCommand"],[_uh.a.bv],null,"ClickCommand",null,_uh.a.d,1,null,null,null],[-1,0,["HighlightText"],[_uh.a.bw],null,"Text",null,_uh.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_uh.a.i,0,null,null,null,_mco.s.a()],[-1,4,null,null,null,"Text",null,_uh.a.f,0,null,null,null,_nbs.a.pF],[-1,0,["ReplyWithQuoteCommand"],[_uh.a.K],null,"ClickCommand",null,_uh.a.d,1,null,null,null],[-1,0,["ReplyWithQuoteCommand"],[_uh.a.K],null,"IsHidden",null,_uh.a.b,1,_uh.a.h(),null,!0]]]);var n=_uh.a.c.childNodes[0].cloneNode(!0);var i=new _fc.b(_j.a.a(n,[0,1,1]));i.k("ms-fcl-tp _uh_6");var t=new _fc.b(_j.a.a(n,[0,1,0]));t.k("ms-fcl-tp _uh_6");return new _j.a(n,[t,i])},"",_uh.r,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a);var o="AutoHighlightSentencePopupView._tid1";new _j.d(o,function(){_uh.a.a[o]===undefined&&(_uh.a.a[o]=[null]);var t=_uh.a.c.childNodes[1].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",_uh.e,_fce.a,function(n){return new _fce.a(n,_j.b.Instance.a(_ff.a))},!1,!0,!1,0,_uh.a.a);var e="AutoHighlightSentencePopupView.QuickReplyButtonView";new _j.d(e,function(){_uh.a.a[e]===undefined&&(_uh.a.a[e]=[[[-1,0,["ReplyButtonText"],[_uh.a.bu],null,"Text",null,_uh.a.f,1,null,null,null],[-1,0,["QuickReplyCommand"],[_uh.a.bt],null,"ClickCommand",null,_uh.a.d,1,null,null,null]]]);var n=_uh.a.c.childNodes[2].cloneNode(!0);var t=new _fc.b(n.children[0]);return new _j.a(n,[t])},"",_uh.p,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a);var l="AutoHighlightSentencePopupView.FeedbackView";new _j.d(l,function(){_uh.a.a[l]===undefined&&(_uh.a.a[l]=[[[-1,4,null,null,null,"Title",null,_uh.a.C,0,null,null,null,_u.n.Gr],[-1,4,null,null,null,"ImageId",null,_uh.a.i,0,null,null,null,_uh.d.a()],[-1,0,["Option2Hidden"],[_uh.a.H],null,"IsHidden",null,_uh.a.b,1,null,null,!0],[-1,0,["NoopCommand"],[_uh.a.bm],null,"ClickCommand",null,_uh.a.d,1,null,null,null]],[[-1,0,["Header"],[_uh.a.bl],null,"Text",null,_uh.a.g,1,null,null,null]],[[-1,0,["Option1Hidden"],[_uh.a.bo],null,"IsHidden",null,_uh.a.b,1,null,null,!0],[-1,0,["Option1Text"],[_uh.a.bp],null,"Text",null,_uh.a.f,1,null,null,null],[-1,0,["Option1Command"],[_uh.a.bn],null,"ClickCommand",null,_uh.a.d,1,null,null,null]],[[-1,0,["Option2Hidden"],[_uh.a.H],null,"IsHidden",null,_uh.a.b,1,null,null,!0],[-1,0,["Option2Text"],[_uh.a.br],null,"Text",null,_uh.a.f,1,null,null,null],[-1,0,["Option2Command"],[_uh.a.bq],null,"ClickCommand",null,_uh.a.d,1,null,null,null]]]);var n=_uh.a.c.childNodes[3].cloneNode(!0);var r=new _fc.b(n.children[3]);var u=new _fc.b(n.children[2]);var t=new _fc.a(n.children[1]);var i=new _fc.b(n.children[0]);return new _j.a(n,[i,t,u,r])},"",_uh.o,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a);var c="AutoHighlightSentencePopupView";new _j.d(c,function(){_uh.a.a[c]===undefined&&(_uh.a.a[c]=[[[-1,0,["QuickTextReplyViews"],[_uh.a.D],null,"IsHidden",null,_uh.a.b,1,_uh.a.R(),null,!0],[-1,0,["QuickTextReplyViews"],[_uh.a.D],null,"DataSource",null,_uh.a.y,1,null,null,null]],[[-1,0,["MeetingButtonImageId"],[_uh.a.ba],null,"ImageId",null,_uh.a.i,1,null,null,null],[-1,0,["FindATimeCommand"],[_uh.a.q],null,"ClickCommand",null,_uh.a.d,1,null,null,null],[-1,0,["MeetingButtonLabel"],[_uh.a.bb],null,"Text",null,_uh.a.f,1,null,null,null],[-1,0,["FindATimeCommand"],[_uh.a.q],null,"IsHidden",null,_uh.a.b,1,_uh.a.h(),null,!0]],[[-1,1,["DataContext"],[_uh.a.p],null,"DataContext",null,_uh.a.j,1,null,null,null]],[[-1,0,["FeedbackPopupViewModel"],[_uh.a.n],null,"DataContext",null,_uh.a.j,1,null,null,null],[0,0,["ShouldShowFeedback"],[_uh.a.I],null,"IsHidden",null,_uh.a.b,1,_uh.a.e(),null,!0]],[[-1,0,["FeedbackPopupViewModel","FeedbackDialogViewModel"],[_uh.a.n,_uh.a.G],null,"DataContext",null,_uh.a.j,1,null,null,null],[0,0,["IsShown"],[_uh.a.o],null,"IsHidden",null,_uh.a.b,1,_uh.a.e(),null,!0],[0,0,["IsShown"],[_uh.a.o],_uh.a.Q,"IsShown",_uh.a.z,_uh.a.B,2,null,null,!1],[0,0,["Title"],[_uh.a.P],null,"DialogTitle",null,_uh.a.w,1,null,null,null],[0,0,["CloseCommand"],[_uh.a.L],null,"CloseCommand",null,_uh.a.A,1,null,null,null],[0,0,["ContentDataContext"],[_uh.a.M],null,"ContentDataContext",null,_uh.a.v,1,null,null,null],[0,0,["FooterButtons"],[_uh.a.N],null,"ButtonDataList",null,_uh.a.u,1,null,null,null],[0,0,["ParentProjectionWindow"],[_uh.a.O],null,"ParentProjectionWindow",null,_uh.a.x,1,null,null,null]]]);var n=_uh.a.c.childNodes[4].cloneNode(!0);var i=new _fce.o(n.children[1],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.c("FeedbackDialogView");i.q(!0);var r=new _j.c(_j.a.a(n,[0,2]));r.y("AutoHighlightSentencePopupView.FeedbackView");var f=new _j.c(_j.a.a(n,[0,1,2]));f.y("KeyPointPopupView");var u=new _fc.b(_j.a.a(n,[0,1,1]));u.k("ms-fcl-tp _uh_i");var t=new _fce.a(_j.a.a(n,[0,0]),_j.b.Instance.a(_ff.a));t.bf("div");t.u("AutoHighlightSentencePopupView.QuickReplyButtonView");t.y("AutoHighlightSentencePopupView._tid1");return new _j.a(n,[t,u,f,r,i])},"",_uh.e,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a);var h="ContentSuggestionsPopupView._tid2";new _j.d(h,function(){_uh.a.a[h]===undefined&&(_uh.a.a[h]=[null]);var t=_uh.a.c.childNodes[1].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",_uh.j,_fce.a,function(n){return new _fce.a(n,_j.b.Instance.a(_ff.a))},!1,!0,!1,0,_uh.a.a);var i="ContentSuggestionsPopupView.ContentView._tid3";new _j.d(i,function(){_uh.a.a[i]===undefined&&(_uh.a.a[i]=[[[-1,0,["ImageId"],[_uh.a.bf],null,"Id",null,_uh.a.V,1,null,null,null]],[[-1,0,["ContentName"],[_uh.a.be],null,"Text",null,_uh.a.g,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_uh.a.g,0,null,null,null,_nbs.a.cl]],[[-1,0,["ModifiedDateTime"],[_uh.a.bh],null,"Text",null,_uh.a.g,1,null,null,null]]]);var n=_uh.a.c.childNodes[5].cloneNode(!0);var u=new _fc.a(_j.a.a(n,[0,1,1,1]));var f=new _fc.a(_j.a.a(n,[0,1,1,0]));var t=new _fc.a(_j.a.a(n,[0,1,0]));var r=new _fc.d(_j.a.a(n,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[r,t,f,u])},"",_uh.f,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_uh.a.a);var t="ContentSuggestionsPopupView.ContentView";new _j.d(t,function(){_uh.a.a[t]===undefined&&(_uh.a.a[t]=[[[-1,0,["ClickCommand"],[_uh.a.bd],null,"ClickCommand",null,_uh.a.d,1,null,null,null]]]);var r=_uh.a.c.childNodes[6].cloneNode(!0);var n=new _fc.b(r.children[0]);var i=new _uh.t(_j.b.Instance.a(_uh.g));i.W(_j.f.a(["DataContext"],[_uh.a.p],null,"PopupDataContext",null,_uh.a.bc,1));n.C([i]);n.y("ContentSuggestionsPopupView.ContentView._tid3");return new _j.a(r,[n])},"",_uh.f,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a);var n="ContentSuggestionsPopupView.PreviewPopup";new _j.d(n,function(){_uh.a.a[n]===undefined&&(_uh.a.a[n]=[[[-1,4,null,null,null,"SpinnerSize",null,_uh.a.t,0,null,null,0,0],[-1,0,["IsLoadingPreviewImage"],[_uh.a.F],null,"IsHidden",null,_uh.a.b,1,_uh.a.e(),null,!0]],[[-1,0,["IsLoadingPreviewImage"],[_uh.a.F],null,"IsHidden",null,_uh.a.b,1,null,null,!0]],[[-1,0,["PreviewImageSrc"],[_uh.a.s],null,"Source",null,_uh.a.W,1,null,null,null],[-1,0,["PreviewImageSrc"],[_uh.a.s],null,"IsHidden",null,_uh.a.b,1,_uh.a.h(),null,!0]],[[-1,4,null,null,null,"Text",null,_uh.a.g,0,null,null,null,_nbs.a.HG],[-1,0,["PreviewImageSrc"],[_uh.a.s],null,"IsHidden",null,_uh.a.b,1,null,null,!0]],[[-1,0,["Location"],[_uh.a.bg],null,"Text",null,_uh.a.g,1,null,null,null]]]);var t=_uh.a.c.childNodes[7].cloneNode(!0);var f=new _fc.a(_j.a.a(t,[0,2,0,0]));var u=new _fc.a(_j.a.a(t,[0,1,1]));var e=new _b.W(_j.a.a(t,[0,1,0]));var r=new _j.i(_j.a.a(t,[0,1]));var i=new _fce.h(_j.a.a(t,[0,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));i.d("Loading preview");return new _j.a(t,[i,r,e,u,f])},"",_uh.f,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a);var f="ContentSuggestionsPopupView";new _j.d(f,function(){_uh.a.a[f]===undefined&&(_uh.a.a[f]=[[[-1,4,null,null,null,"BusyText",null,_uh.a.T,0,null,null,null,_nbs.a.tB],[-1,4,null,null,null,"SpinnerSize",null,_uh.a.t,0,null,null,0,0],[-1,0,["IsLoadingSuggestions"],[_uh.a.r],null,"IsHidden",null,_uh.a.b,1,_uh.a.e(),null,!0],[-1,0,["IsLoadingSuggestions"],[_uh.a.r],null,"IsBusy",null,_uh.a.U,1,_uh.a.e(),null,!1]],[[-1,0,["IsLoadingSuggestions"],[_uh.a.r],null,"IsHidden",null,_uh.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_uh.a.g,0,null,null,null,_nbs.a.CM]],[[-1,4,null,null,null,"Text",null,_uh.a.g,0,null,null,null,_nbs.a.jD],[-1,0,["ContentSuggestionViewModels"],[_uh.a.E],null,"IsHidden",null,_uh.a.b,1,new _j.r([_uh.a.h(),_uh.a.e()],[null,null]),null,!0]],[[-1,0,["ContentSuggestionViewModels"],[_uh.a.E],null,"DataSource",null,_uh.a.y,1,null,null,null]],[[-1,1,["DataContext"],[_uh.a.p],null,"DataContext",null,_uh.a.j,1,null,null,null],[0,0,["FindATimeCommand"],[_uh.a.q],null,"IsHidden",null,_uh.a.b,1,new _j.r([_uh.a.h(),_uh.a.e()],[null,null]),null,!0]],[[-1,0,["FeedbackPopupViewModel"],[_uh.a.n],null,"DataContext",null,_uh.a.j,1,null,null,null],[0,0,["ShouldShowFeedback"],[_uh.a.I],null,"IsHidden",null,_uh.a.b,1,_uh.a.e(),null,!0]],[[-1,0,["FeedbackPopupViewModel","FeedbackDialogViewModel"],[_uh.a.n,_uh.a.G],null,"DataContext",null,_uh.a.j,1,null,null,null],[0,0,["IsShown"],[_uh.a.o],null,"IsHidden",null,_uh.a.b,1,_uh.a.e(),null,!0],[0,0,["IsShown"],[_uh.a.o],_uh.a.Q,"IsShown",_uh.a.z,_uh.a.B,2,null,null,!1],[0,0,["Title"],[_uh.a.P],null,"DialogTitle",null,_uh.a.w,1,null,null,null],[0,0,["CloseCommand"],[_uh.a.L],null,"CloseCommand",null,_uh.a.A,1,null,null,null],[0,0,["ContentDataContext"],[_uh.a.M],null,"ContentDataContext",null,_uh.a.v,1,null,null,null],[0,0,["FooterButtons"],[_uh.a.N],null,"ButtonDataList",null,_uh.a.u,1,null,null,null],[0,0,["ParentProjectionWindow"],[_uh.a.O],null,"ParentProjectionWindow",null,_uh.a.x,1,null,null,null]]]);var n=_uh.a.c.childNodes[8].cloneNode(!0);var i=new _fce.o(n.children[1],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.c("FeedbackDialogView");i.q(!0);var u=new _j.c(_j.a.a(n,[0,4]));u.y("AutoHighlightSentencePopupView.FeedbackView");var e=new _j.c(_j.a.a(n,[0,3]));e.y("KeyPointPopupView");var t=new _fce.a(_j.a.a(n,[0,2,2]),_j.b.Instance.a(_ff.a));t.bf("div");t.u("ContentSuggestionsPopupView.ContentView");t.y("ContentSuggestionsPopupView._tid2");var o=new _fc.a(_j.a.a(n,[0,2,1]));var h=new _fc.a(_j.a.a(n,[0,2,0]));var s=new _j.i(_j.a.a(n,[0,2]));var r=new _fce.h(_j.a.a(n,[0,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));r.a=0;return new _j.a(n,[r,s,h,o,t,e,u,i])},"",_uh.j,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a);var u="FeedbackDialogView";new _j.d(u,function(){_uh.a.a[u]===undefined&&(_uh.a.a[u]=[[[-1,4,null,null,null,"Title",null,_uh.a.C,0,null,null,null,_u.n.Da],[-1,0,["MaxCharLength"],[_uh.a.bj],null,"MaxLength",null,_uh.a.Y,1,null,null,0],[-1,0,["FeedbackText"],[_uh.a.bi],_uh.a.bk,"Text",_uh.a.X,_uh.a.Z,2,null,null,null]]]);var n=_uh.a.c.childNodes[9].cloneNode(!0);var t=new _fce.q(n.children[0]);return new _j.a(n,[t])},"",_uh.n,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a);var r="KeyPointPopupView";new _j.d(r,function(){_uh.a.a[r]===undefined&&(_uh.a.a[r]=[[[-1,4,null,null,null,"ImageId",null,_uh.a.i,0,null,null,null,_mco.s.a()],[-1,4,null,null,null,"Text",null,_uh.a.f,0,null,null,null,_nbs.a.pF],[-1,0,["ReplyWithQuoteCommand"],[_uh.a.J],null,"ClickCommand",null,_uh.a.d,1,null,null,null],[-1,0,["ReplyWithQuoteCommand"],[_uh.a.J],null,"IsHidden",null,_uh.a.b,1,_uh.a.h(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_uh.a.i,0,null,null,null,_mco.s.e()],[-1,4,null,null,null,"Text",null,_uh.a.f,0,null,null,null,_nbs.a.Hi],[-1,0,["RemoveCommand"],[_uh.a.bs],null,"ClickCommand",null,_uh.a.d,1,null,null,null]]]);var n=_uh.a.c.childNodes[10].cloneNode(!0);var i=new _fc.b(_j.a.a(n,[0,1,1]));i.k("ms-fcl-tp _uh_N");var t=new _fc.b(_j.a.a(n,[0,1,0]));t.k("ms-fcl-tp _uh_N");return new _j.a(n,[t,i])},"",_uh.u,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_uh.a.a)};_uh.b.registerClass("_uh.b",null,Sys.IDisposable);_uh.h.registerClass("_uh.h",_a.bu,_b.cl,Sys.IDisposable);_uh.s.registerClass("_uh.s");_uh.u.registerClass("_uh.u",_a.gb);_uh.e.registerClass("_uh.e",_uh.u);_uh.t.registerClass("_uh.t",_j.bV);_uh.o.registerClass("_uh.o",_a.bu);_uh.n.registerClass("_uh.n",_bc.o);_uh.p.registerClass("_uh.p",null,Sys.IDisposable);_uh.v.registerClass("_uh.v");_uh.m.registerClass("_uh.m",_h.cH);_uh.j.registerClass("_uh.j",_uh.e);_uh.f.registerClass("_uh.f",_a.bu);_uh.k.registerClass("_uh.k",_h.dr.$$(_g.ex,_g.dA));_uh.l.registerClass("_uh.l");_uh.g.registerClass("_uh.g");UserHighlightingComponent.registerClass("UserHighlightingComponent",null,_a.jv,_j.ce);UserHighlightingFactory.registerClass("UserHighlightingFactory",null,_mco.P);_uh.r.registerClass("_uh.r",_a.bu,_b.cl,Sys.IDisposable,_b.cj);_uh.w.registerClass("_uh.w",_uh.u);_uh.i.registerClass("_uh.i",_mco.l);_uh.b.a=new RegExp("ExtractionId=([\\w\\-]+);");_uh.b.c=[1,2,4,8];_uh.h.a=new RegExp("\\s","g");UserHighlightingComponent.$$cctor();_uh.a.c=_uh.a.S();_uh.a.m=null;_uh.a.l=null;_uh.a.k=null;_uh.a.a={};_uh.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.userhighlighting.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.userhighlighting.js'] = (new Date()).getTime();
