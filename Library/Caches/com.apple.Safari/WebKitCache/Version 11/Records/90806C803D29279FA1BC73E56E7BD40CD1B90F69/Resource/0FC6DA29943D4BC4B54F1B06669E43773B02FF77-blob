define("./layout/logged-in/logged-in",["jquery","backbone","underscore","aui/flag","aui/soy","internal/browser-metrics","aui","require","momenttz","moment"],function(e,t,n,i,o,r,a,s,l,c){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{userManagedStatus:{}},t=e.user,n=e.changeEmailUrl,i=e.changeEmailRestUrl,o=e.newEmail,r=e.csrfToken,s=e.userManagedStatus,l=void 0===s?{}:s,c=e.googleId,u=e.continueUrl,d=e.isCloud,f=e.showSuccess,p=e.elevatedSession,h=e.services;(0,g.default)(document).on("avatarChanged",function(e,t){var n=t.indexOf("?")>-1?"&":"?";(0,g.default)(".aui-page-header-image .aui-avatar img").attr("src",t+n+"s=128")}).on("loggedOut",function(e,t){new N.default({message:t})}).on("click",".aid-nav-trigger",function(){return(0,g.default)(document.body).toggleClass(V)});var m=new A.default(t,{baseUrl:(0,x.default)("management.url"),parse:!0});m.userManagedStatus=l,m.googleId=c,m.changeEmailUrl=n,m.continueUrl=u,m.isCloud=d,m.csrfHeaderName="X-CSRF-TOKEN",m.csrfToken=r,m.elevatedSession=p;var v=new j.ServiceCollection(h),_=new y.default({newEmail:o,csrfToken:r,userManagedStatus:l},{changeEmailUrl:i}),b=[R,R+"/","profile/profile.action"],w=new z({userModel:m,changeEmailModel:_,servicesCollection:v,defaultRoutes:b}),S="/";E.default.history.start({pushState:!0,hashChange:!1,root:S}),f&&_.trigger("showSuccess"),(0,g.default)(document).on("click","a",a(w,S,b))}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return function(i){var o=i.currentTarget,r=c(o.href,t),a=u(r);!(e.routes[a]||n.indexOf(a)>-1)||s(i)||l(r)||(i.preventDefault(),e.navigate(r,{trigger:!0}),(0,g.default)(o).blur())}}function s(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey}function l(e){return 0===e.replace(E.default.history.fragment,"").indexOf("#")}function c(e,t){var n=e.replace(L,"");return n.indexOf(t)>-1?n.substr(n.indexOf(t)+t.length):e}function u(e){return e.replace(H,"$1")}Object.defineProperty(t,"__esModule",{value:!0}),t.Sidebar=t.LoggedInRouter=t.NAV_OPEN_CLASS=t.ACCOUNT_SETTINGS_ROUTE=t.CHANGE_EMAIL_ROUTE=void 0;var d,f,p=n(53);Object.defineProperty(t,"CHANGE_EMAIL_ROUTE",{enumerable:!0,get:function(){return p.CHANGE_EMAIL_KEY}});var h=n(72);Object.defineProperty(t,"ACCOUNT_SETTINGS_ROUTE",{enumerable:!0,get:function(){return h.ACCOUNT_SETTINGS_KEY}}),t.onReady=r,t.interceptClicksToKnownRoutes=a,t.isModifierKeyPressed=s,t.isHashChangeOnly=l,t.stripRoot=c,t.extractPath=u,n(121);var m=n(57),g=i(m),v=n(123),y=i(v),_=n(64),b=i(_),w=n(59),E=i(w),S=n(119),x=i(S),C=n(71),T=n(88),k=i(T),P=n(124),A=i(P),O=n(125),F=n(136),M=n(143),D=n(148),j=n(139),$=n(207),N=i($),I=n(70),U=i(I),R=k.default.replace(/^\//,""),H=/^([^\?#]*).*$/g,L=/^https?:\/\//,V=t.NAV_OPEN_CLASS="aid-nav-open",z=t.LoggedInRouter=E.default.Router.extend((f={routes:(d={},o(d,R+"/account-settings",h.ACCOUNT_SETTINGS_KEY),o(d,R+"/change-email",p.CHANGE_EMAIL_KEY),o(d,R+"/change-password",O.CHANGE_PASSWORD_KEY),o(d,R+"/close-account",F.CLOSE_ACCOUNT_KEY),o(d,R+"/billing",M.BILLING_KEY),o(d,R+"/two-step-verification",D.TWO_STEP_KEY),d),initialize:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userModel,i=t.changeEmailModel,o=t.servicesCollection,r=t.defaultRoutes,a=void 0===r?[]:r;this.sidebar=new B,this.userModel=n,this.changeEmailModel=i,this.servicesCollection=o,this.isInitialRoute=!0,a.forEach(function(t){return e.route(t,h.ACCOUNT_SETTINGS_KEY)})},execute:function(e,t,n){this.isInitialRoute?this.isInitialRoute=!1:U.default.start({key:"aid."+n}),this._setSidebarSelection(n),this.currentPage&&this.currentPage.teardown(),(0,g.default)(document.body).removeClass(V),this._displayChangeEmailVerificationFlag(n),e&&e.apply(this,t)}},o(f,h.ACCOUNT_SETTINGS_KEY,function(){this.currentPage=new h.AccountSettingsPage(this.userModel)}),o(f,p.CHANGE_EMAIL_KEY,function(){this.currentPage=new p.ChangeEmailPage(this.userModel,this.changeEmailModel)}),o(f,O.CHANGE_PASSWORD_KEY,function(){this.currentPage=new O.ChangePasswordPage(this.userModel)}),o(f,F.CLOSE_ACCOUNT_KEY,function(){this.currentPage=new F.CloseAccountPage(this.userModel,this.servicesCollection),this.servicesCollection=this.currentPage.model}),o(f,M.BILLING_KEY,function(){this.currentPage=new M.BillingPage(this.userModel)}),o(f,D.TWO_STEP_KEY,function(){this.currentPage=new D.TwoStepVerificationPage(this.userModel)}),o(f,"_setSidebarSelection",function(e){var t=this,n=Object.keys(this.routes).find(function(n){return""!==n&&t.routes[n]===e});n&&this.sidebar.deselect().select(n)}),o(f,"_displayChangeEmailVerificationFlag",function(e){this.changeEmailModel.get(_.NEW_EMAIL)&&(e===p.CHANGE_EMAIL_KEY&&this.changeEmailVerificationFlag?(this.changeEmailVerificationFlag.el.close(),delete this.changeEmailVerificationFlag):e===p.CHANGE_EMAIL_KEY||this.changeEmailVerificationFlag||(this.changeEmailVerificationFlag=new b.default({model:this.changeEmailModel,waitingVerificationTitle:(0,C.getText)("change-email.pending.flag.title"),resentTitle:(0,C.getText)("change-email.resent.title")}),this.changeEmailVerificationFlag.render()))}),f)),B=t.Sidebar=E.default.View.extend({el:".aid-sidebar",selectedClass:"aui-nav-selected",deselect:function(){return this.$el.find("."+this.selectedClass).removeClass(this.selectedClass),this},select:function(e){return this.$el.find("a").filter('[href*="'+e+'"]').closest("li").addClass(this.selectedClass),this}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChangeEmailPage=t.CHANGE_EMAIL_KEY=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n(54);var l=n(56),c=i(l),u=n(62),d=i(u),f=n(67),p=n(69),h=i(p),m=n(71),g=t.CHANGE_EMAIL_KEY="change-email";t.ChangeEmailPage=function(e){function t(e,n){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,f.changeEmailPanel,e,n))}return a(t,e),s(t,[{key:"onRendered",value:function(){var e=this.model,t=new c.default({el:"#change-email-form",model:e});t.enableForm().focusFirstField();var n=new l.VerificationMessage({el:"#change-email-pending",model:e,resentTitle:(0,m.getText)("change-email.resent.title")});this.views.push(t,n),e.once("showSuccess",function(){(0,d.default)({type:"success",title:(0,m.getText)("change-email.success.flag.title"),close:"auto"})})}},{key:"templateData",value:function(){return Object.assign(this.model.toJSON(),{userName:this.user.get("email")})}},{key:"metricsPageKey",get:function(){return g}}]),t}(h.default)},function(e,t){},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.VerificationMessage=void 0;var r=n(57),a=i(r),s=n(58),l=i(s),c=n(64),u=i(c),d=n(67);t.VerificationMessage=u.default.extend({template:d.changeEmailVerificationMessage,render:function(){return this.$el.html((0,a.default)(this.template(this.model.toJSON())).html()),this.model.get(c.NEW_EMAIL)?this.$el.show().find("a").first().focus():this.$el.hide(),this}});t.default=l.default.extend({template:d.changeEmailForm,initialize:function(e){this.listenTo(this.model,"destroy",this.handleDestroy),l.default.prototype.initialize.call(this,e)},handleError:function(e,t){var n=e.get(c.NEW_EMAIL);e.unset(c.NEW_EMAIL),this.render(Object.assign(o({},c.NEW_EMAIL,n),this.getErrorsFromFailedResponse(t))).focusFirstError()},handleSuccess:function(e){e.get(c.NEW_EMAIL)?this.render().$el.hide():(this.render().$el.show(),this.focusFirstField())},handleDestroy:function(){this.$("#"+c.NEW_EMAIL).val(""),this.disableForm(),this.$el.show()}})},function(t,n){t.exports=e},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(59),r=i(o),a=n(57),s=i(a),l=n(60),c=i(l),u=n(61),d=i(u),f=n(62),p=i(f),h=n(63),m=i(h);t.default=r.default.View.extend({events:{submit:"save"},initialize:function(e){e=e||{},this.options=e,this.successTitle=e.successTitle,e.fetchOnInit?this.fetch().done(c.default.bind(function(){this.render().focusFirstField(),this.listenTo(this.model,"sync",this.handleSuccess)},this)):this.listenTo(this.model,"sync",this.handleSuccess),this.listenTo(this.model,"error",this.handleError)},render:function(e){return this.$el.html((0,s.default)(this.template(c.default.extend(this.getAttributesForTemplate(),e))).html()),this},handleError:function(e,t,n){this.render(this.getErrorsFromFailedResponse(t)).focusFirstError()},handleSuccess:function(e,t,n){this.options.continueUrl?this.redirectToContinueUrl():(this.render(),this.successTitle&&(0,p.default)({type:"success",title:this.successTitle,close:"auto"}))},redirectToContinueUrl:function(){location.href=m.default.addUrlParameters(this.options.continueUrl,{"aid-success":!0,"aid-message":this.options.eventName})},save:function(e,t){e.preventDefault();var n=this.serializeForm();this.disableForm(),this.model.save(n,c.default.extend(d.default,t))},serializeForm:function(){var e={};return c.default.each(this.$el.serializeArray(),function(t){e[t.name]=t.value}),e},focusFirstField:function(){this.$(":input").eq(0).focus()},focusFirstError:function(){this.$(".error").eq(0).prevAll(":input").eq(0).focus()},disableForm:function(){this.$(":input").prop("disabled",!0).attr("aria-disabled","true")},enableForm:function(){return this.$(":input").prop("disabled",!1).removeAttr("aria-disabled"),this},fetch:function(e){return this.disableForm(),this.model.fetch(Object.assign({cache:!1},d.default,e))},getAttributesForTemplate:function(){return this.model.toJSON()},getErrorsFromFailedResponse:function(e){var t={};try{var n=s.default.parseJSON(e.responseText);t.fieldErrors=c.default.object(this.asAUIFieldErrors(this.parseFieldErrorsForTemplate(n.fieldErrors))),t.formErrors=n.formErrors||n.error&&[n.error]}catch(n){var i=(0,s.default)(s.default.parseHTML(e.responseText));t.formErrors=[i.find("u").eq(0).text()||"Something went wrong while trying to contact the server. Please refresh the page and try again."]}return t},parseFieldErrorsForTemplate:function(e){return e},asAUIFieldErrors:function(e){return c.default.map(e,function(e,t){return[t,[e]]})}}),e.exports=t.default},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={xhrFields:{withCredentials:!0}},e.exports=t.default},function(e,t){e.exports=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(57),r=i(o);t.default={addUrlParameters:function(e,t){var n=e.indexOf("?")>-1?"&":"?";return e.indexOf("#")>-1?e.substring(0,e.indexOf("#"))+n+r.default.param(t)+e.substring(e.indexOf("#")):e+n+r.default.param(t)}},e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.NEW_EMAIL=void 0;var o=n(59),r=i(o),a=n(62),s=i(a),l=n(65),c=t.NEW_EMAIL="newEmail";t.default=r.default.View.extend({template:l.flagContent,events:{"click .change-email-resend":"resend","click .change-email-undo":"undo"},initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options=e,this.listenTo(this.model,"sync",this.render)},render:function(){return this.$el.hasClass("aui-flag")||this.setElement((0,s.default)({type:"warning",title:this.options.waitingVerificationTitle,body:this.template(this.model.toJSON()),close:"never"})),this.model.get(c)||this.el.close(),this},resend:function(e){e.preventDefault(),this.model.save(),(0,s.default)({type:"success",title:this.options.resentTitle,close:"auto"})},undo:function(e){e.preventDefault(),this.model.unset(c),this.model.destroy(),this.render()}})},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};"undefined"==typeof o.changeEmailVerification&&(o.changeEmailVerification={}),o.changeEmailVerification.flagContent=function(e,t){return""+(e.userManagedStatus.managed?soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format("Your administrator has requested that you change your email address. Please check your email <strong>{0}</strong> and follow the instructions to complete the update.","number"==typeof(null!=e.newEmail?e.newEmail:"")?null!=e.newEmail?e.newEmail:"":soy.$$escapeHtml(null!=e.newEmail?e.newEmail:"")))):soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format("Please check your email <strong>{0}</strong> and click the link we sent to verify it''s you and complete the update.","number"==typeof(null!=e.newEmail?e.newEmail:"")?null!=e.newEmail?e.newEmail:"":soy.$$escapeHtml(null!=e.newEmail?e.newEmail:"")))))+o.changeEmailVerification.actions(e)},(!1).DEBUG&&(o.changeEmailVerification.flagContent.soyTemplateName="widget.changeEmailVerification.flagContent"),o.changeEmailVerification.actions=function(e,t){return'<ul class="aui-nav-actions-list"><li><a href="#" class="change-email-resend">'+soy.$$escapeHtml("Resend email")+"</a></li>"+(e.userManagedStatus.managed?"":'<li><a href="#" class="change-email-undo">'+soy.$$escapeHtml("Undo email change")+"</a></li>")+"</ul>"},(!1).DEBUG&&(o.changeEmailVerification.actions.soyTemplateName="widget.changeEmailVerification.actions"),e.exports=o.changeEmailVerification},function(e,t){e.exports=o},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};if("undefined"==typeof o.aui&&(o.aui={}),"undefined"==typeof o.aui.form&&(o.aui.form={}),o.aui.form=Object.assign(o.aui.form||{},n(68)),"undefined"==typeof o)var o={};if("undefined"==typeof o.changeEmailVerification&&(o.changeEmailVerification={}),o.changeEmailVerification=Object.assign(o.changeEmailVerification||{},n(65)),"undefined"==typeof r)var r={};if(r=Object.assign(r||{},n(67)),"undefined"==typeof r)var r={};if(r=Object.assign(r||{},n(67)),"undefined"==typeof r)var r={};r.changeEmailForm=function(e,t){return""+i.form.form({id:"change-email-form",action:"",content:""+o.aui.form.formErrors(e)+i.form.emailField({id:"newEmail",labelContent:""+soy.$$escapeHtml("New email address"),value:e.newEmail,isAutofocus:!e.fieldErrors||(null==e.fieldErrors?null:e.fieldErrors.newEmail),errorTexts:null==e.fieldErrors?null:e.fieldErrors.newEmail,isDisabled:e.isDisabled})+i.form.input({id:"csrfToken",type:"hidden",value:e.csrfToken})+i.form.buttons({content:""+i.form.submit({text:"Change email",type:"primary",isDisabled:e.isDisabled})}),extraAttributes:e.extraAttributes})},(!1).DEBUG&&(r.changeEmailForm.soyTemplateName="feature.changeEmailForm"),r.changeEmailVerificationMessage=function(e,t){return""+i.message.warning({id:"change-email-pending",titleContent:""+soy.$$escapeHtml("Update pending verification"),content:""+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format("We just need you to check your email <strong>{0}</strong> and confirm your password to verify it''s you and complete the update.","number"==typeof(null!=e.newEmail?e.newEmail:"")?null!=e.newEmail?e.newEmail:"":soy.$$escapeHtml(null!=e.newEmail?e.newEmail:""))))+o.changeEmailVerification.actions(e),extraAttributes:e.extraAttributes})},(!1).DEBUG&&(r.changeEmailVerificationMessage.soyTemplateName="feature.changeEmailVerificationMessage"),r.changeEmailPanel=function(e,t){return"<h2>"+soy.$$escapeHtml("Change email address")+"</h2><p>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format("Your email address is currently <strong>{0}</strong>.","number"==typeof e.userName?e.userName:soy.$$escapeHtml(e.userName))))+"</p>"+(e.userManagedStatus.managed?i.message.warning({id:"change-email-not-allowed",titleContent:"Managed account",content:e.userManagedStatus.orgMember?soydata.VERY_UNSAFE.ordainSanitizedHtml("Your account is managed by your organization.<br>Contact your organization administrator to change your email address."):"Google"==e.userManagedStatus.type?soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format("Your account is managed by {0}.<br>Contact your {0} administrator to change your email address.",soy.$$escapeHtml("Google"))):soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('Your account is managed by <a href="{0}">{1}</a>.<br>Contact the administrator to change your email address.',"number"==typeof e.userManagedStatus.cloudUrl?e.userManagedStatus.cloudUrl:soy.$$escapeHtml(e.userManagedStatus.cloudUrl),"number"==typeof e.userManagedStatus.cloudUrlText?e.userManagedStatus.cloudUrlText:soy.$$escapeHtml(e.userManagedStatus.cloudUrlText)))}):r.changeEmailForm({newEmail:e.newEmail,extraAttributes:e.newEmail?{style:"display: none;"}:[],csrfToken:e.csrfToken}))+r.changeEmailVerificationMessage({newEmail:e.newEmail,userManagedStatus:e.userManagedStatus,extraAttributes:e.newEmail?[]:{style:"display: none;"}})},(!1).DEBUG&&(r.changeEmailPanel.soyTemplateName="feature.changeEmailPanel"),e.exports=r},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};"undefined"==typeof o.aui&&(o.aui={}),"undefined"==typeof o.aui.form&&(o.aui.form={}),o.aui.form.formErrors=function(e,t){e=e||{};var n="";if(e.formErrors)for(var o=e.formErrors,r=o.length,a=0;a<r;a++){var s=o[a];n+=i.message.error({content:s})}return n},(!1).DEBUG&&(o.aui.form.formErrors.soyTemplateName="widget.aui.form.formErrors"),e.exports=o.aui.form},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(57),s=i(a),l=n(61),c=i(l),u=n(68),d=n(70),f=i(d),p=function(){function e(t,n,i){var r=this;o(this,e),this.template=t,this.user=n,this.model=i,this.$el=(0,s.default)(".aui-page-panel-content"),this.views=[],this.fetchOnInit()&&this.model?this.model.fetch(Object.assign({cache:!1},c.default)).done(function(){return r.render()}).fail(function(e){return r.renderError(e)}):this.render()}return r(e,[{key:"fetchOnInit",value:function(){return!1}},{key:"render",value:function(){var e=this.templateData();this.$el.html(this.template(e)),this.onRendered&&this.onRendered(e),this.metricsPageKey&&f.default.end({key:"aid."+this.metricsPageKey})}},{key:"templateData",value:function(){return this.model?this.model.toJSON():{}}},{key:"teardown",value:function(){this.views.forEach(function(e){return e.remove()})}},{key:"renderError",value:function(e){401===e.status?(0,s.default)(document).trigger("loggedOut"):e.responseJSON&&e.responseJSON.formErrors?this.$el.html((0,u.formErrors)({formErrors:e.responseJSON.formErrors})):this.$el.html((0,u.formErrors)({formErrors:["Something went wrong while trying to contact the server. Please refresh the page and try again."]}))}}]),e}();t.default=p,e.exports=t.default},function(e,t){e.exports=r},function(e,t){"use strict";function n(e,t){return e.replace(/{(\d+)}/g,function(e,n){return t[n]?t[n]:e})}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=t[e];return"undefined"!=typeof r?n(r,i):e}Object.defineProperty(t,"__esModule",{value:!0}),t.getText=i;var o=JSON.parse(document.body.getAttribute("data-i18n"))||{}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.AccountSettingsPage=t.ACCOUNT_SETTINGS_KEY=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=function e(t,n,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,i)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(i)};n(73);var c=n(75),u=i(c),d=n(78),f=i(d),p=n(69),h=i(p),m=n(119),g=i(m),v=n(71),y=n(76),_=n(120),b=i(_),w=n(62),E=i(w),S=/^[#\/]|\s+$/g,x="hashchange",C=t.ACCOUNT_SETTINGS_KEY="account-settings";t.AccountSettingsPage=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,y.accountSettingsPanel,e,e))}return a(t,e),s(t,[{key:"onRendered",value:function(){var e=this.model,t=this.model.csrfToken,n=this.model.userManagedStatus,i=this.model.isCloud?this.model.continueUrl:null,o=this.model.changeEmailUrl,r=new u.default({el:"#account-settings-form",model:e,successTitle:(0,v.getText)("com.atlassian.id.profile.account.success"),userManagedStatus:n,continueUrl:i,changeEmailUrl:o,timezoneOptions:this.getTimezoneOptions(),eventName:"account-settings-updated"});r.enableForm().focusFirstField();var a=new f.default({el:".avatar-panel",emailHash:e.get("emailHash"),csrfHeaderName:"X-CSRF-TOKEN",csrfParameterName:"_csrf",csrfToken:t,baseUrl:(0,g.default)("avatar.base.url"),imgBaseUrl:(0,g.default)("avatar.img.base.url"),continueUrl:"#edit-avatar"===window.location.hash?i:null,eventName:"avatar-updated"});this.profileRouter=function(){var e=location.hash.replace(S,"");""===e?a.closePickerDialog():"edit-avatar"===e?a.openPickerDialog():"verified"===e&&(0,E.default)({type:"success",title:(0,v.getText)("com.atlassian.id.profile.account.verified.title"),body:(0,v.getText)("com.atlassian.id.profile.account.verified.body")})},this.profileRouter(),window.addEventListener(x,this.profileRouter,!1),this.views.push(r,a)}},{key:"templateData",value:function(){var e=this.model.toJSON();return{user:e,avatarUrl:(0,g.default)("avatar.img.base.url")+"/"+e.emailHash,userManagedStatus:this.model.userManagedStatus,continueUrl:this.model.continueUrl,isCloud:this.model.isCloud,changeEmailUrl:this.model.changeEmailUrl,timezoneOptions:this.getTimezoneOptions()}}},{key:"teardown",value:function(){window.removeEventListener(x,this.profileRouter,!1),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"teardown",this).call(this)}},{key:"getTimezoneOptions",value:function(){if(!this.timezoneOptions){var e=["GMT+0","GMT-0","GMT0"],t=function(t){return!(t.startsWith("Etc/")||e.indexOf(t)>=0)},n=b.default.tz.names(),i=n.filter(t).map(function(e){var t=b.default.tz(e),n=t.format("Z"),i=t.utcOffset(),o="(GMT "+n+") "+e;return{value:e,offset:n,offsetInt:i,text:o}}),o=i.sort(function(e,t){var n=e.offsetInt-t.offsetInt;if(0===n){var i=e.value.toUpperCase(),o=t.value.toUpperCase();return i<o?-1:i>o?1:0}return n});this.timezoneOptions=o}return this.timezoneOptions}},{key:"metricsPageKey",get:function(){return C}}]),t}(h.default)},function(e,t){},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(58),r=i(o),a=n(76);t.default=r.default.extend({template:a.accountSettingsForm,getAttributesForTemplate:function(){var e=r.default.prototype.getAttributesForTemplate.apply(this,arguments);return e.changeEmailUrl=this.options.changeEmailUrl,e.userManagedStatus=this.options.userManagedStatus,e.timezoneOptions=this.options.timezoneOptions,e}}),e.exports=t.default},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};if("undefined"==typeof o.aui&&(o.aui={}),"undefined"==typeof o.aui.form&&(o.aui.form={}),o.aui.form=Object.assign(o.aui.form||{},n(68)),"undefined"==typeof r)var r={};if(r=Object.assign(r||{},n(76)),"undefined"==typeof o)var o={};if(o=Object.assign(o||{},n(77)),"undefined"==typeof r)var r={};r.accountSettingsForm=function(e,t){return""+i.form.form({action:"#",id:"account-settings-form",content:""+o.aui.form.formErrors(e)+i.form.fieldGroup({content:""+i.form.label({forField:"email",content:""+soy.$$escapeHtml("Email")})+i.form.value({id:"email",content:""+soy.$$escapeHtml(e.email)})+(e.userManagedStatus.managed?i.form.fieldDescription({text:e.userManagedStatus.orgMember?soydata.VERY_UNSAFE.ordainSanitizedHtml("Your account is managed by your organization.<br>Contact your organization administrator to change your email address."):"Google"==e.userManagedStatus.type?soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format("Your account is managed by {0}.<br>Contact your {0} administrator to change your email address.",soy.$$escapeHtml("Google"))):soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('Your account is managed by <a href="{0}">{1}</a>.<br>Contact the administrator to change your email address.',"number"==typeof e.userManagedStatus.cloudUrl?e.userManagedStatus.cloudUrl:soy.$$escapeHtml(e.userManagedStatus.cloudUrl),"number"==typeof e.userManagedStatus.cloudUrlText?e.userManagedStatus.cloudUrlText:soy.$$escapeHtml(e.userManagedStatus.cloudUrlText))),extraClasses:"account-settings-change-email-not-allowed"}):' <a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(e.changeEmailUrl))+'" class="account-settings-change-email">'+soy.$$escapeHtml("Change email")+"</a>")})+i.form.textField({id:"fullName",labelContent:""+soy.$$escapeHtml("Full name"),value:e.fullName,isRequired:!0,isAutofocus:!0,errorTexts:e.fieldErrors&&e.fieldErrors.fullName?e.fieldErrors.fullName:null,isDisabled:e.isDisabled})+i.form.textField({id:"title",labelContent:""+soy.$$escapeHtml("Job title"),value:e.title,errorTexts:e.fieldErrors&&e.fieldErrors.title?e.fieldErrors.title:null,isDisabled:e.isDisabled})+i.form.textField({id:"org",labelContent:""+soy.$$escapeHtml("Organization"),value:e.org,errorTexts:e.fieldErrors&&e.fieldErrors.org?e.fieldErrors.org:null,isDisabled:e.isDisabled})+i.form.selectField({id:"timezone",labelContent:""+soy.$$escapeHtml("Timezone"),options:e.timezoneOptions,value:e.timezone,isDisabled:e.isDisabled})+i.form.buttons({content:""+i.form.submit({text:"Save",type:"primary",isDisabled:e.isDisabled})+(e.isCloud&&e.continueUrl?i.form.submit({text:"Cancel",type:"link",href:e.continueUrl}):"")})})},(!1).DEBUG&&(r.accountSettingsForm.soyTemplateName="feature.accountSettingsForm"),r.accountSettingsPanel=function(e,t){return"<h2>"+soy.$$escapeHtml("Account settings")+"</h2>"+i.group.group({extraClasses:"account-settings",content:""+i.group.item({content:""+r.accountSettingsForm(soy.$$augmentMap(e.user,{userManagedStatus:e.userManagedStatus,isCloud:e.isCloud,continueUrl:e.continueUrl,changeEmailUrl:e.changeEmailUrl,isDisabled:e.isDisabled,timezoneOptions:e.timezoneOptions}))})+i.group.item({extraClasses:"avatar-panel",content:""+o.userAvatarForm({avatarUrl:e.avatarUrl,withPicker:!0})})})},(!1).DEBUG&&(r.accountSettingsPanel.soyTemplateName="feature.accountSettingsPanel"),e.exports=r},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};o.userAvatarForm=function(e,t){return'<div class="user-avatar-form">'+i.avatar.avatar({size:"xxxlarge",avatarImageUrl:e.avatarUrl,accessibilityText:""})+(e.withPicker?i.buttons.button({text:"Change avatar",type:"link",href:"#edit-avatar",extraClasses:"avatar-picker-trigger",extraAttributes:{type:"button"}}):"")+'<span class="gravatar-notice">'+soy.$$filterNoAutoescape(AJS.format("Current avatar via {0}",'<a href="http://gravatar.com/">Gravatar</a>'))+'</span><div class="avatar-delete-overlay">'+i.icons.icon({icon:"remove",tagName:"button",useIconFont:!0,accessibilityText:"Remove the avatar",extraAttributes:{title:"Remove the avatar",type:"button"},extraClasses:"avatar-delete-trigger"})+"</div></div>"},(!1).DEBUG&&(o.userAvatarForm.soyTemplateName="widget.userAvatarForm"),e.exports=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(59),r=i(o),a=n(60),s=i(a),l=n(57),c=i(l),u=n(79),d=i(u),f=n(81),p=i(f),h=n(82),m=i(h),g=n(58),v=i(g),y=n(61),_=i(y),b=n(63),w=i(b);n(117),t.default=r.default.View.extend({events:{"click .avatar-delete-trigger":"confirmDelete"},initialize:function(e){if(!e.emailHash)throw new Error("Email hash is not provided");e=e||{},s.default.bindAll(this,"restorePreview","save","_onSuccess","_createAvatarUrl"),this.options=e,this.baseUrl=e.baseUrl,this.imgBaseUrl=e.imgBaseUrl||this.baseUrl,this.csrfHeaderName=e.csrfHeaderName,this.csrfParameterName=e.csrfParameterName,this.csrfToken=e.csrfToken,this.$image=this.$(".aui-avatar img"),this.$picker=this.$(".avatar-picker-trigger"),this.emailHash=e.emailHash,this._initDialogs(),this._toggleAvatarSource()},confirmDelete:function(){confirm("Are you sure you want to remove your avatar and default to Gravatar?")&&this._ajax({type:"DELETE"}).then(this._createAvatarUrl).done(this._onSuccess)},openPickerDialog:function(){this.pickerDialog.show()},closePickerDialog:function(){this.pickerDialog.hide()},restorePreview:function(){this.updatePreview(this.oldImage)},save:function(e){this.updatePreview(e),this.upload(e)},updatePreview:function(e){this.oldImage=this.$image.attr("src"),this.$image.attr("src",e)},upload:function(e){var t=new d.default(c.default.extend({},p.default.large,{color:"#fff"})).spin(this.$image.parent()[0]);this.$picker.prop("disabled",!0),this._ajax({type:"POST",data:e,contentType:"text/plain;charset=UTF-8"}).then(this._createAvatarUrl).done(this._onSuccess).fail(this.restorePreview).always(s.default.bind(t.stop,t)).always(s.default.bind(this.$picker.prop,this.$picker,"disabled",!1)).always(s.default.bind(this._redirectToContinueUrl,this))},_ajax:function(e){return e=e||{},this.csrfHeaderName&&this.csrfToken&&(e.beforeSend=s.default.bind(function(e){e.setRequestHeader(this.csrfHeaderName,this.csrfToken)},this)),c.default.ajax(c.default.extend({},_.default,{url:this.baseUrl},e))},_initDialogs:function(){var e=this.baseUrl,t={onCrop:this.save,enableWebcam:!0,csrfParameterName:this.csrfParameterName,csrfToken:this.csrfToken,continueUrl:this.options.continueUrl};e&&(t.baseUrl=e),this.pickerDialog=new m.default(t)},_createAvatarUrl:function(){return this.imgBaseUrl+"/"+this.emailHash+"?t="+(new Date).getTime();
},_onSuccess:function(e){this.refreshAll(e),this._toggleAvatarSource(),this.$el.trigger("avatarChanged",e)},_toggleAvatarSource:function(){var e=this;this._ajax({url:this.baseUrl+"/"+this.emailHash+"/count",cache:!1}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.count,n=void 0===t?0:t;return!!n}).done(function(t){return e.$el.toggleClass("gravatar-source",!t)})},_redirectToContinueUrl:function(){this.options.continueUrl&&v.default.prototype.redirectToContinueUrl.call(this)},refreshAll:function(e){this.$image.attr("src",w.default.addUrlParameters(e,{s:128}))},remove:function(){return this.pickerDialog.remove(),r.default.View.prototype.remove.call(this),this}}),e.exports=t.default},function(e,t,n){var i,o;(function(e){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(a,s){"object"==r(e)&&e.exports?e.exports=s():(i=s,o="function"==typeof i?i.call(t,n,t,e):i,!(void 0!==o&&(e.exports=o)))}(void 0,function(){function e(e,t){var n,i=document.createElement(e||"div");for(n in t)i[n]=t[n];return i}function t(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,i){var o=["opacity",t,~~(100*e),n,i].join("-"),r=.01+n/i*100,a=Math.max(1-(1-e)/t*(100-r),e),s=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=s&&"-"+s+"-"||"";return f[o]||(u.insertRule("@"+l+"keyframes "+o+"{0%{opacity:"+a+"}"+r+"%{opacity:"+e+"}"+(r+.01)+"%{opacity:1}"+(r+t)%100+"%{opacity:"+e+"}100%{opacity:"+a+"}}",u.cssRules.length),f[o]=1),o}function i(e,t){var n,i,o=e.style;if(t=t.charAt(0).toUpperCase()+t.slice(1),void 0!==o[t])return t;for(i=0;i<d.length;i++)if(n=d[i]+t,void 0!==o[n])return n}function o(e,t){for(var n in t)e.style[i(e,n)||n]=t[n];return e}function r(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)void 0===e[i]&&(e[i]=n[i])}return e}function a(e,t){return"string"==typeof e?e:e[t%e.length]}function s(e){this.opts=r(e||{},s.defaults,p)}function l(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}u.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(e,i){function r(){return o(n("group",{coordsize:u+" "+u,coordorigin:-c+" "+-c}),{width:u,height:u})}function s(e,s,l){t(f,t(o(r(),{rotation:360/i.lines*e+"deg",left:~~s}),t(o(n("roundrect",{arcsize:i.corners}),{width:c,height:i.scale*i.width,left:i.scale*i.radius,top:-i.scale*i.width>>1,filter:l}),n("fill",{color:a(i.color,e),opacity:i.opacity}),n("stroke",{opacity:0}))))}var l,c=i.scale*(i.length+i.width),u=2*i.scale*c,d=-(i.width+i.length)*i.scale*2+"px",f=o(r(),{position:"absolute",top:d,left:d});if(i.shadow)for(l=1;l<=i.lines;l++)s(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=i.lines;l++)s(l);return t(e,f)},s.prototype.opacity=function(e,t,n,i){var o=e.firstChild;i=i.shadow&&i.lines||0,o&&t+i<o.childNodes.length&&(o=o.childNodes[t+i],o=o&&o.firstChild,o=o&&o.firstChild,o&&(o.opacity=n))}}var c,u,d=["webkit","Moz","ms","O"],f={},p={lines:12,length:7,width:5,radius:10,scale:1,corners:1,color:"#000",opacity:.25,rotate:0,direction:1,speed:1,trail:100,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",shadow:!1,hwaccel:!1,position:"absolute"};if(s.defaults={},r(s.prototype,{spin:function(t){this.stop();var n=this,i=n.opts,r=n.el=e(null,{className:i.className});if(o(r,{position:i.position,width:0,zIndex:i.zIndex,left:i.left,top:i.top}),t&&t.insertBefore(r,t.firstChild||null),r.setAttribute("role","progressbar"),n.lines(r,n.opts),!c){var a,s=0,l=(i.lines-1)*(1-i.direction)/2,u=i.fps,d=u/i.speed,f=(1-i.opacity)/(d*i.trail/100),p=d/i.lines;!function e(){s++;for(var t=0;t<i.lines;t++)a=Math.max(1-(s+(i.lines-t)*p)%d*f,i.opacity),n.opacity(r,t*i.direction+l,a,i);n.timeout=n.el&&setTimeout(e,~~(1e3/u))}()}return n},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,r){function s(t,n){return o(e(),{position:"absolute",width:r.scale*(r.length+r.width)+"px",height:r.scale*r.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*u+r.rotate)+"deg) translate("+r.scale*r.radius+"px,0)",borderRadius:(r.corners*r.scale*r.width>>1)+"px"})}for(var l,u=0,d=(r.lines-1)*(1-r.direction)/2;u<r.lines;u++)l=o(e(),{position:"absolute",top:1+~(r.scale*r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:c&&n(r.opacity,r.trail,d+u*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&t(l,o(s("#000","0 0 4px #000"),{top:"2px"})),t(i,t(l,s(a(r.color,u),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}}),"undefined"!=typeof document){u=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}();var h=o(e("group"),{behavior:"url(#default#VML)"});!i(h,"transform")&&h.adj?l():c=i(h,"animation")}return s})}).call(t,n(80)(e))},function(e,t){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={small:{lines:12,length:3,width:2,radius:3,trail:60,speed:1.5},medium:{lines:12,length:5,width:3,radius:8,trail:60,speed:1.5},large:{lines:12,length:8,width:4,radius:10,trail:60,speed:1.5}},e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!o.isSupported())throw new Error("This browser doesn't support AvatarPickerDialog.");return this.init(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=n(60),l=i(s),c=n(83),u=i(c),d=n(84),f=n(88),p=i(f),h=n(89),m=(i(h),n(90)),g=i(m);n(115),o.isSupported=function(){return g.default.isSupported()},o.maskShapes=g.default.maskShapes,o.prototype.defaults={dialogId:"avatar-picker-dialog",imageSrc:null,maskShape:null,onCrop:a.default.noop,trigger:null,baseUrl:p.default},o.prototype.init=function(e){return l.default.bindAll(this,"initDialog","_enableDoneButton","_disableDoneButton","_toggleDoneButtonEnabled","chooseAvatar","hide","show"),this.options=a.default.extend(!0,{},this.defaults,e),this.initDialog(),this._toggleDoneButtonEnabled(!1),this.imageUploadAndCrop=new g.default(this.dialog.$el.find(".image-upload-and-crop-container"),{HiDPIMultiplier:1,onCrop:this.options.onCrop,onImageUpload:this._enableDoneButton,onImageUploadError:this._disableDoneButton,onImageClear:this._disableDoneButton,fallbackUploadOptions:{uploadURL:this.options.baseUrl+"?"+a.default.param(l.default.object([this.options.csrfParameterName],[this.options.csrfToken])),uploadFieldName:"avatar",responseHandler:function(e,t){var n=(0,a.default)(e).find("img");n.length?t.resolve(n.attr("src")):t.reject()},cancelTrigger:this.$doneButton.add(this.$cancelButton)},enableWebcam:this.options.enableWebcam}),this.options.trigger&&(this.$trigger=(0,a.default)(this.options.trigger),this.$trigger.click(l.default.bind(function(e){e.preventDefault(),this.show()},this))),this},o.prototype.initDialog=function(){this.dialog=u.default.dialog2((0,d.avatarPickerDialog)({id:this.options.dialogId,imageSrc:this.options.imageSrc,maskShape:this.options.maskShape,enableWebcam:this.options.enableWebcam,continueUrl:this.options.continueUrl})),this.dialog.$el.appendTo("body"),this.$doneButton=this.dialog.$el.find(".avatar-picker-save").on("click",this.chooseAvatar),this.$cancelButton=this.dialog.$el.find(".avatar-picker-cancel")},o.prototype._enableDoneButton=function(){this._toggleDoneButtonEnabled(!0)},o.prototype._disableDoneButton=function(){this._toggleDoneButtonEnabled(!1)},o.prototype._toggleDoneButtonEnabled=function(e){null==e&&(e=null!=this.$doneButton.attr("disabled")),e?this.$doneButton.removeAttr("disabled"):this.$doneButton.attr("disabled","disabled")},o.prototype.chooseAvatar=function(){this.imageUploadAndCrop.crop(),this.options.continueUrl?this._toggleDoneButtonEnabled(!1):window.location.href="#"},o.prototype.hide=function(){this.dialog.hide(),this.imageUploadAndCrop.resetState()},o.prototype.show=function(){this.dialog.show()},o.prototype.remove=function(){this.hide(),this.dialog.remove()},t.default=o,e.exports=t.default},function(e,t){e.exports=a},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};if(o=Object.assign(o||{},n(85)),"undefined"==typeof o)var o={};o.avatarPickerDialog=function(e,t){return""+i.dialog.dialog2({id:e.id,size:"small",titleText:"Upload an avatar",modal:!0,content:""+o.imageUploadAndCrop({imageSrc:e.imageSrc,maskShape:e.maskShape,fallbackDescription:"Up to 1MB in size",enableWebcam:e.enableWebcam}),footerActionContent:""+i.buttons.button({text:"Done",type:"primary",extraClasses:"avatar-picker-save"})+i.buttons.button({text:"Cancel",type:"link",extraClasses:"avatar-picker-cancel",href:e.continueUrl?e.continueUrl:"#"})})},(!1).DEBUG&&(o.avatarPickerDialog.soyTemplateName="widget.avatarPickerDialog"),e.exports=o},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};if(o=Object.assign(o||{},n(86)),"undefined"==typeof o)var o={};if(o=Object.assign(o||{},n(87)),"undefined"==typeof o)var o={};o.imageUploadAndCrop=function(e,t){return e=e||{},'<div class="image-upload-and-crop-container">'+o.imageExplorer(e)+(e.enableWebcam?o.webcamCapture(null):"")+'<form class="aui"><input type="file" id="image-upload-and-crop-upload-field" class="image-upload-field" accept="image/jpeg, image/gif, image/png"/>'+i.buttons.buttons({extraClasses:"input-buttons",content:'<label for="image-upload-and-crop-upload-field" class="image-upload-field-replacement aui-button">'+soy.$$escapeHtml("Upload an image")+"</label>"+(e.enableWebcam?i.buttons.button({text:"Take a photo",extraClasses:"use-webcam",extraAttributes:{type:"button",title:"Use your webcam to take a photo"}}):"")})+(e.enableWebcam?i.buttons.button({text:"Re-take photo",extraClasses:"use-webcam retake-photo hidden",extraAttributes:{type:"button"}}):"")+(e.fallbackDescription?'<div class="description fallback">'+soy.$$escapeHtml(e.fallbackDescription)+"</div>":"")+'<div class="description privacy">'+soy.$$escapeHtml("Your avatar is visible to people using the same Atlassian systems as you and who know your email address.")+"</div></form></div>"},(!1).DEBUG&&(o.imageUploadAndCrop.soyTemplateName="widget.imageUploadAndCrop"),e.exports=o},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};o.imageExplorer=function(e,t){return e=e||{},'<div class="image-explorer-container '+(e.imageSrc?"":"empty")+'"><div class="image-explorer-image-view"><img class="image-explorer-source" '+(e.imageSrc?'src="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(e.imageSrc))+'"':"")+'/><div class="image-explorer-mask '+soy.$$escapeHtmlAttribute(e.maskShape?e.maskShape:"square")+'-mask"></div><div class="image-explorer-drag-delegate"></div></div><div class="image-explorer-scale-slider-wrapper"><input class="image-explorer-scale-slider '+(e.imageSrc?"":"disabled")+'" type="range" min="0" max="100" step="1" value="0" '+(e.imageSrc?"":"disabled")+"/></div></div>"},(!1).DEBUG&&(o.imageExplorer.soyTemplateName="widget.imageExplorer"),e.exports=o},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};o.webcamCapture=function(e,t){return'<div class="webcam-capture"><div class="video-container"><video class="video"></video><div class="countdown hidden"></div></div><div class="video-placeholder"><div class="grant-access"><span class="placeholder-icon"></span><div class="message">'+soy.$$escapeHtml("Grant access to your webcam, usually located at the top of this window.")+"</div></div>"+i.message.warning({extraClasses:"no-access hidden",titleContent:""+soy.$$escapeHtml("We were unable to access your webcam"),content:""+soy.$$filterNoAutoescape(AJS.format("Make sure it is connected. You may also need to grant access to it by clicking on the webcam icon in your browser''s address bar. {0}Retry{1}",'<a class="retry-webcam" href="#">',"</a>"))})+'</div><div class="webcam-buttons">'+i.buttons.button({text:"",iconClass:"icon-take-photo",iconType:"aui",extraClasses:"take-photo"})+"</div></div>"},(!1).DEBUG&&(o.webcamCapture.soyTemplateName="widget.webcamCapture"),e.exports=o},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=document.body.getAttribute("data-context-path")||"",e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(60),r=i(o);t.default={capInt:function(e,t){return parseInt(e,10)<=parseInt(t,10)?String(e):t+"+"},toSentenceCase:function(e){return e+="",e?e.charAt(0).toUpperCase()+e.substring(1):""},camelCaseToHyphenated:function(e){if("string"==typeof e)return e.replace(/([^\s\-_])(?=[A-Z])/g,"$1-").replace(/\s/,"-").toLowerCase()},indent:function(e,t,n){var i="number"==typeof t&&isFinite(t)?t:4,o="string"==typeof n?n:" ";if("string"==typeof e)return i<0?e:new Array(i+1).join(o)+e},unindent:function(e,t,n){var i="number"==typeof t&&isFinite(t)?t:4,o="string"==typeof n?n:" ";if("string"==typeof e){if(i<0)return e;for(;e.charAt(0)===o&&i;)e=e.substring(1),i--;return e}},formatSizeInBytes:function(e){var t=[" bytes","KB","MB","GB","TB","PB"],n=1024,i=0,o=t.length-1;if(e="number"==typeof e?e:parseInt(e,10),isNaN(e))return"";for(;e>=n&&i<o;)e/=n,i++;return e=Math.floor(10*e)/10,e+t[i]},abbreviateText:function(e,t,n){if("string"==typeof e){if(isNaN(t)||t<0||e.length<=t)return e;var i="string"==typeof n?n:"…",o=e.length-t+i.length,r=Math.round(e.length/2);return e.substring(0,r-Math.ceil(o/2))+i+e.substring(r+Math.floor(o/2),e.length)}},endsWith:r.default.isFunction(String.prototype.endsWith)?function(e,t){return e.endsWith(t)}:function(e,t){t=String(t);var n=e.lastIndexOf(t);return n!==-1&&n===e.length-t.length}},e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!o.isSupported())throw new Error("This browser doesn't support ImageUploadAndCrop.");this.init.apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=n(60),l=i(s),c=n(89),u=i(c),d=n(91),f=i(d),p=n(92),h=i(p),m=n(94),g=i(m),v=n(95),y=i(v),_=n(96),b=i(_),w=n(107),E=i(w),S=n(108),x=i(S);n(113),o.isSupported=function(){return f.default.isSupported()},o.prototype.defaults={HiDPIMultiplier:2,dragDropUploadPrompt:"Drag and drop image here",onImageUpload:a.default.noop,onImageUploadError:a.default.noop,onCrop:a.default.noop,outputFormat:"image/png",fallbackUploadOptions:{},initialScaleMode:b.default.scaleModes.containAndFill,scaleMax:1,fileSizeLimit:5242880,maxImageDimension:2e3},o.prototype.init=function(e,t){if(this.options=a.default.extend({},this.defaults,t),this.$container=e,l.default.bindAll(this,"crop","resetState","_onFileProcessed","setImageSrc","validateImageResolution","_onFilesError","_onFileError","_resetFileUploadField","_onErrorReset"),this.imageExplorer=new b.default(this.$container.find(".image-explorer-container"),{initialScaleMode:this.options.initialScaleMode,scaleMax:this.options.scaleMax,onErrorReset:this._onErrorReset}),g.default.isSupported())this.clientFileReader=new g.default({onRead:this._onFileProcessed,onError:this._onFilesError,fileTypeFilter:g.default.typeFilters.imageWeb,fileCountLimit:1,fileSizeLimit:this.options.fileSizeLimit}),this.dragDropFileTarget=new y.default(this.imageExplorer.get$ImageView(),{uploadPrompt:this.options.dragDropUploadPrompt,clientFileHandler:this.clientFileReader});else{this.$container.addClass("filereader-unsupported");var n=a.default.extend({onUpload:this._onFileProcessed,onError:this._onFileError},this.options.fallbackUploadOptions);this.clientFileReader=new h.default(n)}this.uploadIntercepter=new E.default(this.$container.find(".image-upload-field"),{replacementEl:this.$container.find(".image-upload-field-replacement"),clientFileHandler:this.clientFileReader});var i=this.imageExplorer.get$Mask();this.canvasCroppper=new f.default(i.width()*this.options.HiDPIMultiplier,i.height()*this.options.HiDPIMultiplier,{outputFormat:this.options.outputFormat}),this.options.cropButton&&(0,a.default)(this.options.cropButton).click(this.crop),this.$container.find(".webcam-capture").length&&(x.default.isSupported()?this.webcamCapture=this.initWebcamUpload():this.$container.find(".use-webcam").prop("disabled",!0).attr("title","This is not supported for this browser. Try using the latest version of Chrome or Firefox."))},o.prototype.initWebcamUpload=function(){var e=this,t=this.$container.find(".use-webcam"),n=new x.default(this.$container.find(".webcam-capture"),{countdown:!0,mirror:!0,width:640,onCapture:function(t){n.pause(),e.setImageSrc(t),e.$container.removeClass("webcam-mode"),e.$container.find(".retake-photo").removeClass("hidden").focus()}});return t.on("click",function(){e.$container.addClass("webcam-mode"),e.setImageSrc(""),n.start()}),n},o.prototype._resetWebcamUpload=function(){this.webcamCapture&&(this.webcamCapture.stop(),this.$container.removeClass("webcam-mode"),this.$container.find(".retake-photo").addClass("hidden"))},o.prototype.crop=function(){var e=this.imageExplorer.getMaskedImageProperties(),t=this.canvasCroppper.cropToDataURI(this.imageExplorer.get$SourceImage()[0],e.maskedAreaImageX,e.maskedAreaImageY,e.maskedAreaWidth,e.maskedAreaHeight);l.default.isFunction(this.options.onCrop)&&this.options.onCrop(t)},o.prototype.resetState=function(){this.imageExplorer.clearError(),this._resetFileUploadField(),this._resetWebcamUpload(),this.setImageSrc("")},o.prototype._onFileProcessed=function(e){if(e)if(isNaN(this.options.maxImageDimension))this.setImageSrc(e);else{var t=this.validateImageResolution(e);t.done(l.default.bind(function(t,n){this.setImageSrc(e)},this)).fail(l.default.bind(function(e,t){this._onFileError("The selected image size is "+e+"px * "+t+"px. The maximum allowed image size is "+this.options.maxImageDimension+"px * "+this.options.maxImageDimension+"px")},this))}else this._onFileError()},o.prototype.setImageSrc=function(e){this.$container.find(".input-buttons").toggleClass("hidden",!!e),this.imageExplorer.setImageSrc(e),e?this.options.onImageUpload(e):this.options.onImageClear(),this._resetFileUploadField()},o.prototype.validateImageResolution=function(e){var t=a.default.Deferred(),n=new Image,i=this;return n.onload=function(){this.naturalWidth>i.options.maxImageDimension||this.naturalHeight>i.options.maxImageDimension?t.reject(this.naturalWidth,this.naturalHeight):t.resolve(this.naturalWidth,this.naturalHeight)},n.src=e,t},o.prototype._onFilesError=function(e){if(e&&e.bySize&&e.bySize.length){var t=l.default.first(e.bySize);this._onFileError('File "'+u.default.abbreviateText(t.name,50)+'" is '+u.default.formatSizeInBytes(t.size)+" which is larger than the maximum allowed size of "+u.default.formatSizeInBytes(this.options.fileSizeLimit))}else this._onFileError()},o.prototype._onFileError=function(e){var t="There was an error uploading your image",n=e||"Please check that your file is a valid image and try again.";this.imageExplorer.showError(t,n),this._resetFileUploadField(),l.default.isFunction(this.options.onImageUploadError)&&this.options.onImageUploadError(e)},o.prototype._resetFileUploadField=function(){var e=this.$container.find("#image-upload-and-crop-upload-field").prop("form");e&&e.reset()},o.prototype._onErrorReset=function(e){e&&l.default.isFunction(this.options.onImageUpload)&&this.options.onImageUpload(e)},t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!o.isSupported())throw new Error("This browser doesn't support CanvasCropper.");return this.init.apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=function(){var e=document.createElement("canvas");return"function"==typeof e.getContext&&e.getContext("2d")}();o.isSupported=function(){return s},o.prototype.defaults={outputFormat:"image/png",backgroundFillColor:void 0},o.prototype.init=function(e,t,n){return this.width=e,this.height=t||e,this.options=a.default.extend({},this.defaults,n),this.canvas=(0,a.default)("<canvas/>").attr("width",this.width).attr("height",this.height)[0],this},o.prototype.cropToDataURI=function(e,t,n,i,o){return this.crop(e,t,n,i,o).getDataURI(this.options.outputFormat)},o.prototype.crop=function(e,t,n,i,o){var r=this.canvas.getContext("2d"),a=0,s=0,l=this.width,c=this.height;if(r.clearRect(a,s,l,c),this.options.backgroundFillColor&&(r.fillStyle=this.options.backgroundFillColor,r.fillRect(a,s,l,c)),t<0&&(a=Math.round(Math.abs(t)/i*l),t=0),n<0&&(s=Math.round(Math.abs(n)/o*c),n=0),t+i>e.naturalWidth){var u=e.naturalWidth-t;l*=u/i,i=u}if(n+o>e.naturalHeight){var d=e.naturalHeight-n;c*=d/o,o=d}return r.drawImage(e,t,n,i,o,a,s,l,c),this},o.prototype.getDataURI=function(e){return e?this.canvas.toDataURL(e):null},t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return this.init(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=n(60),l=i(s),c=n(79),u=i(c),d=n(81),f=i(d),p=n(93),h=i(p);a.default.extend(o.prototype,h.default.prototype),o.prototype.defaults=a.default.extend({},h.default.prototype.defaults,{uploadURL:"",uploadFieldName:"file",onUpload:a.default.noop,responseHandler:function(e,t){var n;try{n=JSON.parse((0,a.default)(e).html())}catch(e){t.reject()}n?t.resolve(n):t.reject()}}),o.prototype.states={IN_PROGRESS:"IN_PROGRESS",IDLE:"IDLE"},o.prototype.init=function(e){return l.default.bindAll(this,"createHiddenIframe","onIframeLoad","handleFiles","setStateInProgress","setStateIdle","cancelUpload"),this.options=a.default.extend({},this.defaults,e),this.$uploadIframe=this.createHiddenIframe(),this.options.cancelTrigger&&(this.$cancelTrigger=(0,a.default)(this.options.cancelTrigger),this.$cancelTrigger.click(l.default.bind(function(){this.cancelUpload()},this))),this.state=this.states.IDLE,this},o.prototype.createHiddenIframe=function(){return(0,a.default)("<iframe>").attr("name","hidden-upload-iframe").hide().appendTo(document.body).on("load",this.onIframeLoad)},o.prototype.onIframeLoad=function(e){this.state===this.states.IN_PROGRESS&&(this.requestPromise.done(this.options.onUpload).fail(this.options.onError),this.options.responseHandler(e.target.contentDocument.body,this.requestPromise))},o.prototype.handleFiles=function(e,t){if(this.state===this.states.IN_PROGRESS&&this.cancelUpload(),!this.$fileSourceElem){this.$fileSourceElem=(0,a.default)(t),this.$fileSourceElem.attr("name",this.options.uploadFieldName),this.$fileSourceElem.prop("form")||this.$fileSourceElem.wrap("<form>");var n=(0,a.default)(this.$fileSourceElem.prop("form"));n.addClass("hidden-upload-form").attr("action",this.options.uploadURL).attr("method","post").attr("enctype","multipart/form-data").attr("encoding","multipart/form-data").attr("target",this.$uploadIframe.attr("name")),this.$spinner=(0,a.default)('<div class="spinner"></div>').insertBefore(this.$fileSourceElem),a.default.isPlainObject(this.options.extraData)&&l.default.each(this.options.extraData,function(e,t){(0,a.default)('<input type="hidden">').attr("name",t).val(e).appendTo(n)})}this.$fileSourceElem.prop("form").submit(),this.requestPromise=a.default.Deferred(),this.requestPromise.always(this.setStateIdle),this.setStateInProgress()},o.prototype.setStateInProgress=function(){if(this.state=this.states.IN_PROGRESS,this.$spinner){var e=new u.default(f.default.small).spin(this.$spinner[0]);this.$spinner.data("spinner",e)}this.$fileSourceElem&&this.$fileSourceElem.attr("disabled","disabled")},o.prototype.setStateIdle=function(){if(this.state=this.states.IDLE,this.$spinner){var e=this.$spinner.data("spinner");e&&e.stop(),this.$spinner.removeData("spinner")}this.$fileSourceElem&&this.$fileSourceElem.removeAttr("disabled"),this.requestPromise=null},o.prototype.cancelUpload=function(){this.$uploadIframe.remove(),this.setStateIdle(),this.$uploadIframe=this.createHiddenIframe()},t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){return this.init(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=n(60),l=i(s);o.typeFilters={all:/.*/,application:/^application\/.*/,audio:/^audio\/.*/,image:/^image\/.*/,imageWeb:/^image\/(jpeg|png|gif)$/,text:/^text\/.*/,video:/^video\/.*/},o.prototype.defaults={fileTypeFilter:o.typeFilters.all,fileCountLimit:1/0,fileSizeLimit:20971520,onSuccess:a.default.noop,onError:a.default.noop},o.prototype.init=function(e){return this.options=a.default.extend({},this.defaults,e),e&&!e.fileSizeLimit&&(this.options.fileSizeLimit=this.defaults.fileSizeLimit),e&&!e.fileCountLimit&&(this.options.fileCountLimit=this.defaults.fileCountLimit),l.default.bindAll(this,"handleFiles","filterFiles"),this},o.prototype.handleFiles=function(e,t){var n=this.filterFiles(e);n.valid.length>0?l.default.isFunction(this.options.onSuccess)&&this.options.onSuccess(n.valid):l.default.isFunction(this.options.onError)&&this.options.onError(n.invalid)},o.prototype.filterFiles=function(e){var t=l.default.isRegExp(this.options.fileTypeFilter)?this.options.fileTypeFilter:this.defaults.fileTypeFilter,n=this.options.fileSizeLimit,i={byType:[],bySize:[],byCount:[]},o=l.default.filter(e,function(e){return t.test(e.type)?!(e.size>n)||(i.bySize.push(e),!1):(i.byType.push(e),!1)});return o.length>this.options.fileCountLimit&&(i.byCount=o.slice(this.options.fileCountLimit),o=o.slice(0,this.options.fileCountLimit)),{valid:o,invalid:i}},t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(!o.isSupported())throw new Error("ClientFileReader requires FileReaderAPI support");return this.init(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=n(60),l=i(s),c=n(93),u=i(c),d=!!(window.File&&window.FileList&&window.FileReader),f={ArrayBuffer:"readAsArrayBuffer",BinaryString:"readAsBinaryString",DataURL:"readAsDataURL",Text:"readAsText"};o.isSupported=function(){return d},a.default.extend(o.prototype,u.default.prototype),o.readMethods={ArrayBuffer:"ArrayBuffer",BinaryString:"BinaryString",DataURL:"DataURL",Text:"Text"},o.typeFilters=u.default.typeFilters,o.prototype.defaults=a.default.extend({},u.default.prototype.defaults,{readMethod:o.readMethods.DataURL,onRead:a.default.noop}),o.prototype.init=function(e){return l.default.bindAll(this,"onSuccess","readFile"),u.default.prototype.init.call(this,e),this.options.onSuccess=this.onSuccess,this},o.prototype.onSuccess=function(e){var t=l.default.has(f,this.options.readMethod)?f[this.options.readMethod]:void 0;t&&l.default.each(e,l.default.bind(function(e){var n=new FileReader;n.onload=l.default.bind(this.readFile,this,e),n[t](e)},this))},o.prototype.readFile=function(e,t){l.default.isFunction(this.options.onRead)&&this.options.onRead(t.target.result,e)},t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return this.init.apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=n(60),l=i(s);o.prototype.getDefaults=function(){return{activeDropTargetClass:"active-drop-target",uploadPrompt:"Drag a file here to upload",clientFileHandler:null}},o.prototype.init=function(e,t){l.default.bindAll(this,"onDragOver","onDragEnd","onDrop"),this.$target=(0,a.default)(e),this.options=a.default.extend({},this.getDefaults(),t),this.$target.attr("data-upload-prompt",this.options.uploadPrompt),this.$target.on("dragover",this.onDragOver),this.$target.on("dragleave",this.onDragEnd),this.$target.on("dragend",this.onDragEnd),this.$target.on("drop",this.onDrop)},o.prototype.onDragOver=function(e){e.preventDefault(),this.$target.addClass(this.options.activeDropTargetClass)},o.prototype.onDragEnd=function(e){e.preventDefault(),this.$target.removeClass(this.options.activeDropTargetClass)},o.prototype.onDrop=function(e){e.preventDefault(),e.originalEvent.preventDefault(),this.$target.removeClass(this.options.activeDropTargetClass),this.options.clientFileHandler&&this.options.clientFileHandler.handleFiles(e.originalEvent.dataTransfer.files,e.originalEvent.target)},t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){this.init.apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=n(60),l=i(s),c=n(83),u=i(c),d=n(66),f=i(d),p=n(97),h=i(p);n(98),n(102),o.scaleModes={fill:"fill",contain:"contain",containAndFill:"containAndFill"},o.zoomModes={localZoom:"localZoom",imageZoom:"imageZoom"},o.prototype.defaults={initialScaleMode:o.scaleModes.containAndFill,zoomMode:o.zoomModes.localZoom,emptyClass:"empty",scaleMax:1},o.prototype.init=function(e,t){this.$container=e,this.$imageView=this.$container.find(".image-explorer-image-view"),this.$sourceImage=this.$container.find(".image-explorer-source"),this.$mask=this.$container.find(".image-explorer-mask"),this.$dragDelegate=this.$container.find(".image-explorer-drag-delegate"),this.$scaleSlider=this.$container.find(".image-explorer-scale-slider"),this.options=a.default.extend({},this.defaults,t),this.imageProperties={},l.default.bindAll(this,"getImageSrc","setImageSrc","initImage","initDragDelegate","initScaleSlider","setInitialScale","getFillScale","getContainedScale","getCircularContainedScale","sliderValToScale","scaleToSliderVal","updateImageScale","resetImagePosition","resetScaleSlider","toggleEmpty","get$ImageView","get$SourceImage","get$Mask","get$DragDelegate","getMaskedImageProperties","showError","clearError","hasValidImage","_resetFromError","_removeError"),this.toggleEmpty(!0),this.$sourceImage[0].naturalWidth&&(this.toggleEmpty(!1),this.initImage({target:this.$sourceImage[0]})),this.$sourceImage.on("load",this.initImage),this.initDragDelegate(),this.initScaleSlider()},o.prototype.getImageSrc=function(){return this.$sourceImage?this.$sourceImage.attr("src"):void 0},o.prototype.setImageSrc=function(e){this.$sourceImage&&(this.$sourceImage.attr("src",""),e?this.$sourceImage.attr("src",e):this.toggleEmpty(!0))},o.prototype.initImage=function(e){var t=e.target;this.imageProperties.naturalWidth=t.naturalWidth,this.imageProperties.naturalHeight=t.naturalHeight,this._removeError(),this.toggleEmpty(!1),this.setInitialScale()},o.prototype.initDragDelegate=function(){var e;this.$dragDelegate.draggable({start:l.default.bind(function(){e=this.$sourceImage.offset()},this),drag:l.default.bind(function(t,n){this.$sourceImage.offset({top:e.top+n.position.top-n.originalPosition.top,left:e.left+n.position.left-n.originalPosition.left})},this),revert:!0,revertDuration:0})},o.prototype.initScaleSlider=function(){h.default.rescanDocument(),this.$scaleSlider.on("change input",l.default.bind(function(e){this.updateImageScale(this.sliderValToScale(e.target.value))},this))},o.prototype.setInitialScale=function(){var e=this.$mask.width(),t=this.$mask.height(),n=this.imageProperties.naturalWidth,i=this.imageProperties.naturalHeight,r=1;switch(this.minScale=1,this.options.initialScaleMode){case o.scaleModes.fill:this.minScale=r=this.getFillScale(n,i,e,t);break;case o.scaleModes.contain:this.$mask.hasClass("circle-mask")?this.minScale=r=this.getCircularContainedScale(n,i,e/2):this.minScale=r=this.getContainedScale(n,i,e,t);break;case o.scaleModes.containAndFill:this.$mask.hasClass("circle-mask")?this.minScale=this.getCircularContainedScale(n,i,e/2):this.minScale=this.getContainedScale(n,i,e,t),
r=this.getFillScale(n,i,e,t)}this.maxScale=Math.max(r,this.options.scaleMax),this.resetScaleSlider(this.scaleToSliderVal(r)),this.updateImageScale(r,o.zoomModes.imageZoom),this.resetImagePosition()},o.prototype.getFillScale=function(e,t,n,i){var o=n/e,r=i/t;return Math.max(o,r)},o.prototype.getContainedScale=function(e,t,n,i){var o=n/e,r=i/t;return Math.min(o,r)},o.prototype.getCircularContainedScale=function(e,t,n){var i=Math.atan(t/e),o=Math.cos(i)*n*2;return o/e},o.prototype.sliderValToScale=function(e){var t=e/(this.$scaleSlider.attr("max")-this.$scaleSlider.attr("min"));return this.minScale+t*(this.maxScale-this.minScale)},o.prototype.scaleToSliderVal=function(e){var t=(e-this.minScale)/(this.maxScale-this.minScale);return t*(this.$scaleSlider.attr("max")-this.$scaleSlider.attr("min"))},o.prototype.updateImageScale=function(e,t){var n,i,r=Math.round(e*this.imageProperties.naturalWidth),a=Math.round(e*this.imageProperties.naturalHeight);switch(t=t||this.options.zoomMode){case o.zoomModes.imageZoom:n=-1*r/2,i=-1*a/2;break;case o.zoomModes.localZoom:var s=this.$sourceImage.width(),l=this.$sourceImage.height(),c=parseInt(this.$sourceImage.css("margin-left"),10),u=parseInt(this.$sourceImage.css("margin-top"),10),d=this.$sourceImage.position(),f=this.$imageView.width()/2,p=this.$imageView.height()/2,h=f-d.left-c,m=p-d.top-u,g=h/s*r,v=m/l*a;n=f-d.left-g,i=p-d.top-v}this.$sourceImage.width(r).height(a).css({"margin-left":Math.round(n)+"px","margin-top":Math.round(i)+"px"})},o.prototype.resetImagePosition=function(){this.$sourceImage.css({top:"50%",left:"50%"})},o.prototype.resetScaleSlider=function(e){this.$scaleSlider.val(e).removeClass("disabled").removeAttr("disabled"),h.default.updateSlider(this.$scaleSlider.attr("id"))},o.prototype.toggleEmpty=function(e){this.$container.toggleClass(this.options.emptyClass,e)},o.prototype.get$ImageView=function(){return this.$imageView},o.prototype.get$SourceImage=function(){return this.$sourceImage},o.prototype.get$Mask=function(){return this.$mask},o.prototype.get$DragDelegate=function(){return this.$dragDelegate},o.prototype.getMaskedImageProperties=function(){var e=this.$sourceImage.width()/this.imageProperties.naturalWidth,t=this.$sourceImage.height()/this.imageProperties.naturalHeight,n=this.$mask.position(),i=this.$sourceImage.position();return n.top+=parseInt(this.$mask.css("margin-top"),10),n.left+=parseInt(this.$mask.css("margin-left"),10),i.top+=parseInt(this.$sourceImage.css("margin-top"),10),i.left+=parseInt(this.$sourceImage.css("margin-left"),10),{maskedAreaImageX:Math.round((n.left-i.left)/e),maskedAreaImageY:Math.round((n.top-i.top)/t),maskedAreaWidth:Math.round(this.$mask.width()/e),maskedAreaHeight:Math.round(this.$mask.height()/t)}},o.prototype.showError=function(e,t){this._removeError(),this.toggleEmpty(!0),this.$container.addClass("error");var n=(0,a.default)(f.default.message.error({titleContent:u.default.escapeHtml(e),content:t||"",isCloseable:!0}));n.appendTo(this.$imageView).css({"margin-top":-1*n.outerHeight()/2}),n.on("messageClose",this._resetFromError),u.default.messages.setup()},o.prototype.clearError=function(){this._removeError(),this._resetFromError()},o.prototype.hasValidImage=function(){return!(!this.getImageSrc()||!this.$sourceImage.prop("naturalWidth"))},o.prototype._resetFromError=function(){var e=this.hasValidImage();this.toggleEmpty(!e),this.$container.removeClass("error"),l.default.isFunction(this.options.onErrorReset)&&this.options.onErrorReset(e?this.getImageSrc():void 0)},o.prototype._removeError=function(){this.$imageView.find(".aui-message-error").remove()},t.default=o,e.exports=t.default},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e){function t(e){e=!!e,e!=Ye&&(Ye=e,U($()))}function n(e){if(!re||e){try{X(te,-1),g(te,"focus",p),g(te,"blur",h),u?g(te,"keypress",S):(g(te,"keydown",S),g(te,"keypress",E)),g(Q,"mouseover",x),g(Q,"mouseout",C),g(Q,"mousedown",T),g(Q,"touchstart",T),o&&(window.addEventListener&&!window.devicePixelRatio?window.removeEventListener("DOMMouseScroll",w,!1):(g(document,"mousewheel",w),g(window,"mousewheel",w)))}catch(e){}b(Z,"fd-slider-focused"),b(Z,"fd-slider-active"),_(Z,"fd-slider-disabled"),Q.setAttribute("aria-disabled",!0),oe.disabled=re=!0,clearTimeout(Oe),e||f("disable")}}function i(e){(re||e)&&(X(te,0),m(te,"focus",p),m(te,"blur",h),u?m(te,"keypress",S):(m(te,"keydown",S),m(te,"keypress",E)),m(Q,"touchstart",T),m(Q,"mousedown",T),m(Q,"mouseover",x),m(Q,"mouseout",C),b(Z,"fd-slider-disabled"),Q.setAttribute("aria-disabled",!1),oe.disabled=re=qe=!1,e||f("enable"))}function c(){clearTimeout(Oe),ee=ie=te=Q=Z=Oe=null,f("destroy"),be=null}function d(){F();try{var e=Q.offsetWidth,t=Q.offsetHeight,n=te.offsetWidth,i=te.offsetHeight,o=(ie.offsetHeight,ie.offsetWidth,_e?t-i:e-n);Ge=o/me,Ve=Math.max(ge?V(L(ce)):Math.abs((ce-se)/fe)*Ge,0),Le=Math.min(ge?V(L(ue)):Math.abs((ue-se)/fe)*Ge,Math.floor(_e?t-i:e-n)),De=e,Me=t,U(Ce?$():"select"==ae?oe.selectedIndex:parseFloat(oe.value),!1)}catch(e){}f("redraw")}function f(e){if(Ee){if(e.match(/^(blur|focus|change)$/i)){var t;if("undefined"!=typeof document.createEvent)t=document.createEvent("HTMLEvents"),t.initEvent(e,!0,!0),oe.dispatchEvent(t);else if("undefined"!=typeof document.createEventObject)try{t=document.createEventObject(),oe.fireEvent("on"+e.toLowerCase(),t)}catch(e){}}}else if(be.hasOwnProperty(e))for(var n,i={userSet:Ye,disabled:re,elem:oe,value:"select"==ae?oe.options[oe.selectedIndex].value:oe.value},o=0;n=be[e][o];o++)n.call(oe,i)}function p(e){return _(Z,"fd-slider-focused"),s.onfocus&&(Ye=!0,U($())),o&&(m(window,"DOMMouseScroll",w),m(document,"mousewheel",w),u||m(window,"mousewheel",w)),f("focus"),!0}function h(e){b(Z,"fd-slider-focused"),o&&(g(document,"mousewheel",w),g(window,"DOMMouseScroll",w),u||g(window,"mousewheel",w)),Fe=!0,f("blur")}function w(e){if(Fe){e=e||window.event;var t,n=0;e.wheelDelta?(n=e.wheelDelta/120,u&&window.opera.version()<9.2&&(n=-n)):e.detail&&(n=-e.detail/3),_e&&(n=-n),n&&(t=$(),t+=n<0?-fe:fe,Ye=!0,U(N(t))),y(e)}}function E(e){return e=e||window.event,!(e.keyCode>=33&&e.keyCode<=40||!Fe||45==e.keyCode||46==e.keyCode)||v(e)}function S(e){if(!Fe)return!0;e=e||window.event;var t,n=null!==e.keyCode?e.keyCode:e.charCode;return n<33||n>40&&45!=n&&46!=n||(t=$(),37==n||40==n||46==n||34==n?t-=e.ctrlKey||34==n?+pe:+fe:39==n||38==n||45==n||33==n?t+=e.ctrlKey||33==n?+pe:+fe:35==n?t=ue:36==n&&(t=ce),Ye=!0,U(N(t)),f("update"),void y(e))}function x(e){_(Z,"fd-slider-hover")}function C(e){b(Z,"fd-slider-hover")}function T(e){e=e||window.event,y(e);var t;if(e.target?t=e.target:e.srcElement&&(t=e.srcElement),t&&3==t.nodeType&&(t=t.parentNode),e.touches){if(e.targetTouches&&1!=e.targetTouches.length)return!1;e=e.touches[0],qe=!0}if(clearTimeout(Oe),Oe=null,Fe=!1,Ye=!0,t.className.search("fd-slider-handle")!=-1)We=_e?e.clientY:e.clientX,ze=parseInt(_e?te.offsetTop:te.offsetLeft)||0,A(e),qe?(m(document,"touchmove",A),m(document,"touchend",P),g(Q,"mousedown",T)):(m(document,"mousemove",A),m(document,"mouseup",P)),_(Z,"fd-slider-active"),_(document.body,"fd-slider-drag-"+(_e?"vertical":"horizontal")),f("dragstart");else{F();var n=0;e.pageX||e.pageY?n=_e?e.pageY:e.pageX:(e.clientX||e.clientY)&&(n=_e?e.clientY+document.body.scrollTop+document.documentElement.scrollTop:e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft),n-=_e?He+Math.round(te.offsetHeight/2):Re+Math.round(te.offsetWidth/2),n=R(n),"tween"==ye?(_(Z,"fd-slider-active"),D(n)):"timed"==ye?(_(Z,"fd-slider-active"),m(document,qe?"touchend":"mouseup",k),Be=n,M()):I(n)}return!1}function k(e){return e=e||window.event,y(e),g(document,qe?"touchend":"mouseup",k),b(Z,"fd-slider-active"),clearTimeout(Oe),Oe=null,Fe=!0,!1}function P(e){return e=e||window.event,y(e),qe?(g(document,"touchmove",A),g(document,"touchend",P)):(g(document,"mousemove",A),g(document,"mouseup",P)),Fe=!0,b(document.body,"fd-slider-drag-"+(_e?"vertical":"horizontal")),b(Z,"fd-slider-active"),f("dragend"),!1}function A(e){if(e=e||window.event,y(e),e.touches){if(e.targetTouches&&1!=e.targetTouches.length)return!1;e=e.touches[0]}return I(R(ze+(_e?e.clientY-We:e.clientX-We))),!1}function O(e){var t=$();Ye=!0,t+=e*fe,U(N(t))}function F(){var e=0,t=0,n=Q;try{do e+=n.offsetLeft,t+=n.offsetTop;while(n=n.offsetParent)}catch(e){}Re=e,He=t}function M(){var e=parseInt(_e?te.offsetTop:te.offsetLeft,10);e=Math.round(Be<e?Math.max(Be,Math.floor(e-Ge)):Math.min(Be,Math.ceil(e+Ge))),I(R(e)),e!=Be?Oe=setTimeout(M,me>20?50:100):(Fe=!0,b(Z,"fd-slider-active"),f("finalise"))}function D(e){Fe=!1,je=parseInt(e,10),$e=parseInt(_e?te.offsetTop:te.offsetLeft,10),Ne=je-$e,Ie=20,Ue=0,Oe||(Oe=setTimeout(Ke,20))}function j(e){return isNaN(e)||""===e||"undefined"==typeof e?(Ye=!1,Se):e<Math.min(ce,ue)?(Ye=!1,Math.min(ce,ue)):e>Math.max(ce,ue)?(Ye=!1,Math.max(ce,ue)):(Ye=!0,e)}function $(){return N("input"==ae?parseFloat(oe.value):oe.selectedIndex)}function N(e){return isNaN(e)||""===e||"undefined"==typeof e?Se:Math.min(Math.max(e,Math.min(ce,ue)),Math.max(ce,ue))}function I(e){var t=N(ge?H(z(e)):_e?le-Math.round(e/Ge)*fe:se+Math.round(e/Ge)*fe);te.style[_e?"top":"left"]=(e||0)+"px",G(),B("select"==ae||1==fe?Math.round(t):t)}function U(e,t){var n,i=!1;"undefined"!=typeof e&&!isNaN(e)&&""!==e||"input"!=ae||Ce?n=j(e):(n=Se,i=!0,Ye=!1),te.style[_e?"top":"left"]=(ge?V(L(n)):_e?Math.round((le-n)/fe*Ge):Math.round((n-se)/fe*Ge))+"px",G(),typeof t!==!1&&B(i?"":n)}function R(e){if(ge)return Math.max(Math.min(Le,e),Ve);var t=e%Ge;return t&&t>=Ge/2?e+=Ge-t:e-=t,e<Math.min(Math.abs(Ve),Math.abs(Le))?e=Math.min(Math.abs(Ve),Math.abs(Le)):e>Math.max(Math.abs(Ve),Math.abs(Le))&&(e=Math.max(Math.abs(Ve),Math.abs(Le))),Math.min(Math.max(e,0),Le)}function H(e){var t,n=0,i=se;for(var o in ge)ge.hasOwnProperty(o)&&(e>=n&&e<=+o&&(t=i+(e-n)*(+ge[o]-i)/(+o-n)),n=+o,i=+ge[o]);return t}function L(e){var t=0,n=se,i=0;for(var o in ge)ge.hasOwnProperty(o)&&(e>=n&&e<=+ge[o]&&(i=t+(e-n)*(+o-t)/(+ge[o]-n)),t=+o,n=+ge[o]);return i}function V(e){return(Q[_e?"offsetHeight":"offsetWidth"]-te[_e?"offsetHeight":"offsetWidth"])/100*e}function z(e){return e/((Q[_e?"offsetHeight":"offsetWidth"]-Q[te?"offsetHeight":"offsetWidth"])/100)}function B(e){if(f("update"),Ye?b(Z,"fd-slider-no-value"):_(Z,"fd-slider-no-value"),"select"==ae)try{if(e=parseInt(e,10),oe.selectedIndex===e)return void q();oe.options[e].selected=!0}catch(e){}else{if(""===e||Ae||(e=(se+Math.round((e-se)/fe)*fe).toFixed(he)),oe.value===e)return void q();oe.value=e}q(),f("change")}function W(e,t){ce>ue?(e=Math.min(se,Math.max(e,t)),t=Math.max(le,Math.min(e,t)),ce=Math.max(e,t),ue=Math.min(e,t)):(e=Math.max(se,Math.min(e,t)),t=Math.min(le,Math.max(e,t)),ce=Math.min(e,t),ue=Math.max(e,t)),Se<Math.min(ce,ue)?Se=Math.min(ce,ue):Se>Math.max(ce,ue)&&(Se=Math.max(ce,ue)),te.setAttribute("aria-valuemin",ce),te.setAttribute("aria-valuemax",ue),j("input"==ae?parseFloat(oe.value):oe.selectedIndex),d()}function G(){l||(_e?ne.style.height=Math.max(1,ie.offsetHeight-te.offsetTop)+"px":ne.style.width=Math.max(1,te.offsetLeft)+"px")}function Y(){for(var e,t=!1,n=document.getElementsByTagName("label"),i=0;e=n[i];i++)if(e.htmlFor&&e.htmlFor==oe.id||e.getAttribute("for")==oe.id){t=e;break}return t&&!t.id&&(t.id=oe.id+"_label"),t}function q(){var e="select"==ae?oe.options[oe.selectedIndex].value:oe.value,t=ke?ke(e):"select"==ae&&oe.options[oe.selectedIndex].text?oe.options[oe.selectedIndex].text:e;te.setAttribute("aria-valuenow",e),te.setAttribute("aria-valuetext",t)}function K(e){Ye=!0,Ae=Pe,U("input"==ae?parseFloat(oe.value):oe.selectedIndex),q(),Ae=!1}function J(e){"input"==ae?oe.value=oe.defaultValue:oe.selectedIndex=xe,j("select"==ae?oe.options[oe.selectedIndex].value:oe.value),d(),q()}function t(e){Ye=!!e}function X(e,t){e.setAttribute("tabIndex",t),e.tabIndex=t}var Q,Z,ee,te,ne,ie,oe=e.inp,re=!1,ae=oe.tagName.toLowerCase(),se=+e.min,le=+e.max,ce=+e.min,ue=+e.max,de=Math.abs(le-se),fe="select"==ae?1:+e.step,pe=e.maxStep?+e.maxStep:2*fe,he=e.precision||0,me=Math.ceil(de/fe),ge=e.scale||!1,ve=!!e.hideInput,ye=e.animation||"",_e=!!e.vertical,be=e.callbacks||{},we=e.classNames||"",Ee=!!e.html5Shim,Se=le<se?se:se+(le-se)/2,xe="select"==ae?oe.selectedIndex:oe.defaultValue||Se,Ce=Ee||!!e.forceValue,Te=!!(Ee&&_e&&"inpHeight"in e)&&e.inpHeight,ke=!(Ee||!e.ariaFormat)&&e.ariaFormat,Pe=!Ee&&"select"!=ae&&"userSnap"in e&&!!e.userSnap,Ae=!1,Oe=null,Fe=!0,Me=("select"==ae?oe.selectedIndex:oe.value,0),De=0,je=0,$e=0,Ne=0,Ie=0,Ue=0,Re=0,He=0,Le=0,Ve=0,ze=0,Be=0,We=0,Ge=0,Ye=!1,qe=!1;"input"==ae&&Ce&&!oe.defaultValue&&(oe.defaultValue=$()),le<se&&(fe=-Math.abs(fe),pe=-Math.abs(pe)),ge&&(ge[100]=le);var Ke=function e(){Ue++;var t=Ne,n=20,i=Ue,o=$e,r=Math.ceil(i==n?o+t:t*(-Math.pow(2,-10*i/n)+1)+o);I(i==n?je:r),i!=n?(f("move"),Oe=setTimeout(e,20)):(clearTimeout(Oe),Oe=null,Fe=!0,b(Z,"fd-slider-focused"),b(Z,"fd-slider-active"),f("finalise"))};return function(){Ee||ve?_(oe,"fd-form-element-hidden"):m(oe,"change",K),Ee&&(oe.stepUp=function(e){O(e||1)},oe.stepDown=function(e){O(e||-1)}),Q=document.createElement("span"),Q.className="fd-slider"+(_e?"-vertical ":" ")+we,Q.id="fd-slider-"+oe.id,_e&&Te&&(Q.style.height=Te+"px"),Z=document.createElement("span"),Z.className="fd-slider-wrapper"+(Ee?"":" fd-slider-no-value"),ee=document.createElement("span"),ee.className="fd-slider-inner",ie=document.createElement("span"),ie.className="fd-slider-bar",r?te=document.createElement("span"):(te=document.createElement("a"),te.setAttribute("href","#"),m(te,"click",v)),X(te,0),te.className="fd-slider-handle",te.appendChild(document.createTextNode(String.fromCharCode(160))),Z.appendChild(ee),l||(ne=document.createElement("span"),ne.className="fd-slider-range",Z.appendChild(ne)),Z.appendChild(ie),Z.appendChild(te),Q.appendChild(Z),oe.parentNode.insertBefore(Q,oe),u&&(te.unselectable="on",ie.unselectable="on",ee.unselectable="on",Q.unselectable="on",Z.unselectable="on",l||(ne.unselectable="on")),Q.setAttribute("role","application"),te.setAttribute("role","slider"),te.setAttribute("aria-valuemin","select"==ae?oe.options[0].value:se),te.setAttribute("aria-valuemax","select"==ae?oe.options[oe.options.length-1].value:le);var e=Y();e&&(te.setAttribute("aria-labelledby",e.id),te.id="fd-slider-handle-"+oe.id,e.setAttribute("for",te.id)),document.getElementById(a)&&te.setAttribute("aria-describedby",a),1==oe.getAttribute("disabled")||"disabled"==oe.getAttribute("disabled")?n(!0):i(!0),s.onvalue&&(Ye=!0,j("input"==ae?parseFloat(oe.value):oe.selectedIndex)),oe.form&&m(oe.form,"reset",J),q(),f("create"),d()}(),{onResize:function(e){Q.offsetHeight==Me&&Q.offsetWidth==De||d()},destroy:function(){c()},reset:function(){U("input"==ae?parseFloat(oe.value):oe.selectedIndex)},stepUp:function(e){O(Math.abs(e)||1)},stepDown:function(e){O(-Math.abs(e)||-1)},increment:function(e){O(e)},disable:function(){n()},enable:function(){i()},setRange:function(e,t){W(e,t)},getValueSet:function(){return!!Ye},setValueSet:function(e){t(e)},checkValue:function(){s.onvalue&&(Ye=!0,j("input"==ae?parseFloat(oe.value):oe.selectedIndex)),q(),d()}}}var t={},n=0,o=!0,r=!0,a="fd-slider-describedby",s={onfocus:!0,onvalue:!0},l=!1,c="jump",u="[object Opera]"===Object.prototype.toString.call(window.opera),d=/^([\-]{0,1}[0-9]+(\.[0-9]+){0,1})$/,f=/^([0-9]+(\.[0-9]+){0,1})$/,p=function(e){if("string"!=typeof e||""===e)return{};try{if("object"===("undefined"==typeof JSON?"undefined":i(JSON))&&"function"==typeof JSON.parse)return JSON.parse(e);if(/mousewheelenabled|fullaria|describedby|norangebar|html5animation|varsetrules/.test(e.toLowerCase())){var t=Function(["var document,top,self,window,parent,Number,Date,Object,Function,","Array,String,Math,RegExp,Image,ActiveXObject;","return (",e.replace(/<\!--.+-->/gim,"").replace(/\bfunction\b/g,"function-"),");"].join(""));return t()}}catch(e){}return{err:"Could not parse the JSON object"}},h=function(e){if("object"===("undefined"==typeof e?"undefined":i(e)))for(var t in e)switch(value=e[t],t.toLowerCase()){case"mousewheelenabled":o=!!value;break;case"fullaria":r=!!value;break;case"describedby":a=String(value);break;case"norangebar":l=!!value;break;case"html5animation":c=String(value).search(/^(jump|tween|timed)$/i)!=-1?String(value).toLowerCase():"jump";break;case"varsetrules":"onfocus"in value&&(s.onfocus=!!value.onfocus),"onvalue"in value&&(s.onvalue=!!value.onvalue)}},m=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!0):e.attachEvent&&e.attachEvent("on"+t,n)},g=function(e,t,n){try{e.removeEventListener?e.removeEventListener(t,n,!0):e.detachEvent&&e.detachEvent("on"+t,n)}catch(e){}},v=function(e){return e=e||window.event,e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1},y=function(e){return e=e||window.event,e.preventDefault?void e.preventDefault():void(e.returnValue=!1)},_=function(e,t){new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)||(e.className+=(e.className?" ":"")+t)},b=function(e,t){e.className=t?e.className.replace(new RegExp("(^|\\s)"+t+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},w=function(){var e={};for(var n in t)e[n]=t[n].getValueSet();return e},E=function(e,n){t[e].setValueSet(!!n)},S=function(e){return!!(e in t&&t.hasOwnProperty(e))},x=function(n){if(!n||!n.inp||!n.inp.tagName||n.inp.tagName.search(/^input|select/i)==-1)return!1;if(n.html5Shim=!1,"select"==n.inp.tagName.toLowerCase()){if(n.inp.options.length<2)return!1;n.min=0,n.max=n.inp.options.length-1,n.step=1,n.precision=0,n.scale=!1,n.forceValue=!0}else{if(String(n.inp.type).search(/^(text|range)$/i)==-1)return!1;n.min=n.min&&String(n.min).search(d)!=-1?+n.min:0,n.max=n.max&&String(n.max).search(d)!=-1?+n.max:100,n.step=n.step&&String(n.step).search(f)!=-1?n.step:1,n.precision=n.precision&&String(n.precision).search(/^[0-9]+$/)!=-1?n.precision:String(n.step).search(/\.([0-9]+)$/)!=-1?String(n.step).match(/\.([0-9]+)$/)[1].length:0,n.scale=n.scale||!1,n.forceValue="forceValue"in n&&!!n.forceValue,n.userSnap="userSnap"in n&&!!n.userSnap}return n.ariaFormat="ariaFormat"in n&&"function"==typeof n.ariaFormat&&n.ariaFormat,n.maxStep=n.maxStep&&String(n.maxStep).search(f)!=-1?+n.maxStep:2*+n.step,n.classNames=n.classNames||"",n.callbacks=n.callbacks||!1,k(n.inp.id),t[n.inp.id]=new e(n),!0},C=function(e,t){return e.getAttribute(t)||""},T=function(){for(var i,o,r=document.getElementsByTagName("input"),a=0;o=r[a];a++)if("input"==o.tagName.toLowerCase()&&"text"==o.type.toLowerCase()&&(C(o,"min")&&C(o,"min").search(d)!=-1||C(o,"max")&&C(o,"max").search(d)!=-1||C(o,"step")&&C(o,"step").search(/^(any|([0-9]+(\.[0-9]+){0,1}))$/i)!=-1)){if(o.id&&document.getElementById("fd-slider-"+o.id))continue;o.id&&!document.getElementById("fd-slider-"+o.id)&&k(o.id),o.id||(o.id="fd-slider-form-elem-"+n++),i={inp:o,callbacks:[],animation:c,vertical:!!C(o,"data-fd-slider-vertical")||o.offsetHeight>o.offsetWidth,classNames:C(o,"data-fd-slider-vertical"),html5Shim:!0},i.vertical&&!C(o,"data-fd-slider-vertical")&&(i.inpHeight=o.offsetHeight),i.min=C(o,"min")||0,i.max=C(o,"max")||100,i.step=C(o,"step").search(/^any$/i)!=-1?i.max-i.min:C(o,"step").search(f)!=-1?o.getAttribute("step"):1,i.precision=String(i.step).search(/\.([0-9]+)$/)!=-1?String(i.step).match(/\.([0-9]+)$/)[1].length:0,i.maxStep=2*i.step,k(i.inp.id),t[i.inp.id]=new e(i)}return!0},k=function(e){return!!(e in t&&t.hasOwnProperty(e))&&(t[e].destroy(),delete t[e],!0)},P=function(e){for(var n in t)t.hasOwnProperty(n)&&t[n].destroy();t=[]},A=function(e){P(),t=null},O=function(e){for(var n in t)t.hasOwnProperty(n)&&t[n].onResize()},F=function(){M(),T()},M=function(){g(window,"load",T)};return m(window,"load",T),m(window,"load",function(){setTimeout(function(){var e;for(e in t)t[e].checkValue()},0)}),m(window,"resize",O),m(window,"unload",A),function(){var e=document.getElementsByTagName("script"),t=String(e[e.length-1].innerHTML).replace(/[\n\r\s\t]+/g," ").replace(/^\s+/,"").replace(/\s+$/,""),n=p(t);"object"!==("undefined"==typeof n?"undefined":i(n))||"err"in n||h(n)}(),{rescanDocument:T,createSlider:function(e){return x(e)},onDomReady:function(){F()},destroyAll:function(){P()},destroySlider:function(e){return k(e)},redrawAll:function(){O()},addEvent:m,removeEvent:g,stopEvent:v,increment:function(e,n){return!!S(e)&&void t[e].increment(n)},stepUp:function(e,n){return!!S(e)&&void t[e].stepUp(Math.abs(n)||1)},stepDown:function(e,n){return!!S(e)&&void t[e].stepDown(-Math.abs(n)||-1)},setRange:function(e,n,i){return!!S(e)&&void t[e].setRange(n,i)},updateSlider:function(e){return!!S(e)&&(t[e].onResize(),void t[e].reset())},disable:function(e){return!!S(e)&&void t[e].disable()},enable:function(e){return!!S(e)&&void t[e].enable()},getValueSet:function(){return w()},setValueSet:function(e,t){return!!S(id)&&void E(e,t)},setGlobalVariables:function(e){h(e)},removeOnload:function(){M()}}}();e.exports=o},function(e,t,n){var i,o,r;!function(a){o=[n(57),n(99),n(100),n(101)],i=a,r="function"==typeof i?i.apply(t,o):i,!(void 0!==r&&(e.exports=r))}(function(e){return e.widget("ui.draggable",e.ui.mouse,{version:"1.11.0",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(e,t){this._super(e,t),"handle"===e&&this._setHandleClassName()},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(t){var n=this.document[0],i=this.options;try{n.activeElement&&"body"!==n.activeElement.nodeName.toLowerCase()&&e(n.activeElement).blur()}catch(e){}return!(this.helper||i.disabled||e(t.target).closest(".ui-resizable-handle").length>0)&&(this.handle=this._getHandle(t),!!this.handle&&(e(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0))},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),this.element.focus(),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return!this.options.handle||!!e(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this._removeHandleClassName(),e(this.options.handle||this.element).addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.element.find(".ui-draggable-handle").addBack().removeClass("ui-draggable-handle")},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(e){return/(html|body)/i.test(e.tagName)||e===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),n=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==n&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var e=this.element.position(),t=this._isRootNode(this.scrollParent[0]);return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+(t?0:this.scrollParent.scrollTop()),left:e.left-(parseInt(this.helper.css("left"),10)||0)+(t?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,o=this.options,r=this.document[0];return this.relative_container=null,o.containment?"window"===o.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,e(r).width()-this.helperProportions.width-this.margins.left,(e(r).height()||r.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),n=e(o.containment),i=n[0],void(i&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n))):void(this.containment=null)},_convertPositionTo:function(e,t){t||(t=this.position);var n="absolute"===e?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:t.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*n,left:t.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*n}},_generatePosition:function(e,t){var n,i,o,r,a=this.options,s=this._isRootNode(this.scrollParent[0]),l=e.pageX,c=e.pageY;return s&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),t&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(c=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(c=n[3]+this.offset.click.top)),a.grid&&(o=a.grid[1]?this.originalPageY+Math.round((c-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,c=n?o-this.offset.click.top>=n[1]||o-this.offset.click.top>n[3]?o:o-this.offset.click.top>=n[1]?o-a.grid[1]:o+a.grid[1]:o,r=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=n?r-this.offset.click.left>=n[0]||r-this.offset.click.left>n[2]?r:r-this.offset.click.left>=n[0]?r-a.grid[0]:r+a.grid[0]:r),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(c=this.originalPageY)),{top:c-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:s?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:s?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i,this],!0),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs
}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n,i){var o=i.options,r=e.extend({},n,{item:i.element});i.sortables=[],e(o.connectToSortable).each(function(){var n=e(this).sortable("instance");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,r))})},stop:function(t,n,i){var o=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,o))})},drag:function(t,n,i){var o=this;e.each(i.sortables,function(){var r=!1,a=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(r=!0,e.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==a&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(a.instance.element[0],this.instance.element[0])&&(r=!1),r})),r?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(o).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(t,n,i){var o=e("body"),r=i.options;o.css("cursor")&&(r._cursor=o.css("cursor")),o.css("cursor",r.cursor)},stop:function(t,n,i){var o=i.options;o._cursor&&e("body").css("cursor",o._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n,i){var o=e(n.helper),r=i.options;o.css("opacity")&&(r._opacity=o.css("opacity")),o.css("opacity",r.opacity)},stop:function(t,n,i){var o=i.options;o._opacity&&e(n.helper).css("opacity",o._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(e,t,n){n.scrollParent[0]!==n.document[0]&&"HTML"!==n.scrollParent[0].tagName&&(n.overflowOffset=n.scrollParent.offset())},drag:function(t,n,i){var o=i.options,r=!1,a=i.document[0];i.scrollParent[0]!==a&&"HTML"!==i.scrollParent[0].tagName?(o.axis&&"x"===o.axis||(i.overflowOffset.top+i.scrollParent[0].offsetHeight-t.pageY<o.scrollSensitivity?i.scrollParent[0].scrollTop=r=i.scrollParent[0].scrollTop+o.scrollSpeed:t.pageY-i.overflowOffset.top<o.scrollSensitivity&&(i.scrollParent[0].scrollTop=r=i.scrollParent[0].scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(i.overflowOffset.left+i.scrollParent[0].offsetWidth-t.pageX<o.scrollSensitivity?i.scrollParent[0].scrollLeft=r=i.scrollParent[0].scrollLeft+o.scrollSpeed:t.pageX-i.overflowOffset.left<o.scrollSensitivity&&(i.scrollParent[0].scrollLeft=r=i.scrollParent[0].scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(t.pageY-e(a).scrollTop()<o.scrollSensitivity?r=e(a).scrollTop(e(a).scrollTop()-o.scrollSpeed):e(window).height()-(t.pageY-e(a).scrollTop())<o.scrollSensitivity&&(r=e(a).scrollTop(e(a).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(t.pageX-e(a).scrollLeft()<o.scrollSensitivity?r=e(a).scrollLeft(e(a).scrollLeft()-o.scrollSpeed):e(window).width()-(t.pageX-e(a).scrollLeft())<o.scrollSensitivity&&(r=e(a).scrollLeft(e(a).scrollLeft()+o.scrollSpeed)))),r!==!1&&e.ui.ddmanager&&!o.dropBehaviour&&e.ui.ddmanager.prepareOffsets(i,t)}}),e.ui.plugin.add("draggable","snap",{start:function(t,n,i){var o=i.options;i.snapElements=[],e(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var t=e(this),n=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:n.top,left:n.left})})},drag:function(t,n,i){var o,r,a,s,l,c,u,d,f,p,h=i.options,m=h.snapTolerance,g=n.offset.left,v=g+i.helperProportions.width,y=n.offset.top,_=y+i.helperProportions.height;for(f=i.snapElements.length-1;f>=0;f--)l=i.snapElements[f].left,c=l+i.snapElements[f].width,u=i.snapElements[f].top,d=u+i.snapElements[f].height,v<l-m||g>c+m||_<u-m||y>d+m||!e.contains(i.snapElements[f].item.ownerDocument,i.snapElements[f].item)?(i.snapElements[f].snapping&&i.options.snap.release&&i.options.snap.release.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[f].item})),i.snapElements[f].snapping=!1):("inner"!==h.snapMode&&(o=Math.abs(u-_)<=m,r=Math.abs(d-y)<=m,a=Math.abs(l-v)<=m,s=Math.abs(c-g)<=m,o&&(n.position.top=i._convertPositionTo("relative",{top:u-i.helperProportions.height,left:0}).top-i.margins.top),r&&(n.position.top=i._convertPositionTo("relative",{top:d,left:0}).top-i.margins.top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left-i.margins.left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c}).left-i.margins.left)),p=o||r||a||s,"outer"!==h.snapMode&&(o=Math.abs(u-y)<=m,r=Math.abs(d-_)<=m,a=Math.abs(l-g)<=m,s=Math.abs(c-v)<=m,o&&(n.position.top=i._convertPositionTo("relative",{top:u,left:0}).top-i.margins.top),r&&(n.position.top=i._convertPositionTo("relative",{top:d-i.helperProportions.height,left:0}).top-i.margins.top),a&&(n.position.left=i._convertPositionTo("relative",{top:0,left:l}).left-i.margins.left),s&&(n.position.left=i._convertPositionTo("relative",{top:0,left:c-i.helperProportions.width}).left-i.margins.left)),!i.snapElements[f].snapping&&(o||r||a||s||p)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,e.extend(i._uiHash(),{snapItem:i.snapElements[f].item})),i.snapElements[f].snapping=o||r||a||s||p)}}),e.ui.plugin.add("draggable","stack",{start:function(t,n,i){var o,r=i.options,a=e.makeArray(e(r.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});a.length&&(o=parseInt(e(a[0]).css("zIndex"),10)||0,e(a).each(function(t){e(this).css("zIndex",o+t)}),this.css("zIndex",o+a.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n,i){var o=e(n.helper),r=i.options;o.css("zIndex")&&(r._zIndex=o.css("zIndex")),o.css("zIndex",r.zIndex)},stop:function(t,n,i){var o=i.options;o._zIndex&&e(n.helper).css("zIndex",o._zIndex)}}),e.ui.draggable})},function(e,t,n){var i,o,r;!function(a){o=[n(57)],i=a,r="function"==typeof i?i.apply(t,o):i,!(void 0!==r&&(e.exports=r))}(function(e){function t(t,i){var o,r,a,s=t.nodeName.toLowerCase();return"area"===s?(o=t.parentNode,r=o.name,!(!t.href||!r||"map"!==o.nodeName.toLowerCase())&&(a=e("img[usemap=#"+r+"]")[0],!!a&&n(a))):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||i:i)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}e.ui=e.ui||{},e.extend(e.ui,{version:"1.11.0",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({scrollParent:function t(){var n=this.css("position"),i="absolute"===n,t=this.parents().filter(function(){var t=e(this);return(!i||"static"!==t.css("position"))&&/(auto|scroll)/.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==n&&t.length?t:e(this[0].ownerDocument||document)},uniqueId:function(){var e=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(n){return t(n,!isNaN(e.attr(n,"tabindex")))},tabbable:function(n){var i=e.attr(n,"tabindex"),o=isNaN(i);return(o||i>=0)&&t(n,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,n){function i(t,n,i,r){return e.each(o,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var o="Width"===n?["Left","Right"]:["Top","Bottom"],r=n.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+n]=function(t){return void 0===t?a["inner"+n].call(this):this.each(function(){e(this).css(r,i(this,t)+"px")})},e.fn["outer"+n]=function(t,o){return"number"!=typeof t?a["outer"+n].call(this,t):this.each(function(){e(this).css(r,i(this,t,!0,o)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),disableSelection:function(){var e="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(e+".ui-disableSelection",function(e){e.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var n,i,o=e(this[0]);o.length&&o[0]!==document;){if(n=o.css("position"),("absolute"===n||"relative"===n||"fixed"===n)&&(i=parseInt(o.css("zIndex"),10),!isNaN(i)&&0!==i))return i;o=o.parent()}return 0}}),e.ui.plugin={add:function(t,n,i){var o,r=e.ui[t].prototype;for(o in i)r.plugins[o]=r.plugins[o]||[],r.plugins[o].push([n,i[o]])},call:function(e,t,n,i){var o,r=e.plugins[t];if(r&&(i||e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType))for(o=0;o<r.length;o++)e.options[r[o][0]]&&r[o][1].apply(e.element,n)}}})},function(e,t,n){var i,o,r;!function(a){o=[n(57),n(101)],i=a,r="function"==typeof i?i.apply(t,o):i,!(void 0!==r&&(e.exports=r))}(function(e){var t=!1;return e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.11.0",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){if(!0===e.data(n.target,t.widgetName+".preventClickEvent"))return e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,o=1===n.which,r=!("string"!=typeof this.options.cancel||!n.target.nodeName)&&e(n.target).closest(this.options.cancel).length;return!(o&&!r&&this._mouseCapture(n))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0))}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):t.which?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(n){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,n.target===this._mouseDownEvent.target&&e.data(n.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(n)),t=!1,!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})},function(e,t,n){var i,o,r;!function(a){o=[n(57)],i=a,r="function"==typeof i?i.apply(t,o):i,!(void 0!==r&&(e.exports=r))}(function(e){var t=0,n=Array.prototype.slice;return e.cleanData=function(t){return function(n){for(var i,o=0;null!=(i=n[o]);o++)try{e(i).triggerHandler("remove")}catch(e){}t(n)}}(e.cleanData),e.widget=function(t,n,i){var o,r,a,s,l={},c=t.split(".")[0];return t=t.split(".")[1],o=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[c]=e[c]||{},r=e[c][t],a=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new a(e,t)},e.extend(a,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new n,s.options=e.widget.extend({},s.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},o=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,r=this._superApply;return this._super=e,this._superApply=o,t=i.apply(this,arguments),this._super=n,this._superApply=r,t}}()):void(l[t]=i)}),a.prototype=e.widget.extend(s,{widgetEventPrefix:r?s.widgetEventPrefix||t:t},l,{constructor:a,namespace:c,widgetName:t,widgetFullName:o}),r?(e.each(r._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete r._childConstructors):n._childConstructors.push(a),e.widget.bridge(t,a),a},e.widget.extend=function(t){for(var i,o,r=n.call(arguments,1),a=0,s=r.length;a<s;a++)for(i in r[a])o=r[a][i],r[a].hasOwnProperty(i)&&void 0!==o&&(e.isPlainObject(o)?t[i]=e.isPlainObject(t[i])?e.widget.extend({},t[i],o):e.widget.extend({},o):t[i]=o);return t},e.widget.bridge=function(t,i){var o=i.prototype.widgetFullName||t;e.fn[t]=function(r){var a="string"==typeof r,s=n.call(arguments,1),l=this;return r=!a&&s.length?e.widget.extend.apply(null,[r].concat(s)):r,a?this.each(function(){var n,i=e.data(this,o);return"instance"===r?(l=i,!1):i?e.isFunction(i[r])&&"_"!==r.charAt(0)?(n=i[r].apply(i,s),n!==i&&void 0!==n?(l=n&&n.jquery?l.pushStack(n.get()):n,!1):void 0):e.error("no such method '"+r+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+r+"'")}):this.each(function(){var t=e.data(this,o);t?(t.option(r||{}),t._init&&t._init()):e.data(this,o,new i(r,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(n,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=t++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),n),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,n){var i,o,r,a=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(a={},i=t.split("."),t=i.shift(),i.length){for(o=a[t]=e.widget.extend({},this.options[t]),r=0;r<i.length-1;r++)o[i[r]]=o[i[r]]||{},o=o[i[r]];if(t=i.pop(),1===arguments.length)return void 0===o[t]?null:o[t];o[t]=n}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];a[t]=n}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!t),t&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(t,n,i){var o,r=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=o=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,o=this.widget()),e.each(i,function(i,a){function s(){if(t||r.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?r[a]:a).apply(r,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^([\w:-]*)\s*(.*)$/),c=l[1]+r.eventNamespace,u=l[2];u?o.delegate(u,c,s):n.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var o,r,a=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(o in r)o in n||(n[o]=r[o]);return this.element.trigger(n,i),!(e.isFunction(a)&&a.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,o,r){"string"==typeof o&&(o={effect:o});var a,s=o?o===!0||"number"==typeof o?n:o.effect||n:t;o=o||{},"number"==typeof o&&(o={duration:o}),a=!e.isEmptyObject(o),o.complete=r,o.delay&&i.delay(o.delay),a&&e.effects&&e.effects.effect[s]?i[t](o):s!==t&&i[s]?i[s](o.duration,o.easing,r):i.queue(function(n){e(this)[t](),r&&r.call(i[0]),n()})}}),e.widget})},function(e,t){},,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){return this.init.apply(this,arguments)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(57),a=i(r),s=n(60),l=i(s);o.prototype.defaults={replacementEl:void 0,clientFileHandler:null},o.prototype.init=function(e,t){l.default.bindAll(this,"onSelectFile","onReplacementClick"),this.$el=(0,a.default)(e),this.options=a.default.extend({},this.defaults,t),this.$el.on("change",this.onSelectFile),this.options.replacementEl&&(this.$replacement=(0,a.default)(this.options.replacementEl),this.$el.hide(),a.default.browser&&a.default.browser.msie?this.$replacement.is("label")||(this.$replacement.hide(),this.$el.show()):this.$replacement.on("click",this.onReplacementClick))},o.prototype.onSelectFile=function(e){(0,a.default)(e.target).val()&&this.options.clientFileHandler&&this.options.clientFileHandler.handleFiles(e.target.files,this.$el)},o.prototype.onReplacementClick=function(e){e.preventDefault(),this.$el.click()},o.prototype.destroy=function(){this.$el.off("change",this.onSelectFile),this.$replacement.off("click",this.onReplacementClick)},t.default=o,e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){u.default.bindAll(this,"start","_setVideoSize","_capture","_takePhoto","_onTakePhotoClicked","_onUserMediaSuccess","_onUserMediaError","_onRetryWebcamClicked"),this.opts=u.default.extend({},o.defaults,t),this.$container=e,this.video=e.find("video")[0],this.$takePhoto=e.find(".take-photo"),this.$countdown=e.find(".countdown"),this.$videoPlaceholder=e.find(".video-placeholder"),this.width=this.opts.width,this.snapSound=new Audio,(0,l.default)(this.video).toggleClass("mirror",this.opts.mirror).on("canplay",this._setVideoSize),this.$takePhoto.on("click",this._onTakePhotoClicked),e.find(".retry-webcam").on("click",this._onRetryWebcamClicked)}Object.defineProperty(t,"__esModule",{value:!0});var r=n(83),a=i(r),s=n(57),l=i(s),c=n(60),u=i(c),d=n(109),f=i(d);n(110);var p=n(112),h=i(p);o._getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,o._getUserMedia=o._getUserMedia?u.default.bind(o._getUserMedia,navigator):void 0;var m=function(){var e=document.createElement("canvas");return"function"==typeof e.getContext&&e.getContext("2d")}(),g=function(){return!!o._getUserMedia}(),v=function(){return!!document.createElement("video").canPlayType}();o.isSupported=u.default.once(function(){return g&&m&&v}),o.defaults={countdown:!1,mirror:!0,width:640,onCapture:l.default.noop},o.prototype.start=function(){this.snapSound.src=f.default.toUrl(h.default),this.stream?(this.video.play(),this.isStreaming=!0,this.$takePhoto.focus()):o._getUserMedia({video:!0,audio:!1},this._onUserMediaSuccess,this._onUserMediaError)},o.prototype.pause=function(){this.isStreaming&&(this.video.pause(),this.isStreaming=!1)},o.prototype.stop=function(){if(this.stream){if(this.pause(),this.video.src="",this.stream.stop)this.stream.stop();else if(this.stream.getVideoTracks){var e=this.stream.getVideoTracks();e.length&&e[0].stop()}this.stream=null}this.$container.removeClass("streaming")},o.prototype._onUserMediaSuccess=function(e){this.stream=e,this.video.src=window.URL.createObjectURL(e),this.video.play(),this.isStreaming=!0,this.$container.addClass("streaming"),this.$takePhoto.focus()},o.prototype._onUserMediaError=function(){this.$videoPlaceholder.find(".no-access").removeClass("hidden"),this.$videoPlaceholder.find(".grant-access").addClass("hidden")},o.prototype._onRetryWebcamClicked=function(e){this.$container.find(".no-access").addClass("hidden"),this.$container.find(".grant-access").removeClass("hidden"),setTimeout(this.start,50),e.preventDefault()},o.prototype._onTakePhotoClicked=function(){this._takePhoto()},o.prototype._takePhoto=function(){var e=this;this.isStreaming&&!this.$takePhoto.is(":disabled")&&(this.opts.countdown?(this.$takePhoto.prop("disabled",!0),this._doCountdown().always(function(){e.$takePhoto.prop("disabled",!1),e.$countdown.addClass("hidden")}).done(function(){e._capture()})):this._capture())},o.prototype._setVideoSize=function(){this.height=this.video.videoWidth?this.video.videoHeight/(this.video.videoWidth/this.width):.75*this.width,this.video.setAttribute("width",this.width),this.video.setAttribute("height",this.height)},o.prototype._doCountdown=function(){function e(){t.isStreaming?n?(t.$countdown.text(n--),setTimeout(e,1e3)):i.resolve():i.reject()}var t=this,n=3,i=l.default.Deferred();return this.$countdown.removeClass("hidden"),e(),i},o.prototype._capture=function(){this._setVideoSize();var e=(0,l.default)("<canvas/>").attr("width",this.width).attr("height",this.height)[0],t=e.getContext("2d");this.snapSound.play();var n=(0,l.default)('<div class="flasher"/>');a.default.LayerManager.global.push(n),n.on("animationend webkitAnimationEnd MSAnimationEnd oanimationend",function(){a.default.LayerManager.global.popUntil(n),n.remove()}).appendTo("body"),t.drawImage(this.video,0,0,this.width,this.height),this.opts.mirror&&(e=this._mirrorCanvas(e));var i=e.toDataURL("image/png");this.opts.onCapture(i)},o.prototype._mirrorCanvas=function(e){var t=(0,l.default)("<canvas/>").attr("width",this.width).attr("height",this.height)[0],n=t.getContext("2d");return n.translate(this.width,0),n.scale(-1,1),n.drawImage(e,0,0),t},t.default=o,e.exports=t.default},function(e,t){e.exports=s},function(e,t){},,function(e,t,n){e.exports=n.p+"widget/webcam-capture/camera-snap.wav"},function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.split(".").reduce(function(e,t){return e?e[t]:void 0},n||{})};var n=JSON.parse(document.body.getAttribute("data-app-config"));e.exports=t.default},function(e,t){e.exports=l},function(e,t){},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(59),r=i(o),a=n(57),s=i(a);t.default=r.default.Model.extend({namedAttributes:{newEmail:"string",csrfToken:"string",userManagedStatus:!1},initialize:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.changeEmailUrl=t.changeEmailUrl},sync:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.data=s.default.param(t.toJSON()),n.dataType=null,r.default.sync.apply(this,[this._restrictSyncMethod(e),t,n])},url:function(){return this.changeEmailUrl},isNew:function(){return!1},_restrictSyncMethod:function(e){var t="create",n={update:t};return n[e]||e}}),e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(59),r=i(o),a=n(120),s=i(a);t.default=r.default.Model.extend({namedAttributes:["fullName","email","title","org","timezone","clientTz","emailHash","useMfa"],defaults:{title:"",org:"",timezone:"",clientTz:!1},initialize:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.baseUrl,i=t.csrfHeaderName,o=t.csrfToken;this.baseUrl=n,this.csrfHeaderName=i||"X-CSRF-TOKEN",this.csrfToken=o,this.on("sync",this.onSync,this)},parse:function(e){function t(e){return e.timezone=s.default.tz.guess(),e.clientTz=!0,e}return e.clientTz=!1,e.timezone&&(0,s.default)().tz(e.timezone)&&(0,s.default)().tz(e.timezone).tz()?e:t(e)},sync:function(e,t,n){return["create","update","delete"].indexOf(e)>-1&&t.csrfHeaderName&&t.csrfToken&&(n.beforeSend=function(e){e.setRequestHeader(t.csrfHeaderName,t.csrfToken)}),r.default.sync.apply(this,[e,t,n])},isNew:function(){return!1},url:function(){return this.baseUrl+"/rest/user"},onSync:function(e,t,n){var i=n.xhr;e.csrfHeaderName=i.getResponseHeader("X-CSRF-HEADER")||this.csrfHeaderName,e.csrfToken=i.getResponseHeader("X-CSRF-TOKEN")||this.csrfToken}}),e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ChangePasswordPage=t.CHANGE_PASSWORD_KEY=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(126),c=i(l),u=n(134),d=i(u),f=n(135),p=i(f),h=n(127),m=n(69),g=i(m),v=n(71),y=t.CHANGE_PASSWORD_KEY="change-password";t.ChangePasswordPage=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h.changePasswordPanel,e))}return a(t,e),s(t,[{key:"onRendered",value:function(){var e=this.user.toJSON(),t={i18nLevels:[(0,v.getText)("password.strength.level.1"),(0,v.getText)("password.strength.level.2"),(0,v.getText)("password.strength.level.3"),(0,v.getText)("password.strength.level.4"),(0,v.getText)("password.strength.level.5")],i18nNoValue:(0,v.getText)("password.strength.no.value"),i18nNoZxcvbn:(0,v.getText)("password.strength.unavailable"),scoreWords:(0,p.default)({strings:[e.fullName,e.email]})},n=new c.default({el:"#change-password-form",model:new d.default(void 0,{csrfHeaderName:"X-CSRF-TOKEN",csrfToken:this.user.csrfToken}),passwordStrengthOptions:t,successTitle:(0,v.getText)("com.atlassian.profile.password.success"),continueUrl:this.user.isCloud?this.user.continueUrl:null,eventName:"password-updated",showPasswordLabelText:(0,v.getText)("show.password")});n.enableForm().focusFirstField(),this.views.push(n)}},{key:"templateData",value:function(){return{continueUrl:this.user.continueUrl}}},{key:"metricsPageKey",get:function(){return y}}]),t}(g.default)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(57),r=(i(o),n(58)),a=i(r),s=n(127),l=n(128),c=i(l);n(129);var u=n(131),d=i(u),f=a.default.prototype;t.default=a.default.extend({template:s.changePasswordForm,initialize:function(e){e=e||{},this.options=e,this.passwordStrengthOptions=e.passwordStrengthOptions||{},this.showPasswordLabelText=e.showPasswordLabelText,this.passwordFieldSelector="#newPassword",f.initialize.apply(this,arguments),this._attachPasswordStrength(),this._attachPasswordRevealer()},render:function(e){return this.passwordStrength&&this.passwordStrength.destroy(),f.render.apply(this,arguments),this._attachPasswordStrength(),this._attachPasswordRevealer(),this},getAttributesForTemplate:function(){var e=f.getAttributesForTemplate.apply(this,arguments);return e.continueUrl=this.options.continueUrl,e},handleSuccess:function(e,t,n){e.clear({silent:!0}),f.handleSuccess.apply(this,arguments)},_attachPasswordStrength:function(){var e=this.passwordStrengthOptions;e.context=this.el,this.passwordStrength=new c.default(this.passwordFieldSelector,e);
},_attachPasswordRevealer:function(){new d.default({selector:this.passwordFieldSelector,labelText:this.showPasswordLabelText})}}),e.exports=t.default},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};if("undefined"==typeof o.aui&&(o.aui={}),"undefined"==typeof o.aui.form&&(o.aui.form={}),o.aui.form=Object.assign(o.aui.form||{},n(68)),"undefined"==typeof r)var r={};if(r=Object.assign(r||{},n(127)),"undefined"==typeof r)var r={};r.changePasswordForm=function(e,t){return e=e||{},""+i.form.form({id:"change-password-form",action:"#",content:""+o.aui.form.formErrors(e)+i.form.passwordField({id:"currentPassword",labelContent:""+soy.$$escapeHtml("Current password"),value:e.currentPassword,isAutofocus:!0,errorTexts:e.fieldErrors&&e.fieldErrors.currentPassword?e.fieldErrors.currentPassword:null,isDisabled:e.isDisabled})+i.form.passwordField({id:"newPassword",labelContent:""+soy.$$escapeHtml("New password"),value:e.newPassword,errorTexts:e.fieldErrors&&e.fieldErrors.newPassword?e.fieldErrors.newPassword:null,isDisabled:e.isDisabled})+i.form.buttons({content:""+i.form.submit({text:"Change password",type:"primary",isDisabled:e.isDisabled})+(e.continueUrl?i.form.submit({extraClasses:"cancel-link",text:"Cancel",type:"link",href:e.continueUrl}):"")})})},(!1).DEBUG&&(r.changePasswordForm.soyTemplateName="feature.changePasswordForm"),r.changePasswordPanel=function(e,t){return"<h2>"+soy.$$escapeHtml("Change your password")+"</h2>"+r.changePasswordForm(e)},(!1).DEBUG&&(r.changePasswordPanel.soyTemplateName="feature.changePasswordPanel"),e.exports=r},function(e,t,n){var i,o,r;!function(n,a){o=[t,e],i=a,r="function"==typeof i?i.apply(t,o):i,!(void 0!==r&&(e.exports=r))}(void 0,function(e,t){"use strict";function n(e,t){t||(t={}),this.i18nLevels=t.i18nLevels&&t.i18nLevels.length>=s?t.i18nLevels:n.defaults.i18nLevels,this.i18nNoValue=o(t.i18nNoValue,n.defaults.i18nNoValue),this.i18nNoZxcvbn=o(t.i18nNoZxcvbn,n.defaults.i18nNoZxcvbn),this.zxcvbnUrl=t.zxcvbnUrl||n.defaults.zxcvbnUrl,this._scoreWords=t.scoreWords,this.context=t.context||n.defaults.context,this.el=this.context.querySelector(e),this._classPrefix="passwordstrength",this._unavailable="unavailable",this._none="none",this._matcher=new RegExp(this._classPrefix+"-([0-4]|"+this._none+"|"+this._unavailable+")"),this.meterEl=this.createMeter(),i(a,l,this.loadZxcvbn,this),i(a,l,this.init,this)}function i(e,t,n,i){var o=function(){n.apply(i,Array.prototype.slice.call(arguments))};t===l&&"loading"!==a.readyState?setTimeout(o,1):e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)}function o(e,t){return null!=e?e:t}function r(e){if(!e.nextSibling)return null;for(var t=e;t.nextSibling;t=t.nextSibling){var n=t.nextSibling;if(8!==n.nodeType&&3!==n.nodeType)return n}return null}var a=window.document,s=5,l="DOMContentLoaded";n.defaults={i18nLevels:["Terrible","Weak","Average","Strong","Awesome!"].map(function(e){return"Password strength: "+e}),i18nNoValue:"No password entered",i18nNoZxcvbn:"Unavailable",zxcvbnUrl:"//common-admin-cdn.atlassian.com/zxcvbn/f2a8cda/zxcvbn.js",context:a},n.prototype.init=function(){var e=r(this.el);e&&e.classList.contains("aui-icon-notification")&&(e=r(e)),this.el.parentNode.insertBefore(this.meterEl,e),i(this.el,"keyup",this.updateStrength,this)},n.prototype.destroy=function(){this.el&&this.el.removeEventListener("keyup",this.updateStrength,!1)},n.prototype.loadZxcvbn=function(){var e=a.createElement("script");e.type="text/javascript",e.charset="utf-8",e.async=!0,e.src=this.zxcvbnUrl,i(e,"load",this.updateStrength,this),a.querySelector("head").appendChild(e)},n.prototype.createMeter=function(){var e=a.createElement("div");return e.className=this._classPrefix+" "+this._classPrefix+"-none",e.innerHTML=this.getStrengthText(),e},n.prototype.updateStrength=function(){var e=this.el.value,t=void 0;t="undefined"==typeof zxcvbn?""!==e?this._unavailable:this._none:""!==e?zxcvbn(e,this._getScoreWords()).score:this._none,this.meterEl.innerHTML=this.getStrengthText(t),this.meterEl.className=this.meterEl.className.replace(this._matcher,this._classPrefix+"-"+t)},n.prototype.getStrengthText=function(e){return e===this._unavailable?this.i18nNoZxcvbn:"number"==typeof e?this.i18nLevels[e]:this.i18nNoValue},n.prototype._getScoreWords=function(){return"function"==typeof this._scoreWords?this._scoreWords():this._scoreWords instanceof Array?this._scoreWords:[]},t.exports=n})},function(e,t){},,function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n(132);var r="has-password-revealer",a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.selector,o=t.labelText;if(i(this,e),!n)throw"Selector not specified";if(this.labelText=o||"Show password",this.passwordField=document.querySelector(n),!this.passwordField)throw"Field does not exist";return this.container=this.passwordField.parentNode,this.addControl(),this.addContainerClass(),this.addEventHandler(".password-revealer > input"),this}return o(e,[{key:"addControl",value:function(){var e=this,t=document.createElement("div");t.innerHTML=this.getTemplate(),Array.prototype.slice.call(t.childNodes).forEach(function(t){return e.container.appendChild(t)})}},{key:"addContainerClass",value:function(){this.container.className+=" "+r}},{key:"addEventHandler",value:function(e){this.container.querySelector(e).addEventListener("change",this.handleChange.bind(this))}},{key:"getTemplate",value:function(){return'<label class="password-revealer"><input type="checkbox"> '+this.labelText+"</label>"}},{key:"handleChange",value:function(e){var t=e.target.checked;this.passwordField.type=t?"text":"password",this.passwordField.autocomplete=t?"off":""}}]),e}();t.default=a,e.exports=t.default},function(e,t){},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(59),r=i(o),a=n(57),s=i(a),l=n(88),c=i(l);t.default=r.default.Model.extend({namedAttributes:{currentPassword:"string",newPassword:"string",confirmPassword:"string"},initialize:function(e,t){t=t||{},this.baseUrl=t.baseUrl||c.default,this.csrfHeaderName=t.csrfHeaderName,this.csrfToken=t.csrfToken,this.on("change:newPassword",this.syncConfirmPassword,this)},sync:function(e,t,n){return n=n||{},n.data=s.default.param(t.toJSON()),n.dataType=null,t.csrfHeaderName&&t.csrfToken&&(n.beforeSend=function(e){e.setRequestHeader(t.csrfHeaderName,t.csrfToken)}),r.default.sync.apply(this,["create",t,n])},url:function(){return this.baseUrl+"/rest/password"},parse:function(e){return delete e.success,e},syncConfirmPassword:function(){this.set("confirmPassword",this.get("newPassword"))}}),e.exports=t.default},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){return e.indexOf(t)===-1&&e.push(t),e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.strings,r=void 0===t?[]:t,a=e.fields,s=void 0===a?[]:a,l=s.map(function(e){return document.querySelector(e)}).filter(function(e){return null!==e}),c=r.reduce(function(e,t){return t.split(o).reduce(i,e)},[]);return function(){var e=l.map(function(e){return e.value.trim()}),t=l.reduce(function(e,t){return t.value.trim().split(o).reduce(i,e)},c.slice());return[].concat(n(e),n(r),n(t)).reduce(i,[])}};var o=/\W+/;e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.CloseAccountPage=t.CLOSE_ACCOUNT_KEY=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();n(137);var l=n(119),c=i(l),u=n(139),d=n(140),f=n(141),p=i(f),h=n(69),m=i(h),g=t.CLOSE_ACCOUNT_KEY="close-account";t.CloseAccountPage=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new u.ServiceCollection(void 0,{baseUrl:(0,c.default)("management.url")});return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,d.closeAccountPanel,e,n))}return a(t,e),s(t,[{key:"fetchOnInit",value:function(){return!this.model.length}},{key:"onRendered",value:function(){var e=new p.default({el:document.getElementById("close-account-form"),model:this.model,user:this.user});this.views.push(e)}},{key:"templateData",value:function(){return{services:this.model.toJSON()}}},{key:"metricsPageKey",get:function(){return g}}]),t}(m.default)},function(e,t){},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ServiceCollection=t.Service=void 0;var o=n(59),r=i(o),a=n(88),s=i(a),l=r.default.Model.extend({namedAttributes:{application:"string",applicationName:"string",applicationShortName:"string",applicationUrl:"string",applicationShortUrl:"string",username:"string"}}),c=r.default.Collection.extend({model:l,initialize:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.baseUrl,i=void 0===n?s.default:n;this.baseUrl=i},url:function(){return this.baseUrl+"/rest/applications"}});t.Service=l,t.ServiceCollection=c,t.default=l},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};if("undefined"==typeof o.aui&&(o.aui={}),"undefined"==typeof o.aui.form&&(o.aui.form={}),o.aui.form=Object.assign(o.aui.form||{},n(68)),"undefined"==typeof r)var r={};r.closeAccountForm=function(e,t){return e=e||{},""+i.form.form({id:"close-account-form",isTopLabels:!0,action:"",content:""+o.aui.form.formErrors(e)+i.form.checkboxField({legendContent:"",fields:[{id:"close-account-cb",labelText:"I understand my access to the above services will be removed when I close my account",isChecked:!1,value:"true"}]})+i.form.buttons({content:""+i.form.submit({id:"close-account-submit",text:"Close account",type:"primary",isDisabled:e.isDisabled})})})},(!1).DEBUG&&(r.closeAccountForm.soyTemplateName="feature.closeAccountForm"),r.closeAccountPanel=function(e,t){for(var n="<h2>"+soy.$$escapeHtml("Close Atlassian account")+"</h2><p>"+soy.$$escapeHtml("Closing your Atlassian account will remove your access from the following services:")+"</p><ul>",i=e.services,o=i.length,a=0;a<o;a++){var s=i[a];n+="<li>"+soy.$$escapeHtml(s.applicationName)+' - <a href="'+soy.$$escapeHtmlAttribute(soy.$$filterNormalizeUri(s.applicationUrl))+'">'+soy.$$escapeHtml(s.applicationUrl)+"</a></li>"}return n+="</ul>"+r.closeAccountForm({formErrors:e.formErrors,isDisabled:!0})},(!1).DEBUG&&(r.closeAccountPanel.soyTemplateName="feature.closeAccountPanel"),e.exports=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){var n=[].concat(o(C.keys())),i=[n.indexOf(e.code),n.indexOf(t.code)],r=i[0],a=i[1];return r===-1&&a===-1?0:r===-1?1:a===-1?-1:r<a?-1:1}function a(e){f.default.ajax(Object.assign({cache:!1},y.default,{url:(0,g.default)("hamlet.server")+"/1.0/public/contact/validateCloseAccount"})).then(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.status,i=t.warnings,o=void 0===i?[]:i,a=t.errors,s=void 0===a?[]:a;"OK"===n?e.resolve():"WARN"===n?(o.sort(r),e.reject(o.length?o[0]:void 0)):"ERROR"===n&&(s.sort(r),e.reject(s.length?s[0]:void 0))},function(){e.reject()})}Object.defineProperty(t,"__esModule",{value:!0}),t.CloseAccountMessageDialog=void 0,t.warningAndErrorComparator=r,t.validateCloseAccount=a;var s=n(59),l=i(s),c=n(58),u=i(c),d=n(57),f=i(d),p=n(83),h=i(p),m=n(119),g=i(m),v=n(61),y=i(v),_=n(79),b=i(_),w=n(81),E=i(w),S=n(142),x=n(140),C=new Map([["IS_EXPERT",S.expertDialog],["HAS_ACTIVE_ACCOUNTS",S.activeAccountsDialog],["HAS_OPEN_QUOTES",S.openQuotesDialog],["HAS_ACTIVE_ACCOUNTS_AUTO_QUOTE_OR_NONE",S.activeAccountsAutoQuoteDialog],["NUMBER_OF_INVOICES",S.numberOfInvoicesDialog]]);t.default=u.default.extend({template:x.closeAccountForm,events:{submit:"submit","change #close-account-cb":"toggleButton"},_submitId:"#close-account-submit",initialize:function(e){var t=e.user;this.$closeAccountSubmitButton=this.$(this._submitId),this.checkCanCloseAccount=f.default.Deferred(),this.toggleButton(),this.user=t,a(this.checkCanCloseAccount)},handleError:function(e,t){this.closeAccountMessageDialog&&this.closeAccountMessageDialog.remove(),this.render(f.default.parseJSON(t.responseText)),this.$closeAccountSubmitButton=(0,f.default)(this._submitId),this.disableSubmit()},toggleButton:function(){this.$("#close-account-cb").is(":checked")?this.enableSubmit():this.disableSubmit()},enableSubmit:function(){this.$closeAccountSubmitButton.prop("disabled",!1).removeAttr("aria-disabled")},disableSubmit:function(){this.$closeAccountSubmitButton.prop("disabled",!0).attr("aria-disabled","true")},getSpinnerContainerEl:function(){var e=this.$closeAccountSubmitButton.nextAll(".spinner");return e.length||(e=(0,f.default)('<div class="spinner"></div>').insertAfter(this.$closeAccountSubmitButton)),e[0]},addSpinner:function(){this.spinner=new b.default(E.default.small).spin(this.getSpinnerContainerEl())},removeSpinner:function(){this.spinner&&this.spinner.stop(),delete this.spinner},remove:function(){this.closeAccountMessageDialog&&this.closeAccountMessageDialog.remove(),u.default.prototype.remove.apply(this)},submit:function(e){var t=this;e.preventDefault(),this.addSpinner(),this.disableSubmit(),this.checkCanCloseAccount.then(this.closeAccount.bind(this),this.showDialog.bind(this)).always(function(){t.removeSpinner()})},showDialog:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.code,n=e.count,i=e.sens;this.closeAccountMessageDialog=new T({code:t,count:n,sens:i}),this.listenToOnce(this.closeAccountMessageDialog,"closeAccount",this.closeAccount),this.listenToOnce(this.closeAccountMessageDialog,"remove",this.enableSubmit)},closeAccount:function(){var e=this;this.addSpinner(),this.disableSubmit(),this.listenToOnce(this.user,"sync",function(){e.removeSpinner(),e.closeAccountMessageDialog&&e.closeAccountMessageDialog.remove(),(0,f.default)(document).trigger("loggedOut")}),this.listenToOnce(this.user,"error",this.handleError),this.user.destroy()}});var T=t.CloseAccountMessageDialog=l.default.View.extend({events:{"click #close-account-dialog-close-button":"remove","click .aui-dialog2-header-close":"remove","click #close-account-dialog-save-button":"closeAccount"},initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.code,n=e.count,i=e.sens,o=void 0===i?[]:i;this.template=this.getDialogTemplate(t),this.render({count:n,sens:o})},render:function(e){var t=e.count,n=e.sens;this.dialog=h.default.dialog2(this.template({count:t,sens:n})),this.setElement(this.dialog.$el),this.show()},getDialogTemplate:function(e){var t=C.get(e);return t?t:S.genericDialog},remove:function(e){e&&e.stopPropagation(),this.trigger("remove"),this.dialog.remove(),l.default.View.prototype.remove.apply(this)},show:function(){this.dialog.show()},closeAccount:function(){this.trigger("closeAccount")}})},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};"undefined"==typeof o.closeAccountDialog&&(o.closeAccountDialog={}),o.closeAccountDialog.expertDialog=function(e,t){return""+o.closeAccountDialog.error({content:"<p>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format("We couldn''t close your account as your email address is associated with an Atlassian partner, for example, Atlassian Experts. Before you close your account, log in to <a href=\"{0}\">my.atlassian.com</a> (MAC) and remove your email address from your partner organization.",soy.$$escapeHtml("https://my.atlassian.com/"))))+"</p>"})},(!1).DEBUG&&(o.closeAccountDialog.expertDialog.soyTemplateName="feature.closeAccountDialog.expertDialog"),o.closeAccountDialog.activeAccountsDialog=function(e,t){return""+o.closeAccountDialog.error({content:"<p>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We notice that you are the primary technical or billing contact of a subscription that is configured to be automatically renewed. Before you close your account, cancel your subscription or turn off auto renew through <a href="{0}">Licenses</a>. You can also update this contact to be someone else. <a href="{1}">Learn more</a>.',soy.$$escapeHtml("https://my.atlassian.com/products/index"),soy.$$escapeHtml("https://confluence.atlassian.com/x/vwnMGQ"))))+"</p>"})},(!1).DEBUG&&(o.closeAccountDialog.activeAccountsDialog.soyTemplateName="feature.closeAccountDialog.activeAccountsDialog"),o.closeAccountDialog.openQuotesDialog=function(e,t){return""+o.closeAccountDialog.error({content:"<p>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We notice that you have {0} open quotes that you need to action before we can close your account. If you no longer require these quotes, delete them from your <a href="{1}">Orders</a>.',"number"==typeof e.count?e.count:soy.$$escapeHtml(e.count),soy.$$escapeHtml("https://my.atlassian.com/billing/paidorders"))))+"</p>"})},(!1).DEBUG&&(o.closeAccountDialog.openQuotesDialog.soyTemplateName="feature.closeAccountDialog.openQuotesDialog"),o.closeAccountDialog.activeAccountsAutoQuoteDialog=function(e,t){return""+o.closeAccountDialog.warning({content:"<p>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We just wanted to highlight that you are the main technical or billing contact for {0} products. To prevent receiving further communication about these products, update these contacts through <a href="{1}">Licenses</a> before you close your account.',"number"==typeof e.sens.length?e.sens.length:soy.$$escapeHtml(e.sens.length),soy.$$escapeHtml("https://my.atlassian.com/products/index"))))+"</p>"})},(!1).DEBUG&&(o.closeAccountDialog.activeAccountsAutoQuoteDialog.soyTemplateName="feature.closeAccountDialog.activeAccountsAutoQuoteDialog"),o.closeAccountDialog.numberOfInvoicesDialog=function(e,t){return""+o.closeAccountDialog.warning({content:"<p>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('We just wanted to highlight that you have been a technical or billing contact for past invoices. You can view these invoices from your <a href="{0}">Orders</a>.',soy.$$escapeHtml("https://my.atlassian.com/billing/paidorders"))))+"</p>"})},(!1).DEBUG&&(o.closeAccountDialog.numberOfInvoicesDialog.soyTemplateName="feature.closeAccountDialog.numberOfInvoicesDialog"),o.closeAccountDialog.genericDialog=function(e,t){return""+o.closeAccountDialog.error({content:"<p>"+soy.$$escapeHtml("A problem has occurred while trying to close your account. Please try again later.")+"</p>"})},(!1).DEBUG&&(o.closeAccountDialog.genericDialog.soyTemplateName="feature.closeAccountDialog.genericDialog"),o.closeAccountDialog.warning=function(e,t){return""+i.dialog.dialog2({titleText:"We're sad to see you go",id:"close-account-dialog",content:e.content,footerActionContent:""+i.buttons.button({text:"Close my account",type:"primary",id:"close-account-dialog-save-button"})+i.buttons.button({text:"Cancel",type:"link",id:"close-account-dialog-close-button"})})},(!1).DEBUG&&(o.closeAccountDialog.warning.soyTemplateName="feature.closeAccountDialog.warning"),o.closeAccountDialog.error=function(e,t){return""+i.dialog.dialog2({titleText:"We can't close your account yet",id:"close-account-dialog",content:e.content,footerActionContent:""+i.buttons.button({text:"Ok, got it",id:"close-account-dialog-close-button"})})},(!1).DEBUG&&(o.closeAccountDialog.error.soyTemplateName="feature.closeAccountDialog.error"),e.exports=o.closeAccountDialog},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.BillingPage=t.BILLING_KEY=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(144),c=i(l),u=n(146),d=i(u),f=n(147),p=i(f),h=n(145),m=n(69),g=i(m),v=n(119),y=i(v),_=n(71),b=t.BILLING_KEY="billing";t.BillingPage=function(e){function t(e){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h.billingPanel,e))}return a(t,e),s(t,[{key:"onRendered",value:function(){var e=(0,y.default)("hamlet.server"),t=new p.default([],{hamletServer:e}),n=new d.default({contactDetails:{email:this.user.get("email")}},{hamletServer:e}),i=new c.default({el:"#billing-form",model:n,successTitle:(0,_.getText)("com.atlassian.id.billing.success"),countryCollection:t,billingCsrfTokenModel:new u.BillingCsrfToken({},{hamletServer:e})});this.views.push(i)}},{key:"templateData",value:function(){return{email:this.user.get("email")}}},{key:"metricsPageKey",get:function(){return b}}]),t}(g.default)},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(60),r=i(o),a=n(57),s=i(a),l=n(61),c=i(l),u=n(58),d=i(u),f=n(145),p=n(66),h=i(p),m=d.default.prototype;t.default=d.default.extend({template:f.billingForm,initialize:function(e){this.countryCollection=e.countryCollection;var t=this.countryCollection.fetch();t.then(function(){this.$("#isoCountryCode").html((0,s.default)(h.default.form.select({id:"isoCountryCode",options:this.getCountriesAsAUISelectOptions()})).html())}.bind(this)),this.billingCsrfTokenModel=e.billingCsrfTokenModel;var n=this.billingCsrfTokenModel.fetch(Object.assign({cache:!1},c.default));s.default.when(t,n).then(function(){m.initialize.call(this,r.default.extend({fetchOnInit:!0},e))}.bind(this))},render:function(e){return e=r.default.extend({countryOptions:this.getCountriesAsAUISelectOptions()},e),e.countryOptions.length||(e.isDisabled=!0),m.render.call(this,e),this},save:function(e){m.save.call(this,e,this.addCsrfToOptions({patch:!0}))},fetch:function(e){return m.fetch.call(this,this.addCsrfToOptions(e))},addCsrfToOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.billingCsrfTokenModel.get("csrfToken");return t&&(e.beforeSend=function(e){e.setRequestHeader("ATL-XSRF-Token",t)}),e},serializeForm:function(){var e=m.serializeForm.apply(this,arguments),t=this.model.namedAttributes,n=t.contactDetails.prototype.namedAttributes,i=t.organisationDetails.prototype.namedAttributes;return{contactDetails:r.default.pick(e,n),organisationDetails:r.default.pick(e,i)}},getAttributesForTemplate:function(){return Object.assign({},this.model.get("contactDetails"),this.model.get("organisationDetails"))},parseFieldErrorsForTemplate:function(e){var t={};return r.default.each(e,function(e,n){t[n.split(".").pop()]=e}),t},getCountriesAsAUISelectOptions:function(){return this.countryCollection.map(function(e){return{text:e.get("displayName"),value:e.get("countryIsoCode")}})}}),e.exports=t.default},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};if("undefined"==typeof o.aui&&(o.aui={}),"undefined"==typeof o.aui.form&&(o.aui.form={}),o.aui.form=Object.assign(o.aui.form||{},n(68)),"undefined"==typeof r)var r={};if(r=Object.assign(r||{},n(145)),"undefined"==typeof r)var r={};r.billingForm=function(e,t){return""+i.form.form({action:"#",id:"billing-form",content:""+o.aui.form.formErrors(e)+i.form.textField({id:"firstName",labelContent:""+soy.$$escapeHtml("First name"),value:e.firstName,isRequired:!0,isAutofocus:!0,errorTexts:e.fieldErrors&&e.fieldErrors.firstName?e.fieldErrors.firstName:null,isDisabled:e.isDisabled})+i.form.textField({id:"lastName",labelContent:""+soy.$$escapeHtml("Last name"),value:e.lastName,isRequired:!0,errorTexts:e.fieldErrors&&e.fieldErrors.lastName?e.fieldErrors.lastName:null,isDisabled:e.isDisabled})+i.form.textField({id:"organisationName",labelContent:""+soy.$$escapeHtml("Organization"),value:e.organisationName,isRequired:!0,errorTexts:e.fieldErrors&&e.fieldErrors.organisationName?e.fieldErrors.organisationName:null,isDisabled:e.isDisabled})+i.form.selectField({id:"isoCountryCode",labelContent:""+soy.$$escapeHtml("Country"),options:e.countryOptions,value:e.isoCountryCode,isRequired:!0,errorTexts:e.fieldErrors&&e.fieldErrors.isoCountryCode?e.fieldErrors.isoCountryCode:null,isDisabled:e.isDisabled})+i.form.textField({id:"address1",labelContent:""+soy.$$escapeHtml("Address line 1"),value:e.address1,errorTexts:e.fieldErrors&&e.fieldErrors.address1?e.fieldErrors.address1:null,isDisabled:e.isDisabled})+i.form.textField({id:"address2",labelContent:""+soy.$$escapeHtml("Address line 2"),value:e.address2,errorTexts:e.fieldErrors&&e.fieldErrors.address2?e.fieldErrors.address2:null,isDisabled:e.isDisabled})+i.form.textField({id:"city",labelContent:""+soy.$$escapeHtml("City"),value:e.city,errorTexts:e.fieldErrors&&e.fieldErrors.city?e.fieldErrors.city:null,isDisabled:e.isDisabled})+i.form.textField({id:"state",labelContent:""+soy.$$escapeHtml("State / Province"),value:e.state,fieldWidth:"short",errorTexts:e.fieldErrors&&e.fieldErrors.state?e.fieldErrors.state:null,isDisabled:e.isDisabled})+i.form.textField({id:"postcode",labelContent:""+soy.$$escapeHtml("ZIP / Postcode"),value:e.postcode,fieldWidth:"short",errorTexts:e.fieldErrors&&e.fieldErrors.postcode?e.fieldErrors.postcode:null,isDisabled:e.isDisabled})+i.form.textField({id:"phone",labelContent:""+soy.$$escapeHtml("Phone"),value:e.phone,errorTexts:e.fieldErrors&&e.fieldErrors.phone?e.fieldErrors.phone:null,isDisabled:e.isDisabled})+i.form.textField({id:"taxId",labelContent:""+soy.$$escapeHtml("Tax ID"),value:e.taxId,errorTexts:e.fieldErrors&&e.fieldErrors.taxId?e.fieldErrors.taxId:null,isDisabled:e.isDisabled})+i.form.input({id:"email",type:"hidden",value:e.email})+i.form.buttons({content:""+i.form.submit({text:"Save",type:"primary",isDisabled:e.isDisabled})})})},(!1).DEBUG&&(r.billingForm.soyTemplateName="feature.billingForm"),r.billingPanel=function(e,t){return"<h2>"+soy.$$escapeHtml("Billing details")+"</h2>"+r.billingForm({email:e.email,firstName:"",lastName:"",isoCountryCode:"",organisationName:"",countryOptions:[],isDisabled:!0})},(!1).DEBUG&&(r.billingPanel.soyTemplateName="feature.billingPanel"),e.exports=r},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.BillingCsrfToken=void 0;var o=n(59),r=i(o),a=(t.BillingCsrfToken=r.default.Model.extend({initialize:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.hamletServer;if(!n)throw new Error("Hamlet URL not provided");this.hamletServer=n},fetch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.default.Model.prototype.fetch.call(this,Object.assign(e,{dataType:"text"}))},parse:function(e){return{csrfToken:e}},url:function(){return this.hamletServer+"/1.0/auth/xsrf/plain"}}),r.default.Model.extend({namedAttributes:["firstName","lastName","email","phone"]})),s=r.default.Model.extend({namedAttributes:["organisationName","address1","address2","city","state","postcode","isoCountryCode","country","taxId","organisationType","expertDiscountPercentage","payOnAccount"]});t.default=r.default.Model.extend({namedAttributes:{contactDetails:a,organisationDetails:s},initialize:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.hamletServer;if(!n)throw new Error("Hamlet URL not provided");this.hamletServer=n},parse:function(e,t){return e?r.default.Model.prototype.parse.call(this,e,t):{}},sync:function(e,t,n){if("patch"===e){var i=n.attrs;n.attrs={contactEntity:i.contactDetails,organisationEntity:i.organisationDetails}}return r.default.sync.apply(this,[e,t,n])},isNew:function(){return!1},url:function(){return this.hamletServer+"/1.0/public/contact/currentUser"}})},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(59),r=i(o),a=n(60),s=i(a),l=r.default.Model.extend({idAttribute:"countryIsoCode",initialize:function(e,t){if(t=t||{},!t.hamletServer)throw new Error("Hamlet URL not provided");this.hamletServer=t.hamletServer},urlRoot:function(){return this.hamletServer+"/1.0/public/country"}});t.default=r.default.Collection.extend({initialize:function(e,t){if(t=t||{},!t.hamletServer)throw new Error("Hamlet URL not provided");var n=this.hamletServer=t.hamletServer;this.model=function(e,t){return t=t||{},t.hamletServer=n,new l(e,t)}},comparator:function(e,t){var n=e.get("sortOrder"),i=t.get("sortOrder");return n!==i?null===n?1:null===i?-1:n>i?1:-1:e.get("displayName")>t.get("displayName")?1:-1},parse:function(e){return s.default.filter(e.countryList,function(e){return!e.usExportRestriction})},url:function(){return this.hamletServer+"/1.0/public/country/all"}}),e.exports=t.default},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,U.default)(R+"."+e,t,H)}Object.defineProperty(t,"__esModule",{value:!0}),t.DisableMfaDialog=t.TwoStepVerificationPage=t.TWO_STEP_KEY=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=function e(t,n,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);
if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,i)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(i)};t.analyticsEvent=l,n(149);var d=n(151),f=o(d),p=n(69),h=o(p),m=n(153),g=n(154),v=i(g),y=n(88),_=o(y),b=n(57),w=o(b),E=n(83),S=o(E),x=n(59),C=o(x),T=n(71),k=n(62),P=o(k),A=n(157),O=o(A),F=n(79),M=o(F),D=n(81),j=o(D),$=n(158),N=i($),I=n(159),U=o(I),R=t.TWO_STEP_KEY="two-step-verification",H={waitForUser:!0,appendServerToProperties:!0},L=(t.TwoStepVerificationPage=function(e){function t(e){r(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m.twoStepVerificationPanel,e,e));return e.get("useMfa")&&n.populateEnrollmentDetails(e),n}return s(t,e),c(t,[{key:"populateEnrollmentDetails",value:function(){var e=this;return w.default.get(_.default+"/rest/two-step-verification/enrollments").done(function(t){var n=t.filter(function(e){return"confirmed"===e.status}).pop();if(n){var i=n.enrolled_at;e.enrollmentDate=(0,O.default)(i).format("D MMM YYYY h:mmA"),e.render()}})}},{key:"onRendered",value:function(e){v.run(function(e,t){var n=e.type;e.params;switch(n){case"enrollmentComplete":var i=(0,P.default)({type:"success",title:(0,T.getText)("com.atlassian.id.two.step.verification.setup.return.flag.title",N),body:(0,T.getText)("com.atlassian.id.two.step.verification.setup.return.flag.body",N)+'<br/><br/><a id="tsv-survey-link" href="https://goo.gl/forms/7xxYHb5cHHX9eELC2">'+(0,T.getText)("com.atlassian.id.two.step.verification.setup.return.flag.survey",N)+"</a>"});return(0,w.default)("#tsv-survey-link").click(function(e){e.preventDefault(),l("settings.enrollment.tsv-survey-link.clicked"),i.remove(),window.open(e.target.href)}),!0}});var t=new f.default({continueUrl:"two-step-verification/enroll",useMfa:this.model.attributes.useMfa,elevatedSession:this.model.elevatedSession});this.views.push(t),(0,w.default)("#disable-two-step-verification").click(function(e){e.preventDefault(),(new L).show(),l("settings.enrollment.disable.viewed")});var n={elevated:e.elevatedSession,enrolled:this.model.attributes.useMfa};(0,w.default)("#learn-more-link-sidewall").click(function(e){e.preventDefault(),l("settings.learn-more-link-sidewall.clicked",n),window.open(e.target.href)}),(0,w.default)("#learn-more-link").click(function(e){e.preventDefault(),l("settings.learn-more-link.clicked",n),window.open(e.target.href)}),(0,w.default)("#customer-agreement-link").click(function(e){e.preventDefault(),l("settings.customer-agreement-link.clicked",n),window.open(e.target.href)}),l("settings.viewed",n)}},{key:"hasElevatedPermissions",value:function(e){var t=Date.now();return e&&e.expireTime&&e.expireTime>t||!1}},{key:"templateData",value:function(){return Object.assign({},u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"templateData",this).call(this),{elevatedSession:this.hasElevatedPermissions(this.model.elevatedSession),enrollmentDate:this.enrollmentDate,authProvider:this.model.userManagedStatus.type,googleId:this.model.googleId})}},{key:"metricsPageKey",get:function(){return R}}]),t}(h.default),t.DisableMfaDialog=function(e){function t(){return r(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),c(t,[{key:"initialize",value:function(){this.render()}},{key:"getSpinnerContainerEl",value:function(){var e=this.$continueButton.prevAll(".spinner");return e.length||(e=(0,w.default)('<div class="spinner"></div>').prependTo(this.$footer)),e[0]}},{key:"addSpinner",value:function(){this.spinner=new M.default(j.default.small).spin(this.getSpinnerContainerEl())}},{key:"removeSpinner",value:function(){this.spinner&&this.spinner.stop(),delete this.spinner}},{key:"disableButtons",value:function(){this.$continueButton.prop("disabled",!0).attr("aria-disabled","true"),this.$cancelButton.prop("disabled",!0).attr("aria-disabled","true")}},{key:"enableButtons",value:function(){this.$continueButton.prop("disabled",!1).attr("aria-disabled","false"),this.$cancelButton.prop("disabled",!1).attr("aria-disabled","false")}},{key:"render",value:function(){this.template=m.twoStepVerificationDisableDialog,this.dialog=S.default.dialog2(this.template()),this.setElement(this.dialog.$el),this.$cancelButton=this.dialog.$el.find("#disable-two-step-verification-cancel-button"),this.$continueButton=this.dialog.$el.find("#disable-two-step-verification-continue-button"),this.$footer=this.dialog.$el.find(".aui-dialog2-footer"),this.show()}},{key:"remove",value:function(e){e&&(l("settings.enrollment.disable.canceled"),e.stopPropagation()),this.trigger("remove"),this.dialog.remove(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"remove",this).call(this,e)}},{key:"deleteEnrollment",value:function(){var e=this;this.addSpinner(),this.disableButtons(),w.default.post(_.default+"/rest/two-step-verification/unenroll").then(function(){return l("settings.enrollment.disable.succeeded")}).then(function(){return location.reload()},function(e){return 403===e.status?l("settings.enrollment.disable.not-elevated").then(function(){var e={type:"error",title:(0,T.getText)("com.atlassian.id.two.step.verification.settings.disable.error.unauthenticated.title",N),body:(0,T.getText)("com.atlassian.id.two.step.verification.settings.disable.error.unauthenticated.body",N)};window.location=(0,g.generateLink)(_.default+"/two-step-verification",{type:"flag",params:e})}):l("settings.enrollment.disable.not-elevated").then(function(){(0,P.default)({type:"error",title:(0,T.getText)("com.atlassian.id.two.step.verification.settings.disable.error.generic.title",N),body:(0,T.getText)("com.atlassian.id.two.step.verification.settings.disable.error.generic.body",N)})})}).always(function(){e.removeSpinner(),e.enableButtons(),e.remove()})}},{key:"show",value:function(){this.dialog.show()}}]),t}(C.default.View.extend({events:{"click #disable-two-step-verification-continue-button":"deleteEnrollment","click #disable-two-step-verification-cancel-button":"remove"}})))},function(e,t){},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(58),r=i(o),a=n(152),s=i(a),l=n(153),c=n(88),u=i(c),d=n(148);t.default=r.default.extend({template:l.twoStepVerificationForm,el:"#two-step-verification-form",model:new s.default,handleSuccess:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.baseUrl=i.baseUrl||u.default,(0,d.analyticsEvent)("settings.unlock.succeeded").then(function(){return location.href=n.baseUrl+"/"+n.options.continueUrl})},handleError:function(e,t){(0,d.analyticsEvent)("settings.unlock.failed"),r.default.prototype.handleError.call(this,e,t)},getAttributesForTemplate:function(){return Object.assign({},this.model.toJSON(),{useMfa:this.options.useMfa})}}),e.exports=t.default},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(59),r=i(o),a=n(88),s=i(a);t.default=r.default.Model.extend({url:function(){return this.baseUrl+"/rest/elevate-permissions"},initialize:function(e,t){t=t||{},this.baseUrl=t.baseUrl||s.default}}),e.exports=t.default},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};o.twoStepVerificationForm=function(e,t){e=e||{};var n="";if(!e.elevatedSession||!e.useMfa){var o="",r="password";o+=i.form.label({forField:r,content:"Account password"})+i.form.input({id:r,type:"password"})+i.form.submit({text:e.useMfa?"Unlock settings":"Set up two-step verification",type:"primary",extraClasses:"submit-button"})+(e.fieldErrors&&e.fieldErrors.password?i.form.fieldError({message:e.fieldErrors.password}):"");var a=""+i.form.fieldGroup({content:o});n+=i.form.form({id:"two-step-verification-form",isTopLabels:!0,action:"#",encType:"application/json",content:a})}return n},(!1).DEBUG&&(o.twoStepVerificationForm.soyTemplateName="feature.twoStepVerificationForm"),o.twoStepVerificationSettings=function(e,t){return'<div class="two-step-verification-settings">'+(e.elevatedSession?"<h3>"+soy.$$escapeHtml("Settings")+"</h3>":'<h3 class="tsv-disabled">'+soy.$$escapeHtml("Settings")+"</h3>")+o.twoStepVerificationSettingsOption({id:"regenerate-recovery-code",title:"Create new emergency recovery key",description:"Your new key will be valid right away and the existing one will no longer work.",link:"/regenerate-recovery-code",elevatedSession:e.elevatedSession})+o.twoStepVerificationSettingsOption({id:"disable-two-step-verification",title:"Disable two-step verification",description:"Your account will no longer have the protection of a second login step.",link:"#",elevatedSession:e.elevatedSession})+"</div>"},(!1).DEBUG&&(o.twoStepVerificationSettings.soyTemplateName="feature.twoStepVerificationSettings"),o.twoStepVerificationSettingsOption=function(e,t){return'<div class="settings-option">'+(e.elevatedSession?'<p class="title"><a href="two-step-verification'+soy.$$escapeHtmlAttribute(e.link)+'" id="'+soy.$$escapeHtmlAttribute(e.id)+'">'+soy.$$escapeHtml(e.title)+"</a></p>":'<p class="title tsv-disabled">'+soy.$$escapeHtml(e.title)+"</p>")+'<p class="description">'+soy.$$escapeHtml(e.description)+"</p></div>"},(!1).DEBUG&&(o.twoStepVerificationSettingsOption.soyTemplateName="feature.twoStepVerificationSettingsOption"),o.twoStepVerificationPanel=function(e,t){var n="",r="#",a="https://www.atlassian.com/legal/customer-agreement";n+='<div class="two-step-verification-panel"><div class="two-step-verification-header"><h2><span>'+soy.$$escapeHtml("Two-step verification")+"</span> "+i.lozenges.lozenge({text:e.useMfa?"Enabled":"Disabled",extraClasses:"use-mfa",type:e.useMfa?"success":""})+"</h2>"+(e.useMfa?"<p>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml("You've kept your account extra secure with a second login step since"))+"<br />"+(e.enrollmentDate?"<strong>"+soy.$$escapeHtml(e.enrollmentDate)+"</strong>":i.icons.icon({icon:"wait"}))+"</p>":"<p>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('Keep your account extra secure with a second login step. To enable it, all you need is a smartphone (<a id="learn-more-link" href="{0}">learn more</a>).',"number"==typeof r?r:soy.$$escapeHtml(r))))+"</p>");var s="Google"==e.authProvider||"SAML"==e.authProvider;return n+=(s?o.twoStepVerificationManagedAccountWarning(e):"")+"</div>"+(e.useMfa||!s?'<div class="two-step-verification-sidewall">'+o.twoStepVerificationInfo({learnMoreLink:r,customerAgreementLink:a})+(e.useMfa?"":'<div class="two-step-verification-decoration"></div>')+'</div><div class="two-step-verification-body">'+(e.useMfa&&e.elevatedSession?"":'<div class="elevation-panel">'+(e.useMfa?"<p>"+soy.$$escapeHtml("For extra security, enter your password to unlock your settings.")+"</p>":"<h3>"+soy.$$escapeHtml("Let's get you set up")+"</h3><p>"+soy.$$escapeHtml("To set up two-step verification, we'll walk you through 3 simple steps.")+"<br />"+soy.$$escapeHtml("Start by entering your password so that we know it's you.")+"</p>")+o.twoStepVerificationForm(e)+"</div>")+(e.useMfa?o.twoStepVerificationSettings(e):"")+"</div>":"")+"</div>"},(!1).DEBUG&&(o.twoStepVerificationPanel.soyTemplateName="feature.twoStepVerificationPanel"),o.twoStepVerificationDisableDialog=function(e,t){return""+i.dialog.dialog2({titleText:"Disable two-step verification",id:"disable-two-step-verification-dialog",size:"small",content:"If you proceed, you'll no longer have the protection of a second login step.",footerActionContent:""+i.buttons.button({type:"primary",text:"Disable",id:"disable-two-step-verification-continue-button"})+i.buttons.button({text:"Cancel",id:"disable-two-step-verification-cancel-button"})})},(!1).DEBUG&&(o.twoStepVerificationDisableDialog.soyTemplateName="feature.twoStepVerificationDisableDialog"),o.twoStepVerificationInfo=function(e,t){return'<div class="two-step-verification-notice"><h4>'+soy.$$escapeHtml("What you need to know")+"</h4><ul><li>"+soy.$$escapeHtml("We'll prompt you for a verification code when you log into JIRA, Confluence, and SourceTree.")+"</li><li>"+soy.$$escapeHtml("We won't prompt for a verification code when you log in with Google or SAML. We recommend that you use Google's 2-Step Verification or your SAML provider's equivalent.")+"</li><li>"+soy.$$escapeHtml("You can't use two-step verification with our JIRA and Confluence REST APIs.")+"</li><li>"+soy.$$escapeHtml(soydata.VERY_UNSAFE.ordainSanitizedHtml(AJS.format('<strong>Two-step verification is currently in beta</strong> - <a id="learn-more-link-sidewall" href="{0}">learn more</a> about how it works. Refer to section 11 of our <a id="customer-agreement-link" href="{1}">customer agreement</a> for more details about beta features.',"number"==typeof e.learnMoreLink?e.learnMoreLink:soy.$$escapeHtml(e.learnMoreLink),"number"==typeof e.customerAgreementLink?e.customerAgreementLink:soy.$$escapeHtml(e.customerAgreementLink))))+"</li></ul></div>"},(!1).DEBUG&&(o.twoStepVerificationInfo.soyTemplateName="feature.twoStepVerificationInfo"),o.twoStepVerificationManagedAccountWarning=function(e,t){return e=e||{},""+i.message.warning({titleContent:e.useMfa?"You can no longer use Atlassian account's two-step verification":"You can't enable two-step verification",content:""+(e.useMfa?"<p>"+soy.$$escapeHtml("We stopped prompting you for a verification code because your administrator required that you log in with Google or SAML single sign-on. For a second form of verification, use Google's 2-Step Verification or your SAML provider's equivalent.")+"</p><p>"+soy.$$escapeHtml("We kept two-step verification enabled in the background, which you can update by entering your Atlassian account password to unlock your settings.")+"</p>":"<p>"+soy.$$escapeHtml("You can't set up two-step verification because you log in with Google or SAML single sign-on. For a second form of verification, use Google's 2-Step Verification or your SAML provider's equivalent.")+"</p>")})},(!1).DEBUG&&(o.twoStepVerificationManagedAccountWarning.soyTemplateName="feature.twoStepVerificationManagedAccountWarning"),e.exports=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=document.createTextNode(e),n=document.createElement("div");return n.appendChild(t),n.innerHTML}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.search;return e.slice(1).split("&").filter(function(e){return e}).reduce(function(e,t){var n=t.split("=").map(decodeURIComponent),i=u(n,2),o=i[0],r=i[1];return e[o]=r,e},{})}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r();try{var n=t[e];if(n)return v.default.deserialize(n)}catch(e){console.warn("Failed to decode serialized entity",e)}}function s(){history.replaceState(void 0,void 0,location.pathname)}function l(e,t){return e+"?"+y+"="+encodeURIComponent(new v.default(t).serialize())}function c(){function e(e,t){var n=e.type,i=e.params;switch(n){case"setContext":return _.setContext(i),!0;case"updateContext":return _.setContext(Object.assign({},t,i)),!0;case"clearContext":return _.clearContext(),!0;case"flag":return(0,f.default)({type:i.type,title:(0,p.getText)(i.title),body:o((0,p.getText)(i.body))}),!0}}var t=a(y);if(t){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];t.run([e].concat(i),_.getContext())}s()}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw r}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getParams=r,t.decodeActionParam=a,t.clearSearchAndHash=s,t.generateLink=l,t.run=c;var d=n(62),f=i(d),p=n(71),h=n(155),m=i(h),g=n(156),v=i(g),y="action",_=new m.default("aid.hermes.context")},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t){n(this,e),this.contextKey=t}return i(e,[{key:"setContext",value:function(e){sessionStorage.setItem(this.contextKey,JSON.stringify(e))}},{key:"clearContext",value:function(){sessionStorage.removeItem(this.contextKey)}},{key:"getContext",value:function(){try{return JSON.parse(sessionStorage.getItem(this.contextKey))}catch(e){console.warn("Context was set, but could not be parsed.")}}}]),e}();t.default=o,e.exports=t.default},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=function(){function e(t){if(n(this,e),"object"!==("undefined"==typeof t?"undefined":i(t))||"string"!=typeof t.type)throw new DOMException("Invalid argument");this.type=t.type,this.params=t.params}return o(e,[{key:"run",value:function(e,t){var n=this;e.reduceRight(function(e,i){return!e&&i(n,t)},!1)}},{key:"serialize",value:function(){return btoa(JSON.stringify(this))}}],[{key:"deserialize",value:function(t){return new e(JSON.parse(atob(t)))}}]),e}();t.default=r,e.exports=t.default},function(e,t){e.exports=c},function(e,t){e.exports={"com.atlassian.id.two.step.verification.heading":"Two-step verification","com.atlassian.id.two.step.verification.enabled":"Enabled","com.atlassian.id.two.step.verification.disabled":"Disabled","com.atlassian.id.two.step.verification.details.enrollment.date.html":"You enabled two-step verification on <strong>{0}</strong>.","com.atlassian.id.two.step.verification.setup.description.html":'Keep your account extra secure with a second login step. To enable it, all you need is a smartphone (<a id="learn-more-link" href="{0}">learn more</a>).',"com.atlassian.id.two.step.verification.enrolled.description":"You''ve kept your account extra secure with a second login step since","com.atlassian.id.two.step.verification.setup.subheading":"Let''s get you set up","com.atlassian.id.two.step.verification.setup.form.label":"Account password","com.atlassian.id.two.step.verification.setup.form.submit":"Set up two-step verification","com.atlassian.id.two.step.verification.setup.form.unlock":"Unlock settings","com.atlassian.id.two.step.verification.info.explanation":"What you need to know","com.atlassian.id.two.step.verification.info.explanation.points.1":"We''ll prompt you for a verification code when you log into JIRA, Confluence, and SourceTree.","com.atlassian.id.two.step.verification.info.explanation.points.2":"We won''t prompt for a verification code when you log in with Google or SAML. We recommend that you use Google''s 2-Step Verification or your SAML provider''s equivalent.","com.atlassian.id.two.step.verification.info.explanation.points.3":"You can''t use two-step verification with our JIRA and Confluence REST APIs.","com.atlassian.id.two.step.verification.info.explanation.points.4.html":'<strong>Two-step verification is currently in beta</strong> - <a id="learn-more-link-sidewall" href="{0}">learn more</a> about how it works. Refer to section 11 of our <a id="customer-agreement-link" href="{1}">customer agreement</a> for more details about beta features.',"com.atlassian.id.two.step.verification.info.documentation":"Read more about the two-step verification beta.","com.atlassian.id.two.step.verification.externalauth.externallyManaged-unenrolled.title":"You can''t enable two-step verification","com.atlassian.id.two.step.verification.externalauth.externallyManaged-unenrolled.description":"You can''t set up two-step verification because you log in with Google or SAML single sign-on. For a second form of verification, use Google''s 2-Step Verification or your SAML provider''s equivalent.","com.atlassian.id.two.step.verification.externalauth.externallyManaged-enrolled.title":"You can no longer use Atlassian account''s two-step verification","com.atlassian.id.two.step.verification.externalauth.externallyManaged-enrolled.description.1":"We stopped prompting you for a verification code because your administrator required that you log in with Google or SAML single sign-on. For a second form of verification, use Google''s 2-Step Verification or your SAML provider''s equivalent.","com.atlassian.id.two.step.verification.externalauth.externallyManaged-enrolled.description.2":"We kept two-step verification enabled in the background, which you can update by entering your Atlassian account password to unlock your settings.","com.atlassian.id.two.step.verification.elevation.form.prompt.unenrolled.1":"To set up two-step verification, we''ll walk you through 3 simple steps.","com.atlassian.id.two.step.verification.elevation.form.prompt.unenrolled.2":"Start by entering your password so that we know it''s you.","com.atlassian.id.two.step.verification.elevation.form.prompt.enrolled":"For extra security, enter your password to unlock your settings.","com.atlassian.id.two.step.verification.setup.return.flag.title":"You're all set!","com.atlassian.id.two.step.verification.setup.return.flag.body":"The next time you log in, you'll need to enter a 6-digit code from your verification app.","com.atlassian.id.two.step.verification.setup.return.flag.survey":"Tell us how we did!","com.atlassian.id.two.step.verification.settings.heading":"Settings","com.atlassian.id.two.step.verification.settings.recovery-code.title":"Create new emergency recovery key","com.atlassian.id.two.step.verification.settings.recovery-code.description":"Your new key will be valid right away and the existing one will no longer work.","com.atlassian.id.two.step.verification.settings.disable.title":"Disable two-step verification","com.atlassian.id.two.step.verification.settings.disable.description":"Your account will no longer have the protection of a second login step.","com.atlassian.id.two.step.verification.settings.disable.dialog.title":"Disable two-step verification","com.atlassian.id.two.step.verification.settings.disable.dialog.description":"If you proceed, you''ll no longer have the protection of a second login step.","com.atlassian.id.two.step.verification.settings.disable.dialog.continue":"Disable","com.atlassian.id.two.step.verification.settings.disable.dialog.cancel":"Cancel","com.atlassian.id.two.step.verification.settings.disable.error.generic.title":"Something went wrong while executing your request","com.atlassian.id.two.step.verification.settings.disable.error.generic.body":"Please try again later","com.atlassian.id.two.step.verification.settings.disable.error.unauthenticated.title":"We've locked your two-step verification settings.","com.atlassian.id.two.step.verification.settings.disable.error.unauthenticated.body":"Please enter your Atlassian account password to unlock and try again."}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],i=n.waitForUser,o=n.appendServerToProperties,a=!i||p()?Promise.resolve():f;if(r.default&&r.default.EventQueue&&r.default.EventQueue.push){if(o){var l=s.default.parse(location.search);if(l.continue||l.tenant){var h="";if(l.continue){var m=document.createElement("a");m.href=l.continue,h=m.hostname}else h=l.tenant;t=Object.assign(t,{server:h})}}return a.then(function(){r.default.EventQueue.push({name:e,properties:t})}),(0,c.default)({taskFn:function(){return 0===r.default.EventQueue.length?Promise.resolve():Promise.reject("queue is not yet drained")},interval:u,masterTimeout:d}).catch(function(){return console.warn("queue did not drain within "+d+"ms")})}return Promise.resolve()};var o=n(83),r=i(o),a=n(160),s=i(a),l=n(163),c=i(l),u=5,d=40,f=new Promise(function(e,t){var n=function(){clearTimeout(i),e()},i=setTimeout(function(){document.removeEventListener("user-set",n),e()},5e3);document.addEventListener("user-set",n)}),p=function(){return window["herment-gas-client"]&&window["herment-gas-client"].config&&window["herment-gas-client"].config.user&&"default"!==window["herment-gas-client"].config.user};e.exports=t.default},function(e,t,n){"use strict";function i(e){switch(e.arrayFormat){case"index":return function(t,n,i){return null===n?[r(t,e),"[",i,"]"].join(""):[r(t,e),"[",r(i,e),"]=",r(n,e)].join("")};case"bracket":return function(t,n){return null===n?r(t,e):[r(t,e),"[]=",r(n,e)].join("")};default:return function(t,n){return null===n?r(t,e):[r(t,e),"=",r(n,e)].join("")}}}function o(e){var t;switch(e.arrayFormat){case"index":return function(e,n,i){return t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===i[e]&&(i[e]={}),void(i[e][t[1]]=n)):void(i[e]=n)};case"bracket":return function(e,n,i){return t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0===i[e]?void(i[e]=[n]):void(i[e]=[].concat(i[e],n)):void(i[e]=n)};default:return function(e,t,n){return void 0===n[e]?void(n[e]=t):void(n[e]=[].concat(n[e],t))}}}function r(e,t){return t.encode?t.strict?l(e):encodeURIComponent(e):e}function a(e){return Array.isArray(e)?e.sort():"object"===("undefined"==typeof e?"undefined":s(e))?a(Object.keys(e)).sort(function(e,t){return Number(e)-Number(t)}).map(function(t){return e[t]}):e}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(161),c=n(162);t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e,t){t=c({arrayFormat:"none"},t);var n=o(t),i=Object.create(null);return"string"!=typeof e?i:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach(function(e){var t=e.replace(/\+/g," ").split("="),o=t.shift(),r=t.length>0?t.join("="):void 0;r=void 0===r?null:decodeURIComponent(r),n(decodeURIComponent(o),r,i)}),Object.keys(i).sort().reduce(function(e,t){var n=i[t];return Boolean(n)&&"object"===("undefined"==typeof n?"undefined":s(n))&&!Array.isArray(n)?e[t]=a(n):e[t]=n,e},Object.create(null))):i},t.stringify=function(e,t){var n={encode:!0,strict:!0,arrayFormat:"none"};t=c(n,t);var o=i(t);return e?Object.keys(e).sort().map(function(n){var i=e[n];if(void 0===i)return"";if(null===i)return r(n,t);if(Array.isArray(i)){var a=[];return i.slice().forEach(function(e){void 0!==e&&a.push(o(n,e,a.length))}),a.join("&")}return r(n,t)+"="+r(i,t)}).filter(function(e){return e.length>0}).join("&"):""}},function(e,t){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},function(e,t){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function i(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;var i=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"!==i.join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(e){o[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(e){return!1}}var o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=i()?Object.assign:function(e,t){for(var i,s,l=n(e),c=1;c<arguments.length;c++){i=Object(arguments[c]);for(var u in i)r.call(i,u)&&(l[u]=i[u]);if(o){s=o(i);for(var d=0;d<s.length;d++)a.call(i,s[d])&&(l[s[d]]=i[s[d]])}}return l}},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if("function"!=typeof e.taskFn)throw new Error("No taskFn function specified in options");if(Object.keys(f).forEach(function(t){return e[t]=e[t]||f[t]}),e.name=e.name||"Poller-"+p++,d('Creating a promise poller "'+e.name+'" with interval='+e.interval+", retries="+e.retries),!u.default[e.strategy])throw new Error('Invalid strategy "'+e.strategy+'". Valid strategies are '+Object.keys(u.default));var t=u.default[e.strategy];d("("+e.name+') Using strategy "'+e.strategy+'".');var n=t.defaults;return Object.keys(n).forEach(function(t){return e[t]=e[t]||n[t]}),d("("+e.name+") Options:"),Object.keys(e).forEach(function(t){d('    "'+t+'": '+e[t])}),new a.default(function(n,i){function o(){var u=e.taskFn();u===!1&&(u=a.default.reject("Cancelled"),d("("+e.name+") Task function returned false, canceling."),i(l),r=!1);var f=a.default.resolve(u);e.timeout&&(f=f.timeout(e.timeout)),f.then(function(t){d("("+e.name+") Poll succeeded. Resolving master promise."),null!==c&&clearTimeout(c),n(t)},function(n){if(l.push(n),"function"==typeof e.progressCallback&&e.progressCallback(s,n),--s){if(r){d("("+e.name+") Poll failed. "+s+" retries remaining.");var c=t.getNextInterval(e.retries-s,e);d("("+e.name+") Waiting "+c+"ms to try again."),a.default.delay(c).then(o)}}else d("("+e.name+") Maximum retries reached. Rejecting master promise."),i(l)})}var r=!0,s=e.retries,l=[],c=null;e.masterTimeout&&(d("("+e.name+") Using master timeout of "+e.masterTimeout+" ms."),c=setTimeout(function(){d("("+e.name+") Master timeout reached. Rejecting master promise."),r=!1,i("master timeout")},e.masterTimeout)),o()})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var r=n(164),a=i(r),s=n(203),l=i(s),c=n(206),u=i(c),d=(0,l.default)("promisePoller"),f={strategy:"fixed-interval",retries:5},p=0},function(e,t,n){"use strict";function i(){try{Promise===r&&(Promise=o)}catch(e){}return r}var o;"undefined"!=typeof Promise&&(o=Promise);var r=n(165)();r.noConflict=i,e.exports=r},function(e,t,n){(function(t){"use strict";e.exports=function(){function i(){}function o(e,t){if(null==e||e.constructor!==r)throw new _("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new _("expecting a function but got "+h.classString(t))}function r(e){e!==w&&o(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function a(e){this.promise._resolveCallback(e)}function s(e){this.promise._rejectCallback(e,!1)}function l(e){var t=new r(w);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}var c,u=function(){return new _("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},d=function(){return new r.PromiseInspection(this._target())},f=function(e){return r.reject(new _(e))},p={},h=n(167);c=h.isNode?function(){var e=t.domain;return void 0===e&&(e=null),e}:function(){return null},h.notEnumerableProp(r,"_getDomain",c);var m=n(168),g=n(169),v=new g;m.defineProperty(r,"_async",{value:v});var y=n(174),_=r.TypeError=y.TypeError;r.RangeError=y.RangeError;var b=r.CancellationError=y.CancellationError;r.TimeoutError=y.TimeoutError,r.OperationalError=y.OperationalError,r.RejectionError=y.OperationalError,r.AggregateError=y.AggregateError;var w=function(){},E={},S={},x=n(175)(r,w),C=n(176)(r,w,x,f,i),T=n(177)(r),k=T.create,P=n(178)(r,T),A=(P.CapturedTrace,
n(179)(r,x,S)),O=n(180)(S),F=n(181),M=h.errorObj,D=h.tryCatch;return r.prototype.toString=function(){return"[object Promise]"},r.prototype.caught=r.prototype.catch=function(e){var t=arguments.length;if(t>1){var n,i=new Array(t-1),o=0;for(n=0;n<t-1;++n){var r=arguments[n];if(!h.isObject(r))return f("Catch statement predicate: expecting an object but got "+h.classString(r));i[o++]=r}return i.length=o,e=arguments[n],this.then(void 0,O(i,e,this))}return this.then(void 0,e)},r.prototype.reflect=function(){return this._then(d,d,void 0,this,void 0)},r.prototype.then=function(e,t){if(P.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var n=".then() only accepts functions but was passed: "+h.classString(e);arguments.length>1&&(n+=", "+h.classString(t)),this._warn(n)}return this._then(e,t,void 0,void 0,void 0)},r.prototype.done=function(e,t){var n=this._then(e,t,void 0,void 0,void 0);n._setIsFinal()},r.prototype.spread=function(e){return"function"!=typeof e?f("expecting a function but got "+h.classString(e)):this.all()._then(e,void 0,void 0,E,void 0)},r.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},r.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new C(this).promise()},r.prototype.error=function(e){return this.caught(h.originatesFromRejection,e)},r.getNewLibraryCopy=e.exports,r.is=function(e){return e instanceof r},r.fromNode=r.fromCallback=function(e){var t=new r(w);t._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=D(e)(F(t,n));return i===M&&t._rejectCallback(i.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},r.all=function(e){return new C(e).promise()},r.cast=function(e){var t=x(e);return t instanceof r||(t=new r(w),t._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},r.resolve=r.fulfilled=r.cast,r.reject=r.rejected=function(e){var t=new r(w);return t._captureStackTrace(),t._rejectCallback(e,!0),t},r.setScheduler=function(e){if("function"!=typeof e)throw new _("expecting a function but got "+h.classString(e));return v.setScheduler(e)},r.prototype._then=function(e,t,n,i,o){var a=void 0!==o,s=a?o:new r(w),l=this._target(),u=l._bitField;a||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===i&&0!==(2097152&this._bitField)&&(i=0!==(50397184&u)?this._boundValue():l===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var d=c();if(0!==(50397184&u)){var f,p,m=l._settlePromiseCtx;0!==(33554432&u)?(p=l._rejectionHandler0,f=e):0!==(16777216&u)?(p=l._fulfillmentHandler0,f=t,l._unsetRejectionIsUnhandled()):(m=l._settlePromiseLateCancellationObserver,p=new b("late cancellation observer"),l._attachExtraTrace(p),f=t),v.invoke(m,l,{handler:null===d?f:"function"==typeof f&&h.domainBind(d,f),promise:s,receiver:i,value:p})}else l._addCallbacks(e,t,s,i,d);return s},r.prototype._length=function(){return 65535&this._bitField},r.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},r.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},r.prototype._setLength=function(e){this._bitField=this._bitField&-65536|65535&e},r.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},r.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},r.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},r.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},r.prototype._isFinal=function(){return(4194304&this._bitField)>0},r.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},r.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},r.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},r.prototype._setAsyncGuaranteed=function(){v.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},r.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==p)return void 0===t&&this._isBound()?this._boundValue():t},r.prototype._promiseAt=function(e){return this[4*e-4+2]},r.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},r.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},r.prototype._boundValue=function(){},r.prototype._migrateCallback0=function(e){var t=(e._bitField,e._fulfillmentHandler0),n=e._rejectionHandler0,i=e._promise0,o=e._receiverAt(0);void 0===o&&(o=p),this._addCallbacks(t,n,i,o,null)},r.prototype._migrateCallbackAt=function(e,t){var n=e._fulfillmentHandlerAt(t),i=e._rejectionHandlerAt(t),o=e._promiseAt(t),r=e._receiverAt(t);void 0===r&&(r=p),this._addCallbacks(n,i,o,r,null)},r.prototype._addCallbacks=function(e,t,n,i,o){var r=this._length();if(r>=65531&&(r=0,this._setLength(0)),0===r)this._promise0=n,this._receiver0=i,"function"==typeof e&&(this._fulfillmentHandler0=null===o?e:h.domainBind(o,e)),"function"==typeof t&&(this._rejectionHandler0=null===o?t:h.domainBind(o,t));else{var a=4*r-4;this[a+2]=n,this[a+3]=i,"function"==typeof e&&(this[a+0]=null===o?e:h.domainBind(o,e)),"function"==typeof t&&(this[a+1]=null===o?t:h.domainBind(o,t))}return this._setLength(r+1),r},r.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},r.prototype._resolveCallback=function(e,t){if(0===(117506048&this._bitField)){if(e===this)return this._rejectCallback(u(),!1);var n=x(e,this);if(!(n instanceof r))return this._fulfill(e);t&&this._propagateFrom(n,2);var i=n._target();if(i===this)return void this._reject(u());var o=i._bitField;if(0===(50397184&o)){var a=this._length();a>0&&i._migrateCallback0(this);for(var s=1;s<a;++s)i._migrateCallbackAt(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!==(33554432&o))this._fulfill(i._value());else if(0!==(16777216&o))this._reject(i._reason());else{var l=new b("late cancellation observer");i._attachExtraTrace(l),this._reject(l)}}},r.prototype._rejectCallback=function(e,t,n){var i=h.ensureErrorObject(e),o=i===e;if(!o&&!n&&P.warnings()){var r="a promise was rejected with a non-error: "+h.classString(e);this._warn(r,!0)}this._attachExtraTrace(i,!!t&&o),this._reject(e)},r.prototype._resolveFromExecutor=function(e){if(e!==w){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,i=this._execute(e,function(e){t._resolveCallback(e)},function(e){t._rejectCallback(e,n)});n=!1,this._popContext(),void 0!==i&&t._rejectCallback(i,!0)}},r.prototype._settlePromiseFromHandler=function(e,t,n,i){var o=i._bitField;if(0===(65536&o)){i._pushContext();var r;t===E?n&&"number"==typeof n.length?r=D(e).apply(this._boundValue(),n):(r=M,r.e=new _("cannot .spread() a non-array: "+h.classString(n))):r=D(e).call(t,n);var a=i._popContext();o=i._bitField,0===(65536&o)&&(r===S?i._reject(n):r===M?i._rejectCallback(r.e,!1):(P.checkForgottenReturns(r,a,"",i,this),i._resolveCallback(r)))}},r.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},r.prototype._followee=function(){return this._rejectionHandler0},r.prototype._setFollowee=function(e){this._rejectionHandler0=e},r.prototype._settlePromise=function(e,t,n,o){var a=e instanceof r,s=this._bitField,l=0!==(134217728&s);0!==(65536&s)?(a&&e._invokeInternalOnCancel(),n instanceof A&&n.isFinallyHandler()?(n.cancelPromise=e,D(t).call(n,o)===M&&e._reject(M.e)):t===d?e._fulfill(d.call(n)):n instanceof i?n._promiseCancelled(e):a||e instanceof C?e._cancel():n.cancel()):"function"==typeof t?a?(l&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,n,o,e)):t.call(n,o,e):n instanceof i?n._isResolved()||(0!==(33554432&s)?n._promiseFulfilled(o,e):n._promiseRejected(o,e)):a&&(l&&e._setAsyncGuaranteed(),0!==(33554432&s)?e._fulfill(o):e._reject(o))},r.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,n=e.promise,i=e.receiver,o=e.value;"function"==typeof t?n instanceof r?this._settlePromiseFromHandler(t,i,o,n):t.call(i,o,n):n instanceof r&&n._reject(o)},r.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},r.prototype._settlePromise0=function(e,t,n){var i=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(i,e,o,t)},r.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},r.prototype._fulfill=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(e===this){var n=u();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,(65535&t)>0&&(0!==(134217728&t)?this._settlePromises():v.settlePromises(this))}},r.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16))return this._setRejected(),this._fulfillmentHandler0=e,this._isFinal()?v.fatalError(e,h.isNode):void((65535&t)>0?v.settlePromises(this):this._ensurePossibleRejectionHandled())},r.prototype._fulfillPromises=function(e,t){for(var n=1;n<e;n++){var i=this._fulfillmentHandlerAt(n),o=this._promiseAt(n),r=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,i,r,t)}},r.prototype._rejectPromises=function(e,t){for(var n=1;n<e;n++){var i=this._rejectionHandlerAt(n),o=this._promiseAt(n),r=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(o,i,r,t)}},r.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!==(16842752&e)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,e),this._rejectPromises(t,n)}else{var i=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,i,e),this._fulfillPromises(t,i)}this._setLength(0)}this._clearCancellationData()},r.prototype._settledValue=function(){var e=this._bitField;return 0!==(33554432&e)?this._rejectionHandler0:0!==(16777216&e)?this._fulfillmentHandler0:void 0},r.defer=r.pending=function(){P.deprecated("Promise.defer","new Promise");var e=new r(w);return{promise:e,resolve:a,reject:s}},h.notEnumerableProp(r,"_makeSelfResolutionError",u),n(182)(r,w,x,f,P),n(183)(r,w,x,P),n(184)(r,C,f,P),n(185)(r),n(186)(r),n(187)(r,C,x,w,v,c),r.Promise=r,r.version="3.5.0",n(188)(r,C,f,x,w,P),n(189)(r),n(190)(r,f,x,k,w,P),n(191)(r,w,P),n(192)(r,f,w,x,i,P),n(193)(r),n(194)(r,w),n(195)(r,C,x,f),n(196)(r,w,x,f),n(197)(r,C,f,x,w,P),n(198)(r,C,P),n(199)(r,C,f),n(200)(r,w),n(201)(r,w),n(202)(r),h.toFastProperties(r),h.toFastProperties(r.prototype),l({a:1}),l({b:2}),l({c:3}),l(1),l(function(){}),l(void 0),l(!1),l(new r(w)),P.setBounds(g.firstLineError,h.lastLineError),r}}).call(t,n(166))},function(e,t){"use strict";function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function r(e){if(d===clearTimeout)return clearTimeout(e);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){m&&p&&(m=!1,p.length?h=p.concat(h):g=-1,h.length&&s())}function s(){if(!m){var e=o(a);m=!0;for(var t=h.length;t;){for(p=h,h=[];++g<t;)p&&p[g].run();g=-1,t=h.length}p=null,m=!1,r(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var u,d,f=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(e){d=i}}();var p,h=[],m=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];h.push(new l(e,t)),1!==h.length||m||o(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){(function(t,i){"use strict";function o(){try{var e=F;return F=null,e.apply(this,arguments)}catch(e){return O.e=e,O}}function r(e){return F=e,o}function a(e){return null==e||e===!0||e===!1||"string"==typeof e||"number"==typeof e}function s(e){return"function"==typeof e||"object"===("undefined"==typeof e?"undefined":k(e))&&null!==e}function l(e){return a(e)?new Error(v(e)):e}function c(e,t){var n,i=e.length,o=new Array(i+1);for(n=0;n<i;++n)o[n]=e[n];return o[n]=t,o}function u(e,t,n){if(!P.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var i=Object.getOwnPropertyDescriptor(e,t);return null!=i?null==i.get&&null==i.set?i.value:n:void 0}function d(e,t,n){if(a(e))return e;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return P.defineProperty(e,t,i),e}function f(e){throw e}function p(e){try{if("function"==typeof e){var t=P.names(e.prototype),n=P.isES5&&t.length>1,i=t.length>0&&!(1===t.length&&"constructor"===t[0]),o=$.test(e+"")&&P.names(e).length>0;if(n||i||o)return!0}return!1}catch(e){return!1}}function h(e){function t(){}t.prototype=e;for(var n=8;n--;)new t;return e}function m(e){return N.test(e)}function g(e,t,n){for(var i=new Array(e),o=0;o<e;++o)i[o]=t+o+n;return i}function v(e){try{return e+""}catch(e){return"[no string representation]"}}function y(e){return null!==e&&"object"===("undefined"==typeof e?"undefined":k(e))&&"string"==typeof e.message&&"string"==typeof e.name}function _(e){try{d(e,"isOperational",!0)}catch(e){}}function b(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||e.isOperational===!0)}function w(e){return y(e)&&P.propertyIsWritable(e,"stack")}function E(e){return{}.toString.call(e)}function S(e,t,n){for(var i=P.names(e),o=0;o<i.length;++o){var r=i[o];if(n(r))try{P.defineProperty(t,r,P.getDescriptor(e,r))}catch(e){}}}function x(e){return L?i.env[e]:void 0}function C(){if("function"==typeof Promise)try{var e=new Promise(function(){});if("[object Promise]"==={}.toString.call(e))return Promise}catch(e){}}function T(e,t){return e.bind(t)}var k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P=n(168),A="undefined"==typeof navigator,O={e:{}},F,M="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof t?t:null,D=function(e,t){function n(){this.constructor=e,this.constructor$=t;for(var n in t.prototype)i.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}var i={}.hasOwnProperty;return n.prototype=t.prototype,e.prototype=new n,e.prototype},j=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(P.isES5){var n=Object.getOwnPropertyNames;return function(e){for(var i=[],o=Object.create(null);null!=e&&!t(e);){var r;try{r=n(e)}catch(e){return i}for(var a=0;a<r.length;++a){var s=r[a];if(!o[s]){o[s]=!0;var l=Object.getOwnPropertyDescriptor(e,s);null!=l&&null==l.get&&null==l.set&&i.push(s)}}e=P.getPrototypeOf(e)}return i}}var i={}.hasOwnProperty;return function(n){if(t(n))return[];var o=[];e:for(var r in n)if(i.call(n,r))o.push(r);else{for(var a=0;a<e.length;++a)if(i.call(e[a],r))continue e;o.push(r)}return o}}(),$=/this\s*\.\s*\S+\s*=/,N=/^[a-z$_][a-z$_0-9]*$/i,I=function(){return"stack"in new Error?function(e){return w(e)?e:new Error(v(e))}:function(e){if(w(e))return e;try{throw new Error(v(e))}catch(e){return e}}}(),U=function(e){return P.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var R="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,n=[],i=e[Symbol.iterator]();!(t=i.next()).done;)n.push(t.value);return n};U=function(e){return P.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?R(e):null}}var H="undefined"!=typeof i&&"[object process]"===E(i).toLowerCase(),L="undefined"!=typeof i&&"undefined"!=typeof i.env,V={isClass:p,isIdentifier:m,inheritedDataKeys:j,getDataPropertyOrDefault:u,thrower:f,isArray:P.isArray,asArray:U,notEnumerableProp:d,isPrimitive:a,isObject:s,isError:y,canEvaluate:A,errorObj:O,tryCatch:r,inherits:D,withAppended:c,maybeWrapAsError:l,toFastProperties:h,filledRange:g,toString:v,canAttachTrace:w,ensureErrorObject:I,originatesFromRejection:b,markAsOriginatingFromRejection:_,classString:E,copyDescriptors:S,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:H,hasEnvVariables:L,env:x,global:M,getNativePromise:C,domainBind:T};V.isRecentNode=V.isNode&&function(){var e=i.versions.node.split(".").map(Number);return 0===e[0]&&e[1]>10||e[0]>0}(),V.isNode&&V.toFastProperties(i);try{throw new Error}catch(e){V.lastLineError=e}e.exports=V}).call(t,function(){return this}(),n(166))},function(e,t){"use strict";var n=function(){return void 0===this}();if(n)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,r={}.constructor.prototype,a=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},s=function(e,t){return{value:e[t]}},l=function(e,t,n){return e[t]=n.value,e},c=function(e){return e},u=function(e){try{return Object(e).constructor.prototype}catch(e){return r}},d=function(e){try{return"[object Array]"===o.call(e)}catch(e){return!1}};e.exports={isArray:d,keys:a,names:a,defineProperty:l,getDescriptor:s,freeze:c,getPrototypeOf:u,isES5:n,propertyIsWritable:function(){return!0}}}},function(e,t,n){(function(t){"use strict";function i(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new c(16),this._normalQueue=new c(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=l}function o(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function r(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function a(e){this._normalQueue._pushOne(e),this._queueTick()}var s;try{throw new Error}catch(e){s=e}var l=n(170),c=n(173),u=n(167);i.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},i.prototype.hasCustomScheduler=function(){return this._customScheduler},i.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},i.prototype.disableTrampolineIfNecessary=function(){u.hasDevTools&&(this._trampolineEnabled=!1)},i.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},i.prototype.fatalError=function(e,n){n?(t.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),t.exit(2)):this.throwLater(e)},i.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},u.hasDevTools?(i.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?o.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},i.prototype.invoke=function(e,t,n){this._trampolineEnabled?r.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},i.prototype.settlePromises=function(e){this._trampolineEnabled?a.call(this,e):this._schedule(function(){e._settlePromises()})}):(i.prototype.invokeLater=o,i.prototype.invoke=r,i.prototype.settlePromises=a),i.prototype._drainQueue=function(e){for(;e.length()>0;){var t=e.shift();if("function"==typeof t){var n=e.shift(),i=e.shift();t.call(n,i)}else t._settlePromises()}},i.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,this._drainQueue(this._lateQueue)},i.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},i.prototype._reset=function(){this._isTickUsed=!1},e.exports=i,e.exports.firstLineError=s}).call(t,n(166))},function(e,t,n){(function(t,i,o){"use strict";var r,a=n(167),s=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},l=a.getNativePromise();if(a.isNode&&"undefined"==typeof MutationObserver){var c=t.setImmediate,u=i.nextTick;r=a.isRecentNode?function(e){c.call(t,e)}:function(e){u.call(i,e)}}else if("function"==typeof l&&"function"==typeof l.resolve){var d=l.resolve();r=function(e){d.then(e)}}else r="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof o?function(e){o(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:s:function(){var e=document.createElement("div"),t={attributes:!0},n=!1,i=document.createElement("div"),o=new MutationObserver(function(){e.classList.toggle("foo"),n=!1});o.observe(i,t);var r=function(){n||(n=!0,i.classList.toggle("foo"))};return function(n){var i=new MutationObserver(function(){i.disconnect(),n()});i.observe(e,t),r()}}();e.exports=r}).call(t,function(){return this}(),n(166),n(171).setImmediate)},function(e,t,n){"use strict";function i(e,t){this._id=e,this._clearFn=t}var o=Function.prototype.apply;t.setTimeout=function(){return new i(o.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(172),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){(function(e,t){"use strict";!function(e,n){function i(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return m[h]=i,p(h),h++}function o(e){delete m[e]}function r(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}function a(e){if(g)setTimeout(a,0,e);else{var t=m[e];if(t){g=!0;try{r(t)}finally{o(e),g=!1}}}}function s(){p=function(e){t.nextTick(function(){a(e)})}}function l(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function c(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),p=function(n){e.postMessage(t+n,"*")}}function u(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;a(t)},p=function(t){e.port2.postMessage(t)}}function d(){var e=v.documentElement;p=function(t){var n=v.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function f(){p=function(e){setTimeout(a,0,e)}}if(!e.setImmediate){var p,h=1,m={},g=!1,v=e.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e,"[object process]"==={}.toString.call(e.process)?s():l()?c():e.MessageChannel?u():v&&"onreadystatechange"in v.createElement("script")?d():f(),y.setImmediate=i,y.clearImmediate=o}}("undefined"==typeof self?"undefined"==typeof e?void 0:e:self)}).call(t,function(){return this}(),n(166))},function(e,t){"use strict";function n(e,t,n,i,o){for(var r=0;r<o;++r)n[r+i]=e[r+t],e[r+t]=void 0}function i(e){this._capacity=e,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(e){return this._capacity<e},i.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var n=this._front+t&this._capacity-1;this[n]=e,this._length=t+1},i.prototype.push=function(e,t,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(e),this._pushOne(t),void this._pushOne(n);var o=this._front+i-3;this._checkCapacity(i);var r=this._capacity-1;this[o+0&r]=e,this[o+1&r]=t,this[o+2&r]=n,this._length=i},i.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var i=this._front,o=this._length,r=i+o&t-1;n(this,0,this,t,r)},e.exports=i},function(e,t,n){"use strict";function i(e,t){function n(i){return this instanceof n?(d(this,"message","string"==typeof i?i:t),d(this,"name",e),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(i)}return u(n,Error),n}function o(e){return this instanceof o?(d(this,"name","OperationalError"),d(this,"message",e),this.cause=e,this.isOperational=!0,void(e instanceof Error?(d(this,"message",e.message),d(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new o(e)}var r,a,s=n(168),l=s.freeze,c=n(167),u=c.inherits,d=c.notEnumerableProp,f=i("Warning","warning"),p=i("CancellationError","cancellation error"),h=i("TimeoutError","timeout error"),m=i("AggregateError","aggregate error");try{r=TypeError,a=RangeError}catch(e){r=i("TypeError","type error"),a=i("RangeError","range error")}for(var g="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),v=0;v<g.length;++v)"function"==typeof Array.prototype[g[v]]&&(m.prototype[g[v]]=Array.prototype[g[v]]);s.defineProperty(m.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),m.prototype.isOperational=!0;var y=0;m.prototype.toString=function(){var e=Array(4*y+1).join(" "),t="\n"+e+"AggregateError of:\n";y++,e=Array(4*y+1).join(" ");for(var n=0;n<this.length;++n){for(var i=this[n]===this?"[Circular AggregateError]":this[n]+"",o=i.split("\n"),r=0;r<o.length;++r)o[r]=e+o[r];i=o.join("\n"),t+=i+"\n"}return y--,t},u(o,Error);var _=Error.__BluebirdErrorTypes__;_||(_=l({CancellationError:p,TimeoutError:h,OperationalError:o,RejectionError:o,AggregateError:m}),s.defineProperty(Error,"__BluebirdErrorTypes__",{value:_,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:r,RangeError:a,CancellationError:_.CancellationError,OperationalError:_.OperationalError,TimeoutError:_.TimeoutError,AggregateError:_.AggregateError,Warning:f}},function(e,t,n){"use strict";e.exports=function(e,t){function i(n,i){if(u(n)){if(n instanceof e)return n;var o=r(n);if(o===c){i&&i._pushContext();var l=e.reject(o.e);return i&&i._popContext(),l}if("function"==typeof o){if(a(n)){var l=new e(t);return n._then(l._fulfill,l._reject,void 0,l,null),l}return s(n,o,i)}}return n}function o(e){return e.then}function r(e){try{return o(e)}catch(e){return c.e=e,c}}function a(e){try{return d.call(e,"_promise0")}catch(e){return!1}}function s(n,i,o){function r(e){s&&(s._resolveCallback(e),s=null)}function a(e){s&&(s._rejectCallback(e,d,!0),s=null)}var s=new e(t),u=s;o&&o._pushContext(),s._captureStackTrace(),o&&o._popContext();var d=!0,f=l.tryCatch(i).call(n,r,a);return d=!1,s&&f===c&&(s._rejectCallback(f.e,!0,!0),s=null),u}var l=n(167),c=l.errorObj,u=l.isObject,d={}.hasOwnProperty;return i}},function(e,t,n){"use strict";e.exports=function(e,t,i,o,r){function a(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}function s(n){var i=this._promise=new e(t);n instanceof e&&i._propagateFrom(n,3),i._setOnCancel(this),this._values=n,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var l=n(167);l.isArray;return l.inherits(s,r),s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function t(n,r){var s=i(this._values,this._promise);if(s instanceof e){s=s._target();var c=s._bitField;if(this._values=s,0===(50397184&c))return this._promise._setAsyncGuaranteed(),s._then(t,this._reject,void 0,this,r);if(0===(33554432&c))return 0!==(16777216&c)?this._reject(s._reason()):this._cancel();s=s._value()}if(s=l.asArray(s),null===s){var u=o("expecting an array or an iterable object but got "+l.classString(s)).reason();return void this._promise._rejectCallback(u,!1)}return 0===s.length?void(r===-5?this._resolveEmptyArray():this._resolve(a(r))):void this._iterate(s)},s.prototype._iterate=function(t){var n=this.getActualLength(t.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var o=this._promise,r=!1,a=null,s=0;s<n;++s){var l=i(t[s],o);l instanceof e?(l=l._target(),a=l._bitField):a=null,r?null!==a&&l.suppressUnhandledRejections():null!==a?0===(50397184&a)?(l._proxy(this,s),this._values[s]=l):r=0!==(33554432&a)?this._promiseFulfilled(l._value(),s):0!==(16777216&a)?this._promiseRejected(l._reason(),s):this._promiseCancelled(s):r=this._promiseFulfilled(l,s)}r||o._setAsyncGuaranteed()},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},s.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},s.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},s.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},s.prototype._promiseCancelled=function(){return this._cancel(),!0},s.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},s.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var n=0;n<t.length;++n)t[n]instanceof e&&t[n].cancel()}},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(e){return e},s}},function(e,t){"use strict";e.exports=function(e){function t(){this._trace=new t.CapturedTrace(i())}function n(){if(o)return new t}function i(){var e=r.length-1;if(e>=0)return r[e]}var o=!1,r=[];return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},t.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},t.prototype._popContext=function(){if(void 0!==this._trace){var e=r.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},t.CapturedTrace=null,t.create=n,t.deactivateLongStackTraces=function(){},t.activateLongStackTraces=function(){var n=e.prototype._pushContext,r=e.prototype._popContext,a=e._peekContext,s=e.prototype._peekContext,l=e.prototype._promiseCreated;t.deactivateLongStackTraces=function(){e.prototype._pushContext=n,e.prototype._popContext=r,e._peekContext=a,e.prototype._peekContext=s,e.prototype._promiseCreated=l,
o=!1},o=!0,e.prototype._pushContext=t.prototype._pushContext,e.prototype._popContext=t.prototype._popContext,e._peekContext=e.prototype._peekContext=i,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},t}},function(e,t,n){(function(t){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e,o){function r(e,t){return{promise:t}}function a(){return!1}function s(e,t,n){var i=this;try{e(t,n,function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+H.toString(e));i._attachCancellationCallback(e)})}catch(e){return e}}function l(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?H.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function c(){return this._onCancelField}function u(e){this._onCancelField=e}function d(){this._cancellationParent=void 0,this._onCancelField=void 0}function f(e,t){if(0!==(1&t)){this._cancellationParent=e;var n=e._branchesRemainingToCancel;void 0===n&&(n=0),e._branchesRemainingToCancel=n+1}0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function p(e,t){0!==(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}function h(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function m(){this._trace=new D(this._peekContext())}function g(e,t){if(L(e)){var n=this._trace;if(void 0!==n&&t&&(n=n._parent),void 0!==n)n.attachExtraTrace(e);else if(!e.__stackCleaned__){var i=C(e);H.notEnumerableProp(e,"stack",i.message+"\n"+i.stack.join("\n")),H.notEnumerableProp(e,"__stackCleaned__",!0)}}}function v(e,t,n,i,o){if(void 0===e&&null!==t&&X){if(void 0!==o&&o._returnedNonUndefined())return;if(0===(65535&i._bitField))return;n&&(n+=" ");var r="",a="";if(t._trace){for(var s=t._trace.stack.split("\n"),l=S(s),c=l.length-1;c>=0;--c){var u=l[c];if(!z.test(u)){var d=u.match(B);d&&(r="at "+d[1]+":"+d[2]+":"+d[3]+" ");break}}if(l.length>0)for(var f=l[0],c=0;c<s.length;++c)if(s[c]===f){c>0&&(a="\n"+s[c-1]);break}}var p="a promise was created in a "+n+"handler "+r+"but was not returned from it, see http://goo.gl/rRqMUw"+a;i._warn(p,!0,t)}}function y(e,t){var n=e+" is deprecated and will be removed in a future version.";return t&&(n+=" Use "+t+" instead."),_(n)}function _(t,n,i){if(se.warnings){var o,r=new R(t);if(n)i._attachExtraTrace(r);else if(se.longStackTraces&&(o=e._peekContext()))o.attachExtraTrace(r);else{var a=C(r);r.stack=a.message+"\n"+a.stack.join("\n")}ne("warning",r)||T(r,"",!0)}}function b(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function w(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}function E(e){for(var t=e[0],n=1;n<e.length;++n){for(var i=e[n],o=t.length-1,r=t[o],a=-1,s=i.length-1;s>=0;--s)if(i[s]===r){a=s;break}for(var s=a;s>=0;--s){var l=i[s];if(t[o]!==l)break;t.pop(),o--}t=i}}function S(e){for(var t=[],n=0;n<e.length;++n){var i=e[n],o="    (No stack trace)"===i||W.test(i),r=o&&oe(i);o&&!r&&(Y&&" "!==i.charAt(0)&&(i="    "+i),t.push(i))}return t}function x(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),n=0;n<t.length;++n){var i=t[n];if("    (No stack trace)"===i||W.test(i))break}return n>0&&"SyntaxError"!=e.name&&(t=t.slice(n)),t}function C(e){var t=e.stack,n=e.toString();return t="string"==typeof t&&t.length>0?x(e):["    (No stack trace)"],{message:n,stack:"SyntaxError"==e.name?t:S(t)}}function T(e,t,n){if("undefined"!=typeof console){var o;if(H.isObject(e)){var r=e.stack;o=t+G(r,e)}else o=t+String(e);"function"==typeof N?N(o,n):"function"!=typeof console.log&&"object"!==i(console.log)||console.log(o)}}function k(e,t,n,i){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(i):t(n,i))}catch(e){U.throwLater(e)}"unhandledRejection"===e?ne(e,n,i)||o||T(n,"Unhandled rejection "):ne(e,i)}function P(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():H.toString(e);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(t))try{var i=JSON.stringify(e);t=i}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+A(t)+">, no stack trace)"}function A(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function O(){return"function"==typeof ae}function F(e){var t=e.match(re);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function M(e,t){if(O()){for(var n,i,o=e.stack.split("\n"),r=t.stack.split("\n"),a=-1,s=-1,l=0;l<o.length;++l){var c=F(o[l]);if(c){n=c.fileName,a=c.line;break}}for(var l=0;l<r.length;++l){var c=F(r[l]);if(c){i=c.fileName,s=c.line;break}}a<0||s<0||!n||!i||n!==i||a>=s||(oe=function(e){if(V.test(e))return!0;var t=F(e);return!!(t&&t.fileName===n&&a<=t.line&&t.line<=s)})}}function D(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);ae(this,D),t>32&&this.uncycle()}var j,$,N,I=e._getDomain,U=e._async,R=n(174).Warning,H=n(167),L=H.canAttachTrace,V=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,z=/\((?:timers\.js):\d+:\d+\)/,B=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,W=null,G=null,Y=!1,q=!(0==H.env("BLUEBIRD_DEBUG")||!H.env("BLUEBIRD_DEBUG")&&"development"!==H.env("NODE_ENV")),K=!(0==H.env("BLUEBIRD_WARNINGS")||!q&&!H.env("BLUEBIRD_WARNINGS")),J=!(0==H.env("BLUEBIRD_LONG_STACK_TRACES")||!q&&!H.env("BLUEBIRD_LONG_STACK_TRACES")),X=0!=H.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(K||!!H.env("BLUEBIRD_W_FORGOTTEN_RETURN"));e.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=e._bitField&-1048577|524288},e.prototype._ensurePossibleRejectionHandled=function(){0===(524288&this._bitField)&&(this._setRejectionIsUnhandled(),U.invokeLater(this._notifyUnhandledRejection,this,void 0))},e.prototype._notifyUnhandledRejectionIsHandled=function(){k("rejectionHandled",j,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),k("unhandledRejection",$,e,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(e,t,n){return _(e,t,n||this)},e.onPossiblyUnhandledRejection=function(e){var t=I();$="function"==typeof e?null===t?e:H.domainBind(t,e):void 0},e.onUnhandledRejectionHandled=function(e){var t=I();j="function"==typeof e?null===t?e:H.domainBind(t,e):void 0};var Q=function(){};e.longStackTraces=function(){if(U.haveItemsQueued()&&!se.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!se.longStackTraces&&O()){var t=e.prototype._captureStackTrace,n=e.prototype._attachExtraTrace;se.longStackTraces=!0,Q=function(){if(U.haveItemsQueued()&&!se.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=t,e.prototype._attachExtraTrace=n,o.deactivateLongStackTraces(),U.enableTrampoline(),se.longStackTraces=!1},e.prototype._captureStackTrace=m,e.prototype._attachExtraTrace=g,o.activateLongStackTraces(),U.disableTrampolineIfNecessary()}},e.hasLongStackTraces=function(){return se.longStackTraces&&O()};var Z=function(){try{if("function"==typeof CustomEvent){var e=new CustomEvent("CustomEvent");return H.global.dispatchEvent(e),function(e,t){var n=new CustomEvent(e.toLowerCase(),{detail:t,cancelable:!0});return!H.global.dispatchEvent(n)}}if("function"==typeof Event){var e=new Event("CustomEvent");return H.global.dispatchEvent(e),function(e,t){var n=new Event(e.toLowerCase(),{cancelable:!0});return n.detail=t,!H.global.dispatchEvent(n)}}var e=document.createEvent("CustomEvent");return e.initCustomEvent("testingtheevent",!1,!0,{}),H.global.dispatchEvent(e),function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e.toLowerCase(),!1,!0,t),!H.global.dispatchEvent(n)}}catch(e){}return function(){return!1}}(),ee=function(){return H.isNode?function(){return t.emit.apply(t,arguments)}:H.global?function(e){var t="on"+e.toLowerCase(),n=H.global[t];return!!n&&(n.apply(H.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),te={promiseCreated:r,promiseFulfilled:r,promiseRejected:r,promiseResolved:r,promiseCancelled:r,promiseChained:function(e,t,n){return{promise:t,child:n}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,n){return{reason:t,promise:n}},rejectionHandled:r},ne=function(e){var t=!1;try{t=ee.apply(null,arguments)}catch(e){U.throwLater(e),t=!0}var n=!1;try{n=Z(e,te[e].apply(null,arguments))}catch(e){U.throwLater(e),n=!0}return n||t};e.config=function(t){if(t=Object(t),"longStackTraces"in t&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&Q()),"warnings"in t){var n=t.warnings;se.warnings=!!n,X=se.warnings,H.isObject(n)&&"wForgottenReturn"in n&&(X=!!n.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!se.cancellation){if(U.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=d,e.prototype._propagateFrom=f,e.prototype._onCancel=c,e.prototype._setOnCancel=u,e.prototype._attachCancellationCallback=l,e.prototype._execute=s,ie=f,se.cancellation=!0}return"monitoring"in t&&(t.monitoring&&!se.monitoring?(se.monitoring=!0,e.prototype._fireEvent=ne):!t.monitoring&&se.monitoring&&(se.monitoring=!1,e.prototype._fireEvent=a)),e},e.prototype._fireEvent=a,e.prototype._execute=function(e,t,n){try{e(t,n)}catch(e){return e}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(e){},e.prototype._attachCancellationCallback=function(e){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(e,t){};var ie=p,oe=function(){return!1},re=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;H.inherits(D,Error),o.CapturedTrace=D,D.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],n={},i=0,o=this;void 0!==o;++i)t.push(o),o=o._parent;e=this._length=i;for(var i=e-1;i>=0;--i){var r=t[i].stack;void 0===n[r]&&(n[r]=i)}for(var i=0;i<e;++i){var a=t[i].stack,s=n[a];if(void 0!==s&&s!==i){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[i]._parent=void 0,t[i]._length=1;var l=i>0?t[i-1]:this;s<e-1?(l._parent=t[s+1],l._parent.uncycle(),l._length=l._parent._length+1):(l._parent=void 0,l._length=1);for(var c=l._length+1,u=i-2;u>=0;--u)t[u]._length=c,c++;return}}}},D.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=C(e),n=t.message,i=[t.stack],o=this;void 0!==o;)i.push(S(o.stack.split("\n"))),o=o._parent;E(i),w(i),H.notEnumerableProp(e,"stack",b(n,i)),H.notEnumerableProp(e,"__stackCleaned__",!0)}};var ae=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():P(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,W=e,G=t;var n=Error.captureStackTrace;return oe=function(e){return V.test(e)},function(e,t){Error.stackTraceLimit+=6,n(e,t),Error.stackTraceLimit-=6}}var o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return W=/@/,G=t,Y=!0,function(e){e.stack=(new Error).stack};var r;try{throw new Error}catch(e){r="stack"in e}return"stack"in o||!r||"number"!=typeof Error.stackTraceLimit?(G=function(e,t){return"string"==typeof e?e:"object"!==("undefined"==typeof t?"undefined":i(t))&&"function"!=typeof t||void 0===t.name||void 0===t.message?P(t):t.toString()},null):(W=e,G=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(N=function(e){console.warn(e)},H.isNode&&t.stderr.isTTY?N=function(e,t){var n=t?"[33m":"[31m";console.warn(n+e+"[0m\n")}:H.isNode||"string"!=typeof(new Error).stack||(N=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var se={warnings:K,longStackTraces:!1,cancellation:!1,monitoring:!1};return J&&e.longStackTraces(),{longStackTraces:function(){return se.longStackTraces},warnings:function(){return se.warnings},cancellation:function(){return se.cancellation},monitoring:function(){return se.monitoring},propagateFromFunction:function(){return ie},boundValueFunction:function(){return h},checkForgottenReturns:v,setBounds:M,warn:_,deprecated:y,CapturedTrace:D,fireDomEvent:Z,fireGlobalEvent:ee}}}).call(t,n(166))},function(e,t,n){"use strict";e.exports=function(e,t,i){function o(e,t,n){this.promise=e,this.type=t,this.handler=n,this.called=!1,this.cancelPromise=null}function r(e){this.finallyHandler=e}function a(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function s(){return c.call(this,this.promise._target()._settledValue())}function l(e){if(!a(this,e))return f.e=e,f}function c(n){var o=this.promise,c=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?c.call(o._boundValue()):c.call(o._boundValue(),n);if(u===i)return u;if(void 0!==u){o._setReturnedNonUndefined();var p=t(u,o);if(p instanceof e){if(null!=this.cancelPromise){if(p._isCancelled()){var h=new d("late cancellation observer");return o._attachExtraTrace(h),f.e=h,f}p.isPending()&&p._attachCancellationCallback(new r(this))}return p._then(s,l,void 0,this,void 0)}}}return o.isRejected()?(a(this),f.e=n,f):(a(this),n)}var u=n(167),d=e.CancellationError,f=u.errorObj,p=n(180)(i);return o.prototype.isFinallyHandler=function(){return 0===this.type},r.prototype._resultCancelled=function(){a(this.finallyHandler)},e.prototype._passThrough=function(e,t,n,i){return"function"!=typeof e?this.then():this._then(n,i,void 0,new o(this,t,e),void 0)},e.prototype.lastly=e.prototype.finally=function(e){return this._passThrough(e,0,c,c)},e.prototype.tap=function(e){return this._passThrough(e,1,c)},e.prototype.tapCatch=function(t){var n=arguments.length;if(1===n)return this._passThrough(t,1,void 0,c);var i,o=new Array(n-1),r=0;for(i=0;i<n-1;++i){var a=arguments[i];if(!u.isObject(a))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+u.classString(a)));o[r++]=a}o.length=r;var s=arguments[i];return this._passThrough(p(o,s,this),1,void 0,c)},o}},function(e,t,n){"use strict";e.exports=function(e){function t(t,n,s){return function(l){var c=s._boundValue();e:for(var u=0;u<t.length;++u){var d=t[u];if(d===Error||null!=d&&d.prototype instanceof Error){if(l instanceof d)return r(n).call(c,l)}else if("function"==typeof d){var f=r(d).call(c,l);if(f===a)return f;if(f)return r(n).call(c,l)}else if(i.isObject(l)){for(var p=o(d),h=0;h<p.length;++h){var m=p[h];if(d[m]!=l[m])continue e}return r(n).call(c,l)}}return e}}var i=n(167),o=n(168).keys,r=i.tryCatch,a=i.errorObj;return t}},function(e,t,n){"use strict";function i(e){return e instanceof Error&&u.getPrototypeOf(e)===Error.prototype}function o(e){var t;if(i(e)){t=new c(e),t.name=e.name,t.message=e.message,t.stack=e.stack;for(var n=u.keys(e),o=0;o<n.length;++o){var r=n[o];d.test(r)||(t[r]=e[r])}return t}return a.markAsOriginatingFromRejection(e),e}function r(e,t){return function(n,i){if(null!==e){if(n){var r=o(s(n));e._attachExtraTrace(r),e._reject(r)}else if(t){for(var a=arguments.length,l=new Array(Math.max(a-1,0)),c=1;c<a;++c)l[c-1]=arguments[c];e._fulfill(l)}else e._fulfill(i);e=null}}}var a=n(167),s=a.maybeWrapAsError,l=n(174),c=l.OperationalError,u=n(168),d=/^(?:name|message|stack|cause)$/;e.exports=r},function(e,t,n){"use strict";e.exports=function(e,t,i,o,r){var a=n(167),s=a.tryCatch;e.method=function(n){if("function"!=typeof n)throw new e.TypeError("expecting a function but got "+a.classString(n));return function(){var i=new e(t);i._captureStackTrace(),i._pushContext();var o=s(n).apply(this,arguments),a=i._popContext();return r.checkForgottenReturns(o,a,"Promise.method",i),i._resolveFromSyncValue(o),i}},e.attempt=e.try=function(n){if("function"!=typeof n)return o("expecting a function but got "+a.classString(n));var i=new e(t);i._captureStackTrace(),i._pushContext();var l;if(arguments.length>1){r.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],u=arguments[2];l=a.isArray(c)?s(n).apply(u,c):s(n).call(u,c)}else l=s(n)();var d=i._popContext();return r.checkForgottenReturns(l,d,"Promise.try",i),i._resolveFromSyncValue(l),i},e.prototype._resolveFromSyncValue=function(e){e===a.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},function(e,t){"use strict";e.exports=function(e,t,n,i){var o=!1,r=function(e,t){this._reject(t)},a=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(r,r,null,this,e)},s=function(e,t){0===(50397184&this._bitField)&&this._resolveCallback(t.target)},l=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(r){o||(o=!0,e.prototype._propagateFrom=i.propagateFromFunction(),e.prototype._boundValue=i.boundValueFunction());var c=n(r),u=new e(t);u._propagateFrom(this,1);var d=this._target();if(u._setBoundTo(c),c instanceof e){var f={promiseRejectionQueued:!1,promise:u,target:d,bindingPromise:c};d._then(t,a,void 0,u,f),c._then(s,l,void 0,u,f),u._setOnCancel(c)}else u._resolveCallback(d);return u},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=this._bitField&-2097153},e.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},e.bind=function(t,n){return e.resolve(n).bind(t)}}},function(e,t,n){"use strict";e.exports=function(e,t,i,o){var r=n(167),a=r.tryCatch,s=r.errorObj,l=e._async;e.prototype.break=e.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var n=e._cancellationParent;if(null==n||!n._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=n}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),l.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,t){if(r.isArray(e))for(var n=0;n<e.length;++n)this._doInvokeOnCancel(e[n],t);else if(void 0!==e)if("function"==typeof e){if(!t){var i=a(e).call(this._boundValue());i===s&&(this._attachExtraTrace(i.e),l.throwLater(i.e))}}else e._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),l.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},function(e,t){"use strict";e.exports=function(e){function t(){return this.value}function n(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(n){return n instanceof e&&n.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:n},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(n,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:e},void 0);var t=arguments[1],i=function(){throw t};return this.caught(e,i)},e.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof e&&n.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:n},void 0);var i=arguments[1];i instanceof e&&i.suppressUnhandledRejections();var o=function(){return i};return this.caught(n,o)}}},function(e,t){"use strict";e.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var n=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},r=t.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},a=t.prototype.isPending=function(){return 0===(50397184&this._bitField)},s=t.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},e.prototype.isPending=function(){return a.call(this._target())},e.prototype.isRejected=function(){return r.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return s.call(this._target())},e.prototype.value=function(){return n.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),i.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},function(e,t,n){"use strict";e.exports=function(e,t,i,o,r,a){var s,l=n(167),c=l.canEvaluate,u=l.tryCatch,d=l.errorObj;if(c){for(var f=function(e){return new Function("value","holder","                             \n\t            'use strict';                                                    \n\t            holder.pIndex = value;                                           \n\t            holder.checkFulfillment(this);                                   \n\t            ".replace(/Index/g,e))},p=function(e){return new Function("promise","holder","                           \n\t            'use strict';                                                    \n\t            holder.pIndex = promise;                                         \n\t            ".replace(/Index/g,e))},h=function(t){for(var n=new Array(t),i=0;i<n.length;++i)n[i]="this.p"+(i+1);var o=n.join(" = ")+" = null;",a="var promise;\n"+n.map(function(e){return"                                                         \n\t                promise = "+e+";                                      \n\t                if (promise instanceof Promise) {                            \n\t                    promise.cancel();                                        \n\t                }                                                            \n\t            "}).join("\n"),s=n.join(", "),l="Holder$"+t,c="return function(tryCatch, errorObj, Promise, async) {    \n\t            'use strict';                                                    \n\t            function [TheName](fn) {                                         \n\t                [TheProperties]                                              \n\t                this.fn = fn;                                                \n\t                this.asyncNeeded = true;                                     \n\t                this.now = 0;                                                \n\t            }                                                                \n\t                                                                             \n\t            [TheName].prototype._callFunction = function(promise) {          \n\t                promise._pushContext();                                      \n\t                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n\t                promise._popContext();                                       \n\t                if (ret === errorObj) {                                      \n\t                    promise._rejectCallback(ret.e, false);                   \n\t                } else {                                                     \n\t                    promise._resolveCallback(ret);                           \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype.checkFulfillment = function(promise) {       \n\t                var now = ++this.now;                                        \n\t                if (now === [TheTotal]) {                                    \n\t                    if (this.asyncNeeded) {                                  \n\t                        async.invoke(this._callFunction, this, promise);     \n\t                    } else {                                                 \n\t                        this._callFunction(promise);                         \n\t                    }                                                        \n\t                                                                             \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype._resultCancelled = function() {              \n\t                [CancellationCode]                                           \n\t            };                                                               \n\t                                                                             \n\t            return [TheName];                                                \n\t        }(tryCatch, errorObj, Promise, async);                               \n\t        ";return c=c.replace(/\[TheName\]/g,l).replace(/\[TheTotal\]/g,t).replace(/\[ThePassedArguments\]/g,s).replace(/\[TheProperties\]/g,o).replace(/\[CancellationCode\]/g,a),new Function("tryCatch","errorObj","Promise","async",c)(u,d,e,r)},m=[],g=[],v=[],y=0;y<8;++y)m.push(h(y+1)),g.push(f(y+1)),v.push(p(y+1));s=function(e){this._reject(e)}}e.join=function(){var n,r=arguments.length-1;if(r>0&&"function"==typeof arguments[r]&&(n=arguments[r],r<=8&&c)){var u=new e(o);u._captureStackTrace();for(var d=m[r-1],f=new d(n),p=g,h=0;h<r;++h){var y=i(arguments[h],u);if(y instanceof e){y=y._target();var _=y._bitField;0===(50397184&_)?(y._then(p[h],s,void 0,u,f),v[h](y,f),f.asyncNeeded=!1):0!==(33554432&_)?p[h].call(u,y._value(),f):0!==(16777216&_)?u._reject(y._reason()):u._cancel()}else p[h].call(u,y,f)}if(!u._isFateSealed()){if(f.asyncNeeded){var b=a();null!==b&&(f.fn=l.domainBind(b,f.fn))}u._setAsyncGuaranteed(),u._setOnCancel(f)}return u}for(var w=arguments.length,E=new Array(w),S=0;S<w;++S)E[S]=arguments[S];n&&E.pop();var u=new t(E).promise();return void 0!==n?u.spread(n):u}}},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e,t,o,r,a,s){function l(e,t,n,i){this.constructor$(e),this._promise._captureStackTrace();var o=u();this._callback=null===o?t:d.domainBind(o,t),this._preservedValues=i===a?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],h.invoke(this._asyncInit,this,void 0)}function c(t,n,r,a){if("function"!=typeof n)return o("expecting a function but got "+d.classString(n));var s=0;if(void 0!==r){if("object"!==("undefined"==typeof r?"undefined":i(r))||null===r)return e.reject(new TypeError("options argument must be an object but it is "+d.classString(r)));if("number"!=typeof r.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+d.classString(r.concurrency)));s=r.concurrency}return s="number"==typeof s&&isFinite(s)&&s>=1?s:0,new l(t,n,s,a).promise()}var u=e._getDomain,d=n(167),f=d.tryCatch,p=d.errorObj,h=e._async;d.inherits(l,t),l.prototype._asyncInit=function(){this._init$(void 0,-2)},l.prototype._init=function(){},l.prototype._promiseFulfilled=function(t,n){var i=this._values,o=this.length(),a=this._preservedValues,l=this._limit;if(n<0){if(n=n*-1-1,i[n]=t,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return i[n]=t,this._queue.push(n),!1;null!==a&&(a[n]=t);var c=this._promise,u=this._callback,d=c._boundValue();c._pushContext();var h=f(u).call(d,t,n,o),m=c._popContext();if(s.checkForgottenReturns(h,m,null!==a?"Promise.filter":"Promise.map",c),h===p)return this._reject(h.e),!0;var g=r(h,this._promise);if(g instanceof e){g=g._target();var v=g._bitField;if(0===(50397184&v))return l>=1&&this._inFlight++,i[n]=g,g._proxy(this,(n+1)*-1),!1;if(0===(33554432&v))return 0!==(16777216&v)?(this._reject(g._reason()),!0):(this._cancel(),!0);h=g._value()}i[n]=h}var y=++this._totalResolved;return y>=o&&(null!==a?this._filter(i,a):this._resolve(i),!0)},l.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,n=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var i=e.pop();this._promiseFulfilled(n[i],i)}},l.prototype._filter=function(e,t){for(var n=t.length,i=new Array(n),o=0,r=0;r<n;++r)e[r]&&(i[o++]=t[r]);i.length=o,this._resolve(i)},l.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(e,t){return c(this,e,t,null)},e.map=function(e,t,n,i){return c(e,t,n,i)}}},function(e,t,n){"use strict";var i=Object.create;if(i){var o=i(null),r=i(null);o[" size"]=r[" size"]=0}e.exports=function(e){function t(t,n){var i;if(null!=t&&(i=t[n]),"function"!=typeof i){var o="Object "+u.classString(t)+" has no method '"+u.toString(n)+"'";throw new e.TypeError(o)}return i}function i(e){var n=this.pop(),i=t(e,n);return i.apply(e,this)}function a(e){return e[this]}function s(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),
e[t]}var l,c,u=n(167),d=u.canEvaluate,f=u.isIdentifier,p=function(e){return new Function("ensureMethod","                                    \n\t        return function(obj) {                                               \n\t            'use strict'                                                     \n\t            var len = this.length;                                           \n\t            ensureMethod(obj, 'methodName');                                 \n\t            switch(len) {                                                    \n\t                case 1: return obj.methodName(this[0]);                      \n\t                case 2: return obj.methodName(this[0], this[1]);             \n\t                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\t                case 0: return obj.methodName();                             \n\t                default:                                                     \n\t                    return obj.methodName.apply(obj, this);                  \n\t            }                                                                \n\t        };                                                                   \n\t        ".replace(/methodName/g,e))(t)},h=function(e){return new Function("obj","                                             \n\t        'use strict';                                                        \n\t        return obj.propertyName;                                             \n\t        ".replace("propertyName",e))},m=function(e,t,n){var i=n[e];if("function"!=typeof i){if(!f(e))return null;if(i=t(e),n[e]=i,n[" size"]++,n[" size"]>512){for(var o=Object.keys(n),r=0;r<256;++r)delete n[o[r]];n[" size"]=o.length-256}}return i};l=function(e){return m(e,p,o)},c=function(e){return m(e,h,r)},e.prototype.call=function(e){for(var t=arguments.length,n=new Array(Math.max(t-1,0)),o=1;o<t;++o)n[o-1]=arguments[o];if(d){var r=l(e);if(null!==r)return this._then(r,void 0,void 0,n,void 0)}return n.push(e),this._then(i,void 0,void 0,n,void 0)},e.prototype.get=function(e){var t,n="number"==typeof e;if(n)t=s;else if(d){var i=c(e);t=null!==i?i:a}else t=a;return this._then(t,void 0,void 0,e,void 0)}}},function(e,t,n){"use strict";e.exports=function(e,t,i,o,r,a){function s(e){setTimeout(function(){throw e},0)}function l(e){var t=i(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function c(t,n){function o(){if(a>=c)return u._fulfill();var r=l(t[a++]);if(r instanceof e&&r._isDisposable()){try{r=i(r._getDisposer().tryDispose(n),t.promise)}catch(e){return s(e)}if(r instanceof e)return r._then(o,s,null,null,null)}o()}var a=0,c=t.length,u=new e(r);return o(),u}function u(e,t,n){this._data=e,this._promise=t,this._context=n}function d(e,t,n){this.constructor$(e,t,n)}function f(e){return u.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function p(e){this.length=e,this.promise=null,this[e-1]=null}var h=n(167),m=n(174).TypeError,g=n(167).inherits,v=h.errorObj,y=h.tryCatch,_={};u.prototype.data=function(){return this._data},u.prototype.promise=function(){return this._promise},u.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():_},u.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;void 0!==n&&n._pushContext();var i=t!==_?this.doDispose(t,e):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,i},u.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},g(d,u),d.prototype.doDispose=function(e,t){var n=this.data();return n.call(e,e,t)},p.prototype._resultCancelled=function(){for(var t=this.length,n=0;n<t;++n){var i=this[n];i instanceof e&&i.cancel()}},e.using=function(){var n=arguments.length;if(n<2)return t("you must pass at least 2 arguments to Promise.using");var o=arguments[n-1];if("function"!=typeof o)return t("expecting a function but got "+h.classString(o));var r,s=!0;2===n&&Array.isArray(arguments[0])?(r=arguments[0],n=r.length,s=!1):(r=arguments,n--);for(var l=new p(n),d=0;d<n;++d){var m=r[d];if(u.isDisposer(m)){var g=m;m=m.promise(),m._setDisposable(g)}else{var _=i(m);_ instanceof e&&(m=_._then(f,null,null,{resources:l,index:d},void 0))}l[d]=m}for(var b=new Array(l.length),d=0;d<b.length;++d)b[d]=e.resolve(l[d]).reflect();var w=e.all(b).then(function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.isRejected())return v.e=n.error(),v;if(!n.isFulfilled())return void w.cancel();e[t]=n.value()}E._pushContext(),o=y(o);var i=s?o.apply(void 0,e):o(e),r=E._popContext();return a.checkForgottenReturns(i,r,"Promise.using",E),i}),E=w.lastly(function(){var t=new e.PromiseInspection(w);return c(l,t)});return l.promise=E,E._setOnCancel(l),E},e.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},e.prototype.disposer=function(e){if("function"==typeof e)return new d(e,this,o());throw new m}}},function(e,t,n){"use strict";e.exports=function(e,t,i){function o(e){this.handle=e}function r(e){return clearTimeout(this.handle),e}function a(e){throw clearTimeout(this.handle),e}var s=n(167),l=e.TimeoutError;o.prototype._resultCancelled=function(){clearTimeout(this.handle)};var c=function(e){return u(+this).thenReturn(e)},u=e.delay=function(n,r){var a,s;return void 0!==r?(a=e.resolve(r)._then(c,null,null,n,void 0),i.cancellation()&&r instanceof e&&a._setOnCancel(r)):(a=new e(t),s=setTimeout(function(){a._fulfill()},+n),i.cancellation()&&a._setOnCancel(new o(s)),a._captureStackTrace()),a._setAsyncGuaranteed(),a};e.prototype.delay=function(e){return u(e,this)};var d=function(e,t,n){var i;i="string"!=typeof t?t instanceof Error?t:new l("operation timed out"):new l(t),s.markAsOriginatingFromRejection(i),e._attachExtraTrace(i),e._reject(i),null!=n&&n.cancel()};e.prototype.timeout=function(e,t){e=+e;var n,s,l=new o(setTimeout(function(){n.isPending()&&d(n,t,s)},e));return i.cancellation()?(s=this.then(),n=s._then(r,a,void 0,l,void 0),n._setOnCancel(l)):n=this._then(r,a,void 0,l,void 0),n}}},function(e,t,n){"use strict";e.exports=function(e,t,i,o,r,a){function s(t,n,i){for(var r=0;r<n.length;++r){i._pushContext();var a=p(n[r])(t);if(i._popContext(),a===f){i._pushContext();var s=e.reject(f.e);return i._popContext(),s}var l=o(a,i);if(l instanceof e)return l}return null}function l(t,n,o,r){if(a.cancellation()){var s=new e(i),l=this._finallyPromise=new e(i);this._promise=s.lastly(function(){return l}),s._captureStackTrace(),s._setOnCancel(this)}else{var c=this._promise=new e(i);c._captureStackTrace()}this._stack=r,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}var c=n(174),u=c.TypeError,d=n(167),f=d.errorObj,p=d.tryCatch,h=[];d.inherits(l,r),l.prototype._isResolved=function(){return null===this._promise},l.prototype._cleanup=function(){this._promise=this._generator=null,a.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},l.prototype._promiseCancelled=function(){if(!this._isResolved()){var t,n="undefined"!=typeof this._generator.return;if(n)this._promise._pushContext(),t=p(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var i=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=i,this._promise._attachExtraTrace(i),this._promise._pushContext(),t=p(this._generator.throw).call(this._generator,i),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},l.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=p(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},l.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=p(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},l.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},l.prototype.promise=function(){return this._promise},l.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},l.prototype._continue=function(t){var n=this._promise;if(t===f)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(t.e,!1);var i=t.value;if(t.done===!0)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(i);var r=o(i,this._promise);if(!(r instanceof e)&&(r=s(r,this._yieldHandlers,this._promise),null===r))return void this._promiseRejected(new u("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(i))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));r=r._target();var a=r._bitField;0===(50397184&a)?(this._yieldedPromise=r,r._proxy(this,null)):0!==(33554432&a)?e._async.invoke(this._promiseFulfilled,this,r._value()):0!==(16777216&a)?e._async.invoke(this._promiseRejected,this,r._reason()):this._promiseCancelled()},e.coroutine=function(e,t){if("function"!=typeof e)throw new u("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(t).yieldHandler,i=l,o=(new Error).stack;return function(){var t=e.apply(this,arguments),r=new i(void 0,void 0,n,o),a=r.promise();return r._generator=t,r._promiseFulfilled(void 0),a}},e.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new u("expecting a function but got "+d.classString(e));h.push(e)},e.spawn=function(n){if(a.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof n)return t("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=new l(n,this),o=i.promise();return i._run(e.spawn),o}}},function(e,t,n){"use strict";e.exports=function(e){function t(e,t){var n=this;if(!r.isArray(e))return i.call(n,e,t);var o=s(t).apply(n._boundValue(),[null].concat(e));o===l&&a.throwLater(o.e)}function i(e,t){var n=this,i=n._boundValue(),o=void 0===e?s(t).call(i,null):s(t).call(i,null,e);o===l&&a.throwLater(o.e)}function o(e,t){var n=this;if(!e){var i=new Error(e+"");i.cause=e,e=i}var o=s(t).call(n._boundValue(),e);o===l&&a.throwLater(o.e)}var r=n(167),a=e._async,s=r.tryCatch,l=r.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(e,n){if("function"==typeof e){var r=i;void 0!==n&&Object(n).spread&&(r=t),this._then(r,o,void 0,this,e)}return this}}},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e,t){function o(e){return!S.test(e)}function r(e){try{return e.__isPromisified__===!0}catch(e){return!1}}function a(e,t,n){var i=h.getDataPropertyOrDefault(e,t+n,w);return!!i&&r(i)}function s(e,t,n){for(var i=0;i<e.length;i+=2){var o=e[i];if(n.test(o))for(var r=o.replace(n,""),a=0;a<e.length;a+=2)if(e[a]===r)throw new _("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}function l(e,t,n,i){for(var o=h.inheritedDataKeys(e),l=[],c=0;c<o.length;++c){var u=o[c],d=e[u],f=i===x||x(u,d,e);"function"!=typeof d||r(d)||a(e,u,t)||!i(u,d,e,f)||l.push(u,d)}return s(l,t,n),l}function c(n,i,o,r,a,s){function l(){var o=i;i===p&&(o=this);var r=new e(t);r._captureStackTrace();var a="string"==typeof u&&this!==c?this[u]:n,l=m(r,s);try{a.apply(o,g(arguments,l))}catch(e){r._rejectCallback(v(e),!0,!0)}return r._isFateSealed()||r._setAsyncGuaranteed(),r}var c=function(){return this}(),u=n;return"string"==typeof u&&(n=r),h.notEnumerableProp(l,"__isPromisified__",!0),l}function u(e,t,n,i,o){for(var r=new RegExp(C(t)+"$"),a=l(e,t,r,n),s=0,c=a.length;s<c;s+=2){var u=a[s],d=a[s+1],f=u+t;if(i===O)e[f]=O(u,p,u,d,t,o);else{var m=i(d,function(){return O(u,p,u,d,t,o)});h.notEnumerableProp(m,"__isPromisified__",!0),e[f]=m}}return h.toFastProperties(e),e}function d(e,t,n){return O(e,t,void 0,e,null,n)}var f,p={},h=n(167),m=n(181),g=h.withAppended,v=h.maybeWrapAsError,y=h.canEvaluate,_=n(174).TypeError,b="Async",w={__isPromisified__:!0},E=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],S=new RegExp("^(?:"+E.join("|")+")$"),x=function(e){return h.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e},C=function(e){return e.replace(/([$])/,"\\$")},T=function(e){for(var t=[e],n=Math.max(0,e-1-3),i=e-1;i>=n;--i)t.push(i);for(var i=e+1;i<=3;++i)t.push(i);return t},k=function(e){return h.filledRange(e,"_arg","")},P=function(e){return h.filledRange(Math.max(e,3),"_arg","")},A=function(e){return"number"==typeof e.length?Math.max(Math.min(e.length,1024),0):0};f=function(n,i,o,r,a,s){function l(e){var t,n=k(e).join(", "),o=e>0?", ":"";return t=f?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===i?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n",t.replace("{{args}}",n).replace(", ",o)}function c(){for(var e="",t=0;t<d.length;++t)e+="case "+d[t]+":"+l(d[t]);return e+="                                                             \n\t        default:                                                             \n\t            var args = new Array(len + 1);                                   \n\t            var i = 0;                                                       \n\t            for (var i = 0; i < len; ++i) {                                  \n\t               args[i] = arguments[i];                                       \n\t            }                                                                \n\t            args[i] = nodeback;                                              \n\t            [CodeForCall]                                                    \n\t            break;                                                           \n\t        ".replace("[CodeForCall]",f?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}var u=Math.max(0,A(r)-1),d=T(u),f="string"==typeof n||i===p,y="string"==typeof n?"this != null ? this['"+n+"'] : fn":"fn",_="'use strict';                                                \n\t        var ret = function (Parameters) {                                    \n\t            'use strict';                                                    \n\t            var len = arguments.length;                                      \n\t            var promise = new Promise(INTERNAL);                             \n\t            promise._captureStackTrace();                                    \n\t            var nodeback = nodebackForPromise(promise, "+s+");   \n\t            var ret;                                                         \n\t            var callback = tryCatch([GetFunctionCode]);                      \n\t            switch(len) {                                                    \n\t                [CodeForSwitchCase]                                          \n\t            }                                                                \n\t            if (ret === errorObj) {                                          \n\t                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\t            }                                                                \n\t            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n\t            return promise;                                                  \n\t        };                                                                   \n\t        notEnumerableProp(ret, '__isPromisified__', true);                   \n\t        return ret;                                                          \n\t    ".replace("[CodeForSwitchCase]",c()).replace("[GetFunctionCode]",y);return _=_.replace("Parameters",P(u)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",_)(e,r,i,g,v,m,h.tryCatch,h.errorObj,h.notEnumerableProp,t)};var O=y?f:c;e.promisify=function(e,t){if("function"!=typeof e)throw new _("expecting a function but got "+h.classString(e));if(r(e))return e;t=Object(t);var n=void 0===t.context?p:t.context,i=!!t.multiArgs,a=d(e,n,i);return h.copyDescriptors(e,a,o),a},e.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!==("undefined"==typeof e?"undefined":i(e)))throw new _("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");t=Object(t);var n=!!t.multiArgs,o=t.suffix;"string"!=typeof o&&(o=b);var r=t.filter;"function"!=typeof r&&(r=x);var a=t.promisifier;if("function"!=typeof a&&(a=O),!h.isIdentifier(o))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=h.inheritedDataKeys(e),l=0;l<s.length;++l){var c=e[s[l]];"constructor"!==s[l]&&h.isClass(c)&&(u(c.prototype,o,r,a,n),u(c,o,r,a,n))}return u(e,o,r,a,n)}}},function(e,t,n){"use strict";e.exports=function(e,t,i,o){function r(e){var t,n=!1;if(void 0!==s&&e instanceof s)t=d(e),n=!0;else{var i=u.keys(e),o=i.length;t=new Array(2*o);for(var r=0;r<o;++r){var a=i[r];t[r]=e[a],t[r+o]=a}}this.constructor$(t),this._isMap=n,this._init$(void 0,n?-6:-3)}function a(t){var n,a=i(t);return c(a)?(n=a instanceof e?a._then(e.props,void 0,void 0,void 0,void 0):new r(a).promise(),a instanceof e&&n._propagateFrom(a,2),n):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var s,l=n(167),c=l.isObject,u=n(168);"function"==typeof Map&&(s=Map);var d=function(){function e(e,i){this[t]=e,this[t+n]=i,t++}var t=0,n=0;return function(i){n=i.size,t=0;var o=new Array(2*i.size);return i.forEach(e,o),o}}(),f=function(e){for(var t=new s,n=e.length/2|0,i=0;i<n;++i){var o=e[n+i],r=e[i];t.set(o,r)}return t};l.inherits(r,t),r.prototype._init=function(){},r.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;if(n>=this._length){var i;if(this._isMap)i=f(this._values);else{i={};for(var o=this.length(),r=0,a=this.length();r<a;++r)i[this._values[r+o]]=this._values[r]}return this._resolve(i),!0}return!1},r.prototype.shouldCopyValues=function(){return!1},r.prototype.getActualLength=function(e){return e>>1},e.prototype.props=function(){return a(this)},e.props=function(e){return a(e)}}},function(e,t,n){"use strict";e.exports=function(e,t,i,o){function r(n,r){var l=i(n);if(l instanceof e)return s(l);if(n=a.asArray(n),null===n)return o("expecting an array or an iterable object but got "+a.classString(n));var c=new e(t);void 0!==r&&c._propagateFrom(r,3);for(var u=c._fulfill,d=c._reject,f=0,p=n.length;f<p;++f){var h=n[f];(void 0!==h||f in n)&&e.cast(h)._then(u,d,void 0,c,null)}return c}var a=n(167),s=function(e){return e.then(function(t){return r(t,e)})};e.race=function(e){return r(e,void 0)},e.prototype.race=function(){return r(this,void 0)}}},function(e,t,n){"use strict";e.exports=function(e,t,i,o,r,a){function s(t,n,i,o){this.constructor$(t);var a=f();this._fn=null===a?n:p.domainBind(a,n),void 0!==i&&(i=e.resolve(i),i._attachCancellationCallback(this)),this._initialValue=i,this._currentCancellable=null,o===r?this._eachValues=Array(this._length):0===o?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function c(e,t,n,o){if("function"!=typeof t)return i("expecting a function but got "+p.classString(t));var r=new s(e,t,n,o);return r.promise()}function u(t){this.accum=t,this.array._gotAccum(t);var n=o(this.value,this.array._promise);return n instanceof e?(this.array._currentCancellable=n,n._then(d,void 0,void 0,this,void 0)):d.call(this,n)}function d(t){var n=this.array,i=n._promise,o=h(n._fn);i._pushContext();var r;r=void 0!==n._eachValues?o.call(i._boundValue(),t,this.index,this.length):o.call(i._boundValue(),this.accum,t,this.index,this.length),r instanceof e&&(n._currentCancellable=r);var s=i._popContext();return a.checkForgottenReturns(r,s,void 0!==n._eachValues?"Promise.each":"Promise.reduce",i),r}var f=e._getDomain,p=n(167),h=p.tryCatch;p.inherits(s,t),s.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==r&&this._eachValues.push(e)},s.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},s.prototype.shouldCopyValues=function(){return!1},s.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},s.prototype._resultCancelled=function(t){return t===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel()))},s.prototype._iterate=function(t){this._values=t;var n,i,o=t.length;if(void 0!==this._initialValue?(n=this._initialValue,i=0):(n=e.resolve(t[0]),i=1),this._currentCancellable=n,!n.isRejected())for(;i<o;++i){var r={accum:null,value:t[i],index:i,length:o,array:this};n=n._then(u,void 0,void 0,r,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(l,l,void 0,n,this)},e.prototype.reduce=function(e,t){return c(this,e,t,null)},e.reduce=function(e,t,n,i){return c(e,t,n,i)}}},function(e,t,n){"use strict";e.exports=function(e,t,i){function o(e){this.constructor$(e)}var r=e.PromiseInspection,a=n(167);a.inherits(o,t),o.prototype._promiseResolved=function(e,t){this._values[e]=t;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},o.prototype._promiseFulfilled=function(e,t){var n=new r;return n._bitField=33554432,n._settledValueField=e,this._promiseResolved(t,n)},o.prototype._promiseRejected=function(e,t){var n=new r;return n._bitField=16777216,n._settledValueField=e,this._promiseResolved(t,n)},e.settle=function(e){return i.deprecated(".settle()",".reflect()"),new o(e).promise()},e.prototype.settle=function(){return e.settle(this)}}},function(e,t,n){"use strict";e.exports=function(e,t,i){function o(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function r(e,t){if((0|t)!==t||t<0)return i("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new o(e),r=n.promise();return n.setHowMany(t),n.init(),r}var a=n(167),s=n(174).RangeError,l=n(174).AggregateError,c=a.isArray,u={};a.inherits(o,t),o.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var e=c(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},o.prototype.init=function(){this._initialized=!0,this._init()},o.prototype.setUnwrap=function(){this._unwrap=!0},o.prototype.howMany=function(){return this._howMany},o.prototype.setHowMany=function(e){this._howMany=e},o.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},o.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},o.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},o.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new l,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},o.prototype._fulfilled=function(){return this._totalResolved},o.prototype._rejected=function(){return this._values.length-this.length()},o.prototype._addRejected=function(e){this._values.push(e)},o.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},o.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},o.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},o.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(e,t){return r(e,t)},e.prototype.some=function(e){return r(this,e)},e._SomePromiseArray=o}},function(e,t){"use strict";e.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,i){return n(this,e,i,t)},e.filter=function(e,i,o){return n(e,i,o,t)}}},function(e,t){"use strict";e.exports=function(e,t){function n(){return r(this)}function i(e,n){return o(e,n,t,t)}var o=e.reduce,r=e.all;e.prototype.each=function(e){return o(this,e,t,0)._then(n,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return o(this,e,t,t)},e.each=function(e,i){return o(e,i,t,0)._then(n,void 0,void 0,e,void 0)},e.mapSeries=i}},function(e,t){"use strict";e.exports=function(e){function t(e){var t=new n(e),i=t.promise();return t.setHowMany(1),t.setUnwrap(),t.init(),i}var n=e._SomePromiseArray;e.any=function(e){return t(e)},e.prototype.any=function(){return t(this)}}},function(e,t,n){(function(i){"use strict";function o(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function r(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var i="color: "+this.color;e.splice(1,0,i,"color: inherit");var o=0,r=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(r=o))}),e.splice(r,0,i)}}function a(){return"object"===("undefined"==typeof console?"undefined":u(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}}function l(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof i&&"env"in i&&(e=i.env.DEBUG),e}function c(){try{return window.localStorage}catch(e){}}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=e.exports=n(204),t.log=a,t.formatArgs=r,t.save=s,t.load=l,t.useColors=o,t.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(l())}).call(t,n(166))},function(e,t,n){"use strict";function i(e){var n,i=0;for(n in e)i=(i<<5)-i+e.charCodeAt(n),i|=0;return t.colors[Math.abs(i)%t.colors.length]}function o(e){function n(){if(n.enabled){var e=n,i=+new Date,o=i-(c||i);e.diff=o,e.prev=c,e.curr=i,c=i;for(var r=new Array(arguments.length),a=0;a<r.length;a++)r[a]=arguments[a];r[0]=t.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");var s=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,function(n,i){if("%%"===n)return n;s++;var o=t.formatters[i];if("function"==typeof o){var a=r[s];n=o.call(e,a),r.splice(s,1),s--}return n}),t.formatArgs.call(e,r);var l=n.log||t.log||console.log.bind(console);l.apply(e,r)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=i(e),"function"==typeof t.init&&t.init(n),n}function r(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length,o=0;o<i;o++)n[o]&&(e=n[o].replace(/\*/g,".*?"),"-"===e[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))}function a(){t.enable("")}function s(e){var n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1}function l(e){return e instanceof Error?e.stack||e.message:e}t=e.exports=o.debug=o.default=o,t.coerce=l,t.disable=a,t.enable=r,t.enabled=s,t.humanize=n(205),t.names=[],t.skips=[],t.formatters={};var c},function(e,t){"use strict";function n(e){if(e=String(e),!(e.length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),i=(t[2]||"ms").toLowerCase();switch(i){case"years":case"year":case"yrs":case"yr":case"y":return n*d;case"days":case"day":case"d":return n*u;case"hours":case"hour":case"hrs":case"hr":case"h":return n*c;case"minutes":case"minute":case"mins":case"min":case"m":return n*l;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function i(e){return e>=u?Math.round(e/u)+"d":e>=c?Math.round(e/c)+"h":e>=l?Math.round(e/l)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function o(e){return r(e,u,"day")||r(e,c,"hour")||r(e,l,"minute")||r(e,s,"second")||e+" ms"}function r(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=1e3,l=60*s,c=60*l,u=24*c,d=365.25*u;e.exports=function(e,t){t=t||{};var r="undefined"==typeof e?"undefined":a(e);if("string"===r&&e.length>0)return n(e);if("number"===r&&isNaN(e)===!1)return t.long?o(e):i(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){"use strict";var n={"fixed-interval":{defaults:{interval:1e3},getNextInterval:function(e,t){return t.interval}},"linear-backoff":{defaults:{start:1e3,increment:1e3},getNextInterval:function(e,t){return t.start+t.increment*e}},"exponential-backoff":{defaults:{min:1e3,max:3e4},getNextInterval:function(e,t){return Math.min(t.max,Math.round(Math.random()*(1e3*Math.pow(2,e)-t.min)+t.min))}}};e.exports=n},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(57),r=(i(o),n(59)),a=i(r),s=n(83),l=i(s),c=n(119),u=i(c),d=n(208);t.default=a.default.View.extend({template:d.loggedOutDialog,id:"logged-out-dialog",initialize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message;this.message=t,this.render()},render:function(){return this.dialog=l.default.dialog2(this.template({id:this.id,message:this.message,url:(0,u.default)("login.url")})),this.setElement(this.dialog.$el),this.show(),this},show:function(){this.dialog.show()}}),e.exports=t.default},function(e,t,n){if("undefined"==typeof i)var i={};if(i=Object.assign(i||{},n(66)),"undefined"==typeof o)var o={};o.loggedOutDialog=function(e,t){return""+i.dialog.dialog2({id:e.id,size:"small",titleText:"You've been logged out",modal:!0,content:""+soy.$$escapeHtml(null!=e.message?e.message:"Your session has expired. Please log in again to continue."),
footerActionContent:""+i.buttons.button({text:"Return to log in",type:"primary",href:e.url})})},(!1).DEBUG&&(o.loggedOutDialog.soyTemplateName="widget.loggedOutDialog"),e.exports=o}])});
//# sourceMappingURL=logged-in.js.map